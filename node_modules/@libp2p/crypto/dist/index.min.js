(function (root, factory) {(typeof module === 'object' && module.exports) ? module.exports = factory() : root.Libp2PCrypto = factory()}(typeof self !== 'undefined' ? self : this, function () {
"use strict";var Libp2PCrypto=(()=>{var Jf=Object.create;var jr=Object.defineProperty;var jf=Object.getOwnPropertyDescriptor;var tc=Object.getOwnPropertyNames;var ec=Object.getPrototypeOf,rc=Object.prototype.hasOwnProperty;var Q=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),vt=(t,e)=>{for(var r in e)jr(t,r,{get:e[r],enumerable:!0})},ja=(t,e,r,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of tc(e))!rc.call(t,i)&&i!==r&&jr(t,i,{get:()=>e[i],enumerable:!(n=jf(e,i))||n.enumerable});return t};var bt=(t,e,r)=>(r=t!=null?Jf(ec(t)):{},ja(e||!t||!t.__esModule?jr(r,"default",{value:t,enumerable:!0}):r,t)),nc=t=>ja(jr({},"__esModule",{value:!0}),t);var st=Q((Vd,ro)=>{ro.exports={options:{usePureJavaScript:!1}}});var ao=Q((Fd,io)=>{var jn={};io.exports=jn;var no={};jn.encode=function(t,e,r){if(typeof e!="string")throw new TypeError('"alphabet" must be a string.');if(r!==void 0&&typeof r!="number")throw new TypeError('"maxline" must be a number.');var n="";if(!(t instanceof Uint8Array))n=ic(t,e);else{var i=0,a=e.length,s=e.charAt(0),o=[0];for(i=0;i<t.length;++i){for(var f=0,c=t[i];f<o.length;++f)c+=o[f]<<8,o[f]=c%a,c=c/a|0;for(;c>0;)o.push(c%a),c=c/a|0}for(i=0;t[i]===0&&i<t.length-1;++i)n+=s;for(i=o.length-1;i>=0;--i)n+=e[o[i]]}if(r){var u=new RegExp(".{1,"+r+"}","g");n=n.match(u).join(`\r
`)}return n};jn.decode=function(t,e){if(typeof t!="string")throw new TypeError('"input" must be a string.');if(typeof e!="string")throw new TypeError('"alphabet" must be a string.');var r=no[e];if(!r){r=no[e]=[];for(var n=0;n<e.length;++n)r[e.charCodeAt(n)]=n}t=t.replace(/\s/g,"");for(var i=e.length,a=e.charAt(0),s=[0],n=0;n<t.length;n++){var o=r[t.charCodeAt(n)];if(o===void 0)return;for(var f=0,c=o;f<s.length;++f)c+=s[f]*i,s[f]=c&255,c>>=8;for(;c>0;)s.push(c&255),c>>=8}for(var u=0;t[u]===a&&u<t.length-1;++u)s.push(0);return typeof Buffer<"u"?Buffer.from(s.reverse()):new Uint8Array(s.reverse())};function ic(t,e){var r=0,n=e.length,i=e.charAt(0),a=[0];for(r=0;r<t.length();++r){for(var s=0,o=t.at(r);s<a.length;++s)o+=a[s]<<8,a[s]=o%n,o=o/n|0;for(;o>0;)a.push(o%n),o=o/n|0}var f="";for(r=0;t.at(r)===0&&r<t.length()-1;++r)f+=i;for(r=a.length-1;r>=0;--r)f+=e[a[r]];return f}});var Bt=Q((Hd,co)=>{var oo=st(),so=ao(),g=co.exports=oo.util=oo.util||{};(function(){if(typeof process<"u"&&process.nextTick&&!process.browser){g.nextTick=process.nextTick,typeof setImmediate=="function"?g.setImmediate=setImmediate:g.setImmediate=g.nextTick;return}if(typeof setImmediate=="function"){g.setImmediate=function(){return setImmediate.apply(void 0,arguments)},g.nextTick=function(o){return setImmediate(o)};return}if(g.setImmediate=function(o){setTimeout(o,0)},typeof window<"u"&&typeof window.postMessage=="function"){let o=function(f){if(f.source===window&&f.data===t){f.stopPropagation();var c=e.slice();e.length=0,c.forEach(function(u){u()})}};var s=o,t="forge.setImmediate",e=[];g.setImmediate=function(f){e.push(f),e.length===1&&window.postMessage(t,"*")},window.addEventListener("message",o,!0)}if(typeof MutationObserver<"u"){var r=Date.now(),n=!0,i=document.createElement("div"),e=[];new MutationObserver(function(){var f=e.slice();e.length=0,f.forEach(function(c){c()})}).observe(i,{attributes:!0});var a=g.setImmediate;g.setImmediate=function(f){Date.now()-r>15?(r=Date.now(),a(f)):(e.push(f),e.length===1&&i.setAttribute("a",n=!n))}}g.nextTick=g.setImmediate})();g.isNodejs=typeof process<"u"&&process.versions&&process.versions.node;g.globalScope=function(){return g.isNodejs?globalThis:typeof self>"u"?window:self}();g.isArray=Array.isArray||function(t){return Object.prototype.toString.call(t)==="[object Array]"};g.isArrayBuffer=function(t){return typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer};g.isArrayBufferView=function(t){return t&&g.isArrayBuffer(t.buffer)&&t.byteLength!==void 0};function _r(t){if(!(t===8||t===16||t===24||t===32))throw new Error("Only 8, 16, 24, or 32 bits supported: "+t)}g.ByteBuffer=ti;function ti(t){if(this.data="",this.read=0,typeof t=="string")this.data=t;else if(g.isArrayBuffer(t)||g.isArrayBufferView(t))if(typeof Buffer<"u"&&t instanceof Buffer)this.data=t.toString("binary");else{var e=new Uint8Array(t);try{this.data=String.fromCharCode.apply(null,e)}catch{for(var r=0;r<e.length;++r)this.putByte(e[r])}}else(t instanceof ti||typeof t=="object"&&typeof t.data=="string"&&typeof t.read=="number")&&(this.data=t.data,this.read=t.read);this._constructedStringLength=0}g.ByteStringBuffer=ti;var ac=4096;g.ByteStringBuffer.prototype._optimizeConstructedString=function(t){this._constructedStringLength+=t,this._constructedStringLength>ac&&(this.data.substr(0,1),this._constructedStringLength=0)};g.ByteStringBuffer.prototype.length=function(){return this.data.length-this.read};g.ByteStringBuffer.prototype.isEmpty=function(){return this.length()<=0};g.ByteStringBuffer.prototype.putByte=function(t){return this.putBytes(String.fromCharCode(t))};g.ByteStringBuffer.prototype.fillWithByte=function(t,e){t=String.fromCharCode(t);for(var r=this.data;e>0;)e&1&&(r+=t),e>>>=1,e>0&&(t+=t);return this.data=r,this._optimizeConstructedString(e),this};g.ByteStringBuffer.prototype.putBytes=function(t){return this.data+=t,this._optimizeConstructedString(t.length),this};g.ByteStringBuffer.prototype.putString=function(t){return this.putBytes(g.encodeUtf8(t))};g.ByteStringBuffer.prototype.putInt16=function(t){return this.putBytes(String.fromCharCode(t>>8&255)+String.fromCharCode(t&255))};g.ByteStringBuffer.prototype.putInt24=function(t){return this.putBytes(String.fromCharCode(t>>16&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t&255))};g.ByteStringBuffer.prototype.putInt32=function(t){return this.putBytes(String.fromCharCode(t>>24&255)+String.fromCharCode(t>>16&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t&255))};g.ByteStringBuffer.prototype.putInt16Le=function(t){return this.putBytes(String.fromCharCode(t&255)+String.fromCharCode(t>>8&255))};g.ByteStringBuffer.prototype.putInt24Le=function(t){return this.putBytes(String.fromCharCode(t&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t>>16&255))};g.ByteStringBuffer.prototype.putInt32Le=function(t){return this.putBytes(String.fromCharCode(t&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t>>16&255)+String.fromCharCode(t>>24&255))};g.ByteStringBuffer.prototype.putInt=function(t,e){_r(e);var r="";do e-=8,r+=String.fromCharCode(t>>e&255);while(e>0);return this.putBytes(r)};g.ByteStringBuffer.prototype.putSignedInt=function(t,e){return t<0&&(t+=2<<e-1),this.putInt(t,e)};g.ByteStringBuffer.prototype.putBuffer=function(t){return this.putBytes(t.getBytes())};g.ByteStringBuffer.prototype.getByte=function(){return this.data.charCodeAt(this.read++)};g.ByteStringBuffer.prototype.getInt16=function(){var t=this.data.charCodeAt(this.read)<<8^this.data.charCodeAt(this.read+1);return this.read+=2,t};g.ByteStringBuffer.prototype.getInt24=function(){var t=this.data.charCodeAt(this.read)<<16^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2);return this.read+=3,t};g.ByteStringBuffer.prototype.getInt32=function(){var t=this.data.charCodeAt(this.read)<<24^this.data.charCodeAt(this.read+1)<<16^this.data.charCodeAt(this.read+2)<<8^this.data.charCodeAt(this.read+3);return this.read+=4,t};g.ByteStringBuffer.prototype.getInt16Le=function(){var t=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8;return this.read+=2,t};g.ByteStringBuffer.prototype.getInt24Le=function(){var t=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16;return this.read+=3,t};g.ByteStringBuffer.prototype.getInt32Le=function(){var t=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16^this.data.charCodeAt(this.read+3)<<24;return this.read+=4,t};g.ByteStringBuffer.prototype.getInt=function(t){_r(t);var e=0;do e=(e<<8)+this.data.charCodeAt(this.read++),t-=8;while(t>0);return e};g.ByteStringBuffer.prototype.getSignedInt=function(t){var e=this.getInt(t),r=2<<t-2;return e>=r&&(e-=r<<1),e};g.ByteStringBuffer.prototype.getBytes=function(t){var e;return t?(t=Math.min(this.length(),t),e=this.data.slice(this.read,this.read+t),this.read+=t):t===0?e="":(e=this.read===0?this.data:this.data.slice(this.read),this.clear()),e};g.ByteStringBuffer.prototype.bytes=function(t){return typeof t>"u"?this.data.slice(this.read):this.data.slice(this.read,this.read+t)};g.ByteStringBuffer.prototype.at=function(t){return this.data.charCodeAt(this.read+t)};g.ByteStringBuffer.prototype.setAt=function(t,e){return this.data=this.data.substr(0,this.read+t)+String.fromCharCode(e)+this.data.substr(this.read+t+1),this};g.ByteStringBuffer.prototype.last=function(){return this.data.charCodeAt(this.data.length-1)};g.ByteStringBuffer.prototype.copy=function(){var t=g.createBuffer(this.data);return t.read=this.read,t};g.ByteStringBuffer.prototype.compact=function(){return this.read>0&&(this.data=this.data.slice(this.read),this.read=0),this};g.ByteStringBuffer.prototype.clear=function(){return this.data="",this.read=0,this};g.ByteStringBuffer.prototype.truncate=function(t){var e=Math.max(0,this.length()-t);return this.data=this.data.substr(this.read,e),this.read=0,this};g.ByteStringBuffer.prototype.toHex=function(){for(var t="",e=this.read;e<this.data.length;++e){var r=this.data.charCodeAt(e);r<16&&(t+="0"),t+=r.toString(16)}return t};g.ByteStringBuffer.prototype.toString=function(){return g.decodeUtf8(this.bytes())};function oc(t,e){e=e||{},this.read=e.readOffset||0,this.growSize=e.growSize||1024;var r=g.isArrayBuffer(t),n=g.isArrayBufferView(t);if(r||n){r?this.data=new DataView(t):this.data=new DataView(t.buffer,t.byteOffset,t.byteLength),this.write="writeOffset"in e?e.writeOffset:this.data.byteLength;return}this.data=new DataView(new ArrayBuffer(0)),this.write=0,t!=null&&this.putBytes(t),"writeOffset"in e&&(this.write=e.writeOffset)}g.DataBuffer=oc;g.DataBuffer.prototype.length=function(){return this.write-this.read};g.DataBuffer.prototype.isEmpty=function(){return this.length()<=0};g.DataBuffer.prototype.accommodate=function(t,e){if(this.length()>=t)return this;e=Math.max(e||this.growSize,t);var r=new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength),n=new Uint8Array(this.length()+e);return n.set(r),this.data=new DataView(n.buffer),this};g.DataBuffer.prototype.putByte=function(t){return this.accommodate(1),this.data.setUint8(this.write++,t),this};g.DataBuffer.prototype.fillWithByte=function(t,e){this.accommodate(e);for(var r=0;r<e;++r)this.data.setUint8(t);return this};g.DataBuffer.prototype.putBytes=function(t,e){if(g.isArrayBufferView(t)){var r=new Uint8Array(t.buffer,t.byteOffset,t.byteLength),n=r.byteLength-r.byteOffset;this.accommodate(n);var i=new Uint8Array(this.data.buffer,this.write);return i.set(r),this.write+=n,this}if(g.isArrayBuffer(t)){var r=new Uint8Array(t);this.accommodate(r.byteLength);var i=new Uint8Array(this.data.buffer);return i.set(r,this.write),this.write+=r.byteLength,this}if(t instanceof g.DataBuffer||typeof t=="object"&&typeof t.read=="number"&&typeof t.write=="number"&&g.isArrayBufferView(t.data)){var r=new Uint8Array(t.data.byteLength,t.read,t.length());this.accommodate(r.byteLength);var i=new Uint8Array(t.data.byteLength,this.write);return i.set(r),this.write+=r.byteLength,this}if(t instanceof g.ByteStringBuffer&&(t=t.data,e="binary"),e=e||"binary",typeof t=="string"){var a;if(e==="hex")return this.accommodate(Math.ceil(t.length/2)),a=new Uint8Array(this.data.buffer,this.write),this.write+=g.binary.hex.decode(t,a,this.write),this;if(e==="base64")return this.accommodate(Math.ceil(t.length/4)*3),a=new Uint8Array(this.data.buffer,this.write),this.write+=g.binary.base64.decode(t,a,this.write),this;if(e==="utf8"&&(t=g.encodeUtf8(t),e="binary"),e==="binary"||e==="raw")return this.accommodate(t.length),a=new Uint8Array(this.data.buffer,this.write),this.write+=g.binary.raw.decode(a),this;if(e==="utf16")return this.accommodate(t.length*2),a=new Uint16Array(this.data.buffer,this.write),this.write+=g.text.utf16.encode(a),this;throw new Error("Invalid encoding: "+e)}throw Error("Invalid parameter: "+t)};g.DataBuffer.prototype.putBuffer=function(t){return this.putBytes(t),t.clear(),this};g.DataBuffer.prototype.putString=function(t){return this.putBytes(t,"utf16")};g.DataBuffer.prototype.putInt16=function(t){return this.accommodate(2),this.data.setInt16(this.write,t),this.write+=2,this};g.DataBuffer.prototype.putInt24=function(t){return this.accommodate(3),this.data.setInt16(this.write,t>>8&65535),this.data.setInt8(this.write,t>>16&255),this.write+=3,this};g.DataBuffer.prototype.putInt32=function(t){return this.accommodate(4),this.data.setInt32(this.write,t),this.write+=4,this};g.DataBuffer.prototype.putInt16Le=function(t){return this.accommodate(2),this.data.setInt16(this.write,t,!0),this.write+=2,this};g.DataBuffer.prototype.putInt24Le=function(t){return this.accommodate(3),this.data.setInt8(this.write,t>>16&255),this.data.setInt16(this.write,t>>8&65535,!0),this.write+=3,this};g.DataBuffer.prototype.putInt32Le=function(t){return this.accommodate(4),this.data.setInt32(this.write,t,!0),this.write+=4,this};g.DataBuffer.prototype.putInt=function(t,e){_r(e),this.accommodate(e/8);do e-=8,this.data.setInt8(this.write++,t>>e&255);while(e>0);return this};g.DataBuffer.prototype.putSignedInt=function(t,e){return _r(e),this.accommodate(e/8),t<0&&(t+=2<<e-1),this.putInt(t,e)};g.DataBuffer.prototype.getByte=function(){return this.data.getInt8(this.read++)};g.DataBuffer.prototype.getInt16=function(){var t=this.data.getInt16(this.read);return this.read+=2,t};g.DataBuffer.prototype.getInt24=function(){var t=this.data.getInt16(this.read)<<8^this.data.getInt8(this.read+2);return this.read+=3,t};g.DataBuffer.prototype.getInt32=function(){var t=this.data.getInt32(this.read);return this.read+=4,t};g.DataBuffer.prototype.getInt16Le=function(){var t=this.data.getInt16(this.read,!0);return this.read+=2,t};g.DataBuffer.prototype.getInt24Le=function(){var t=this.data.getInt8(this.read)^this.data.getInt16(this.read+1,!0)<<8;return this.read+=3,t};g.DataBuffer.prototype.getInt32Le=function(){var t=this.data.getInt32(this.read,!0);return this.read+=4,t};g.DataBuffer.prototype.getInt=function(t){_r(t);var e=0;do e=(e<<8)+this.data.getInt8(this.read++),t-=8;while(t>0);return e};g.DataBuffer.prototype.getSignedInt=function(t){var e=this.getInt(t),r=2<<t-2;return e>=r&&(e-=r<<1),e};g.DataBuffer.prototype.getBytes=function(t){var e;return t?(t=Math.min(this.length(),t),e=this.data.slice(this.read,this.read+t),this.read+=t):t===0?e="":(e=this.read===0?this.data:this.data.slice(this.read),this.clear()),e};g.DataBuffer.prototype.bytes=function(t){return typeof t>"u"?this.data.slice(this.read):this.data.slice(this.read,this.read+t)};g.DataBuffer.prototype.at=function(t){return this.data.getUint8(this.read+t)};g.DataBuffer.prototype.setAt=function(t,e){return this.data.setUint8(t,e),this};g.DataBuffer.prototype.last=function(){return this.data.getUint8(this.write-1)};g.DataBuffer.prototype.copy=function(){return new g.DataBuffer(this)};g.DataBuffer.prototype.compact=function(){if(this.read>0){var t=new Uint8Array(this.data.buffer,this.read),e=new Uint8Array(t.byteLength);e.set(t),this.data=new DataView(e),this.write-=this.read,this.read=0}return this};g.DataBuffer.prototype.clear=function(){return this.data=new DataView(new ArrayBuffer(0)),this.read=this.write=0,this};g.DataBuffer.prototype.truncate=function(t){return this.write=Math.max(0,this.length()-t),this.read=Math.min(this.read,this.write),this};g.DataBuffer.prototype.toHex=function(){for(var t="",e=this.read;e<this.data.byteLength;++e){var r=this.data.getUint8(e);r<16&&(t+="0"),t+=r.toString(16)}return t};g.DataBuffer.prototype.toString=function(t){var e=new Uint8Array(this.data,this.read,this.length());if(t=t||"utf8",t==="binary"||t==="raw")return g.binary.raw.encode(e);if(t==="hex")return g.binary.hex.encode(e);if(t==="base64")return g.binary.base64.encode(e);if(t==="utf8")return g.text.utf8.decode(e);if(t==="utf16")return g.text.utf16.decode(e);throw new Error("Invalid encoding: "+t)};g.createBuffer=function(t,e){return e=e||"raw",t!==void 0&&e==="utf8"&&(t=g.encodeUtf8(t)),new g.ByteBuffer(t)};g.fillString=function(t,e){for(var r="";e>0;)e&1&&(r+=t),e>>>=1,e>0&&(t+=t);return r};g.xorBytes=function(t,e,r){for(var n="",i="",a="",s=0,o=0;r>0;--r,++s)i=t.charCodeAt(s)^e.charCodeAt(s),o>=10&&(n+=a,a="",o=0),a+=String.fromCharCode(i),++o;return n+=a,n};g.hexToBytes=function(t){var e="",r=0;for(t.length&!0&&(r=1,e+=String.fromCharCode(parseInt(t[0],16)));r<t.length;r+=2)e+=String.fromCharCode(parseInt(t.substr(r,2),16));return e};g.bytesToHex=function(t){return g.createBuffer(t).toHex()};g.int32ToBytes=function(t){return String.fromCharCode(t>>24&255)+String.fromCharCode(t>>16&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t&255)};var _e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",Re=[62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,64,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51],fo="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";g.encode64=function(t,e){for(var r="",n="",i,a,s,o=0;o<t.length;)i=t.charCodeAt(o++),a=t.charCodeAt(o++),s=t.charCodeAt(o++),r+=_e.charAt(i>>2),r+=_e.charAt((i&3)<<4|a>>4),isNaN(a)?r+="==":(r+=_e.charAt((a&15)<<2|s>>6),r+=isNaN(s)?"=":_e.charAt(s&63)),e&&r.length>e&&(n+=r.substr(0,e)+`\r
`,r=r.substr(e));return n+=r,n};g.decode64=function(t){t=t.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var e="",r,n,i,a,s=0;s<t.length;)r=Re[t.charCodeAt(s++)-43],n=Re[t.charCodeAt(s++)-43],i=Re[t.charCodeAt(s++)-43],a=Re[t.charCodeAt(s++)-43],e+=String.fromCharCode(r<<2|n>>4),i!==64&&(e+=String.fromCharCode((n&15)<<4|i>>2),a!==64&&(e+=String.fromCharCode((i&3)<<6|a)));return e};g.encodeUtf8=function(t){return unescape(encodeURIComponent(t))};g.decodeUtf8=function(t){return decodeURIComponent(escape(t))};g.binary={raw:{},hex:{},base64:{},base58:{},baseN:{encode:so.encode,decode:so.decode}};g.binary.raw.encode=function(t){return String.fromCharCode.apply(null,t)};g.binary.raw.decode=function(t,e,r){var n=e;n||(n=new Uint8Array(t.length)),r=r||0;for(var i=r,a=0;a<t.length;++a)n[i++]=t.charCodeAt(a);return e?i-r:n};g.binary.hex.encode=g.bytesToHex;g.binary.hex.decode=function(t,e,r){var n=e;n||(n=new Uint8Array(Math.ceil(t.length/2))),r=r||0;var i=0,a=r;for(t.length&1&&(i=1,n[a++]=parseInt(t[0],16));i<t.length;i+=2)n[a++]=parseInt(t.substr(i,2),16);return e?a-r:n};g.binary.base64.encode=function(t,e){for(var r="",n="",i,a,s,o=0;o<t.byteLength;)i=t[o++],a=t[o++],s=t[o++],r+=_e.charAt(i>>2),r+=_e.charAt((i&3)<<4|a>>4),isNaN(a)?r+="==":(r+=_e.charAt((a&15)<<2|s>>6),r+=isNaN(s)?"=":_e.charAt(s&63)),e&&r.length>e&&(n+=r.substr(0,e)+`\r
`,r=r.substr(e));return n+=r,n};g.binary.base64.decode=function(t,e,r){var n=e;n||(n=new Uint8Array(Math.ceil(t.length/4)*3)),t=t.replace(/[^A-Za-z0-9\+\/\=]/g,""),r=r||0;for(var i,a,s,o,f=0,c=r;f<t.length;)i=Re[t.charCodeAt(f++)-43],a=Re[t.charCodeAt(f++)-43],s=Re[t.charCodeAt(f++)-43],o=Re[t.charCodeAt(f++)-43],n[c++]=i<<2|a>>4,s!==64&&(n[c++]=(a&15)<<4|s>>2,o!==64&&(n[c++]=(s&3)<<6|o));return e?c-r:n.subarray(0,c)};g.binary.base58.encode=function(t,e){return g.binary.baseN.encode(t,fo,e)};g.binary.base58.decode=function(t,e){return g.binary.baseN.decode(t,fo,e)};g.text={utf8:{},utf16:{}};g.text.utf8.encode=function(t,e,r){t=g.encodeUtf8(t);var n=e;n||(n=new Uint8Array(t.length)),r=r||0;for(var i=r,a=0;a<t.length;++a)n[i++]=t.charCodeAt(a);return e?i-r:n};g.text.utf8.decode=function(t){return g.decodeUtf8(String.fromCharCode.apply(null,t))};g.text.utf16.encode=function(t,e,r){var n=e;n||(n=new Uint8Array(t.length*2));var i=new Uint16Array(n.buffer);r=r||0;for(var a=r,s=r,o=0;o<t.length;++o)i[s++]=t.charCodeAt(o),a+=2;return e?a-r:n};g.text.utf16.decode=function(t){return String.fromCharCode.apply(null,new Uint16Array(t.buffer))};g.deflate=function(t,e,r){if(e=g.decode64(t.deflate(g.encode64(e)).rval),r){var n=2,i=e.charCodeAt(1);i&32&&(n=6),e=e.substring(n,e.length-4)}return e};g.inflate=function(t,e,r){var n=t.inflate(g.encode64(e)).rval;return n===null?null:g.decode64(n)};var ei=function(t,e,r){if(!t)throw new Error("WebStorage not available.");var n;if(r===null?n=t.removeItem(e):(r=g.encode64(JSON.stringify(r)),n=t.setItem(e,r)),typeof n<"u"&&n.rval!==!0){var i=new Error(n.error.message);throw i.id=n.error.id,i.name=n.error.name,i}},ri=function(t,e){if(!t)throw new Error("WebStorage not available.");var r=t.getItem(e);if(t.init)if(r.rval===null){if(r.error){var n=new Error(r.error.message);throw n.id=r.error.id,n.name=r.error.name,n}r=null}else r=r.rval;return r!==null&&(r=JSON.parse(g.decode64(r))),r},sc=function(t,e,r,n){var i=ri(t,e);i===null&&(i={}),i[r]=n,ei(t,e,i)},fc=function(t,e,r){var n=ri(t,e);return n!==null&&(n=r in n?n[r]:null),n},cc=function(t,e,r){var n=ri(t,e);if(n!==null&&r in n){delete n[r];var i=!0;for(var a in n){i=!1;break}i&&(n=null),ei(t,e,n)}},uc=function(t,e){ei(t,e,null)},tn=function(t,e,r){var n=null;typeof r>"u"&&(r=["web","flash"]);var i,a=!1,s=null;for(var o in r){i=r[o];try{if(i==="flash"||i==="both"){if(e[0]===null)throw new Error("Flash local storage not available.");n=t.apply(this,e),a=i==="flash"}(i==="web"||i==="both")&&(e[0]=localStorage,n=t.apply(this,e),a=!0)}catch(f){s=f}if(a)break}if(!a)throw s;return n};g.setItem=function(t,e,r,n,i){tn(sc,arguments,i)};g.getItem=function(t,e,r,n){return tn(fc,arguments,n)};g.removeItem=function(t,e,r,n){tn(cc,arguments,n)};g.clearItems=function(t,e,r){tn(uc,arguments,r)};g.isEmpty=function(t){for(var e in t)if(t.hasOwnProperty(e))return!1;return!0};g.format=function(t){for(var e=/%./g,r,n,i=0,a=[],s=0;r=e.exec(t);){n=t.substring(s,e.lastIndex-2),n.length>0&&a.push(n),s=e.lastIndex;var o=r[0][1];switch(o){case"s":case"o":i<arguments.length?a.push(arguments[i+++1]):a.push("<?>");break;case"%":a.push("%");break;default:a.push("<%"+o+"?>")}}return a.push(t.substring(s)),a.join("")};g.formatNumber=function(t,e,r,n){var i=t,a=isNaN(e=Math.abs(e))?2:e,s=r===void 0?",":r,o=n===void 0?".":n,f=i<0?"-":"",c=parseInt(i=Math.abs(+i||0).toFixed(a),10)+"",u=c.length>3?c.length%3:0;return f+(u?c.substr(0,u)+o:"")+c.substr(u).replace(/(\d{3})(?=\d)/g,"$1"+o)+(a?s+Math.abs(i-c).toFixed(a).slice(2):"")};g.formatSize=function(t){return t>=1073741824?t=g.formatNumber(t/1073741824,2,".","")+" GiB":t>=1048576?t=g.formatNumber(t/1048576,2,".","")+" MiB":t>=1024?t=g.formatNumber(t/1024,0)+" KiB":t=g.formatNumber(t,0)+" bytes",t};g.bytesFromIP=function(t){return t.indexOf(".")!==-1?g.bytesFromIPv4(t):t.indexOf(":")!==-1?g.bytesFromIPv6(t):null};g.bytesFromIPv4=function(t){if(t=t.split("."),t.length!==4)return null;for(var e=g.createBuffer(),r=0;r<t.length;++r){var n=parseInt(t[r],10);if(isNaN(n))return null;e.putByte(n)}return e.getBytes()};g.bytesFromIPv6=function(t){var e=0;t=t.split(":").filter(function(s){return s.length===0&&++e,!0});for(var r=(8-t.length+e)*2,n=g.createBuffer(),i=0;i<8;++i){if(!t[i]||t[i].length===0){n.fillWithByte(0,r),r=0;continue}var a=g.hexToBytes(t[i]);a.length<2&&n.putByte(0),n.putBytes(a)}return n.getBytes()};g.bytesToIP=function(t){return t.length===4?g.bytesToIPv4(t):t.length===16?g.bytesToIPv6(t):null};g.bytesToIPv4=function(t){if(t.length!==4)return null;for(var e=[],r=0;r<t.length;++r)e.push(t.charCodeAt(r));return e.join(".")};g.bytesToIPv6=function(t){if(t.length!==16)return null;for(var e=[],r=[],n=0,i=0;i<t.length;i+=2){for(var a=g.bytesToHex(t[i]+t[i+1]);a[0]==="0"&&a!=="0";)a=a.substr(1);if(a==="0"){var s=r[r.length-1],o=e.length;!s||o!==s.end+1?r.push({start:o,end:o}):(s.end=o,s.end-s.start>r[n].end-r[n].start&&(n=r.length-1))}e.push(a)}if(r.length>0){var f=r[n];f.end-f.start>0&&(e.splice(f.start,f.end-f.start+1,""),f.start===0&&e.unshift(""),f.end===7&&e.push(""))}return e.join(":")};g.estimateCores=function(t,e){if(typeof t=="function"&&(e=t,t={}),t=t||{},"cores"in g&&!t.update)return e(null,g.cores);if(typeof navigator<"u"&&"hardwareConcurrency"in navigator&&navigator.hardwareConcurrency>0)return g.cores=navigator.hardwareConcurrency,e(null,g.cores);if(typeof Worker>"u")return g.cores=1,e(null,g.cores);if(typeof Blob>"u")return g.cores=2,e(null,g.cores);var r=URL.createObjectURL(new Blob(["(",function(){self.addEventListener("message",function(s){for(var o=Date.now(),f=o+4;Date.now()<f;);self.postMessage({st:o,et:f})})}.toString(),")()"],{type:"application/javascript"}));n([],5,16);function n(s,o,f){if(o===0){var c=Math.floor(s.reduce(function(u,h){return u+h},0)/s.length);return g.cores=Math.max(1,c),URL.revokeObjectURL(r),e(null,g.cores)}i(f,function(u,h){s.push(a(f,h)),n(s,o-1,f)})}function i(s,o){for(var f=[],c=[],u=0;u<s;++u){var h=new Worker(r);h.addEventListener("message",function(l){if(c.push(l.data),c.length===s){for(var x=0;x<s;++x)f[x].terminate();o(null,c)}}),f.push(h)}for(var u=0;u<s;++u)f[u].postMessage(u)}function a(s,o){for(var f=[],c=0;c<s;++c)for(var u=o[c],h=f[c]=[],l=0;l<s;++l)if(c!==l){var x=o[l];(u.st>x.st&&u.st<x.et||x.st>u.st&&x.st<u.et)&&h.push(l)}return f.reduce(function(p,d){return Math.max(p,d.length)},0)}}});var ii=Q((zd,uo)=>{var _t=st();Bt();uo.exports=_t.cipher=_t.cipher||{};_t.cipher.algorithms=_t.cipher.algorithms||{};_t.cipher.createCipher=function(t,e){var r=t;if(typeof r=="string"&&(r=_t.cipher.getAlgorithm(r),r&&(r=r())),!r)throw new Error("Unsupported algorithm: "+t);return new _t.cipher.BlockCipher({algorithm:r,key:e,decrypt:!1})};_t.cipher.createDecipher=function(t,e){var r=t;if(typeof r=="string"&&(r=_t.cipher.getAlgorithm(r),r&&(r=r())),!r)throw new Error("Unsupported algorithm: "+t);return new _t.cipher.BlockCipher({algorithm:r,key:e,decrypt:!0})};_t.cipher.registerAlgorithm=function(t,e){t=t.toUpperCase(),_t.cipher.algorithms[t]=e};_t.cipher.getAlgorithm=function(t){return t=t.toUpperCase(),t in _t.cipher.algorithms?_t.cipher.algorithms[t]:null};var ni=_t.cipher.BlockCipher=function(t){this.algorithm=t.algorithm,this.mode=this.algorithm.mode,this.blockSize=this.mode.blockSize,this._finish=!1,this._input=null,this.output=null,this._op=t.decrypt?this.mode.decrypt:this.mode.encrypt,this._decrypt=t.decrypt,this.algorithm.initialize(t)};ni.prototype.start=function(t){t=t||{};var e={};for(var r in t)e[r]=t[r];e.decrypt=this._decrypt,this._finish=!1,this._input=_t.util.createBuffer(),this.output=t.output||_t.util.createBuffer(),this.mode.start(e)};ni.prototype.update=function(t){for(t&&this._input.putBuffer(t);!this._op.call(this.mode,this._input,this.output,this._finish)&&!this._finish;);this._input.compact()};ni.prototype.finish=function(t){t&&(this.mode.name==="ECB"||this.mode.name==="CBC")&&(this.mode.pad=function(r){return t(this.blockSize,r,!1)},this.mode.unpad=function(r){return t(this.blockSize,r,!0)});var e={};return e.decrypt=this._decrypt,e.overflow=this._input.length()%this.blockSize,!(!this._decrypt&&this.mode.pad&&!this.mode.pad(this._input,e)||(this._finish=!0,this.update(),this._decrypt&&this.mode.unpad&&!this.mode.unpad(this.output,e))||this.mode.afterFinish&&!this.mode.afterFinish(this.output,e))}});var oi=Q((Gd,ho)=>{var Rt=st();Bt();Rt.cipher=Rt.cipher||{};var X=ho.exports=Rt.cipher.modes=Rt.cipher.modes||{};X.ecb=function(t){t=t||{},this.name="ECB",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)};X.ecb.prototype.start=function(t){};X.ecb.prototype.encrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=t.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._outBlock[n])};X.ecb.prototype.decrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=t.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._outBlock[n])};X.ecb.prototype.pad=function(t,e){var r=t.length()===this.blockSize?this.blockSize:this.blockSize-t.length();return t.fillWithByte(r,r),!0};X.ecb.prototype.unpad=function(t,e){if(e.overflow>0)return!1;var r=t.length(),n=t.at(r-1);return n>this.blockSize<<2?!1:(t.truncate(n),!0)};X.cbc=function(t){t=t||{},this.name="CBC",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)};X.cbc.prototype.start=function(t){if(t.iv===null){if(!this._prev)throw new Error("Invalid IV parameter.");this._iv=this._prev.slice(0)}else if("iv"in t)this._iv=en(t.iv,this.blockSize),this._prev=this._iv.slice(0);else throw new Error("Invalid IV parameter.")};X.cbc.prototype.encrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=this._prev[n]^t.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._outBlock[n]);this._prev=this._outBlock};X.cbc.prototype.decrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=t.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._prev[n]^this._outBlock[n]);this._prev=this._inBlock.slice(0)};X.cbc.prototype.pad=function(t,e){var r=t.length()===this.blockSize?this.blockSize:this.blockSize-t.length();return t.fillWithByte(r,r),!0};X.cbc.prototype.unpad=function(t,e){if(e.overflow>0)return!1;var r=t.length(),n=t.at(r-1);return n>this.blockSize<<2?!1:(t.truncate(n),!0)};X.cfb=function(t){t=t||{},this.name="CFB",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialBlock=new Array(this._ints),this._partialOutput=Rt.util.createBuffer(),this._partialBytes=0};X.cfb.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");this._iv=en(t.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};X.cfb.prototype.encrypt=function(t,e,r){var n=t.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)this._inBlock[i]=t.getInt32()^this._outBlock[i],e.putInt32(this._inBlock[i]);return}var a=(this.blockSize-n)%this.blockSize;a>0&&(a=this.blockSize-a),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialBlock[i]=t.getInt32()^this._outBlock[i],this._partialOutput.putInt32(this._partialBlock[i]);if(a>0)t.read-=this.blockSize;else for(var i=0;i<this._ints;++i)this._inBlock[i]=this._partialBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),a>0&&!r)return e.putBytes(this._partialOutput.getBytes(a-this._partialBytes)),this._partialBytes=a,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0};X.cfb.prototype.decrypt=function(t,e,r){var n=t.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)this._inBlock[i]=t.getInt32(),e.putInt32(this._inBlock[i]^this._outBlock[i]);return}var a=(this.blockSize-n)%this.blockSize;a>0&&(a=this.blockSize-a),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialBlock[i]=t.getInt32(),this._partialOutput.putInt32(this._partialBlock[i]^this._outBlock[i]);if(a>0)t.read-=this.blockSize;else for(var i=0;i<this._ints;++i)this._inBlock[i]=this._partialBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),a>0&&!r)return e.putBytes(this._partialOutput.getBytes(a-this._partialBytes)),this._partialBytes=a,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0};X.ofb=function(t){t=t||{},this.name="OFB",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=Rt.util.createBuffer(),this._partialBytes=0};X.ofb.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");this._iv=en(t.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};X.ofb.prototype.encrypt=function(t,e,r){var n=t.length();if(t.length()===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)e.putInt32(t.getInt32()^this._outBlock[i]),this._inBlock[i]=this._outBlock[i];return}var a=(this.blockSize-n)%this.blockSize;a>0&&(a=this.blockSize-a),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialOutput.putInt32(t.getInt32()^this._outBlock[i]);if(a>0)t.read-=this.blockSize;else for(var i=0;i<this._ints;++i)this._inBlock[i]=this._outBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),a>0&&!r)return e.putBytes(this._partialOutput.getBytes(a-this._partialBytes)),this._partialBytes=a,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0};X.ofb.prototype.decrypt=X.ofb.prototype.encrypt;X.ctr=function(t){t=t||{},this.name="CTR",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=Rt.util.createBuffer(),this._partialBytes=0};X.ctr.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");this._iv=en(t.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};X.ctr.prototype.encrypt=function(t,e,r){var n=t.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize)for(var i=0;i<this._ints;++i)e.putInt32(t.getInt32()^this._outBlock[i]);else{var a=(this.blockSize-n)%this.blockSize;a>0&&(a=this.blockSize-a),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialOutput.putInt32(t.getInt32()^this._outBlock[i]);if(a>0&&(t.read-=this.blockSize),this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),a>0&&!r)return e.putBytes(this._partialOutput.getBytes(a-this._partialBytes)),this._partialBytes=a,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}rn(this._inBlock)};X.ctr.prototype.decrypt=X.ctr.prototype.encrypt;X.gcm=function(t){t=t||{},this.name="GCM",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints),this._partialOutput=Rt.util.createBuffer(),this._partialBytes=0,this._R=3774873600};X.gcm.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");var e=Rt.util.createBuffer(t.iv);this._cipherLength=0;var r;if("additionalData"in t?r=Rt.util.createBuffer(t.additionalData):r=Rt.util.createBuffer(),"tagLength"in t?this._tagLength=t.tagLength:this._tagLength=128,this._tag=null,t.decrypt&&(this._tag=Rt.util.createBuffer(t.tag).getBytes(),this._tag.length!==this._tagLength/8))throw new Error("Authentication tag does not match tag length.");this._hashBlock=new Array(this._ints),this.tag=null,this._hashSubkey=new Array(this._ints),this.cipher.encrypt([0,0,0,0],this._hashSubkey),this.componentBits=4,this._m=this.generateHashTable(this._hashSubkey,this.componentBits);var n=e.length();if(n===12)this._j0=[e.getInt32(),e.getInt32(),e.getInt32(),1];else{for(this._j0=[0,0,0,0];e.length()>0;)this._j0=this.ghash(this._hashSubkey,this._j0,[e.getInt32(),e.getInt32(),e.getInt32(),e.getInt32()]);this._j0=this.ghash(this._hashSubkey,this._j0,[0,0].concat(ai(n*8)))}this._inBlock=this._j0.slice(0),rn(this._inBlock),this._partialBytes=0,r=Rt.util.createBuffer(r),this._aDataLength=ai(r.length()*8);var i=r.length()%this.blockSize;for(i&&r.fillWithByte(0,this.blockSize-i),this._s=[0,0,0,0];r.length()>0;)this._s=this.ghash(this._hashSubkey,this._s,[r.getInt32(),r.getInt32(),r.getInt32(),r.getInt32()])};X.gcm.prototype.encrypt=function(t,e,r){var n=t.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)e.putInt32(this._outBlock[i]^=t.getInt32());this._cipherLength+=this.blockSize}else{var a=(this.blockSize-n)%this.blockSize;a>0&&(a=this.blockSize-a),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialOutput.putInt32(t.getInt32()^this._outBlock[i]);if(a<=0||r){if(r){var s=n%this.blockSize;this._cipherLength+=s,this._partialOutput.truncate(this.blockSize-s)}else this._cipherLength+=this.blockSize;for(var i=0;i<this._ints;++i)this._outBlock[i]=this._partialOutput.getInt32();this._partialOutput.read-=this.blockSize}if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),a>0&&!r)return t.read-=this.blockSize,e.putBytes(this._partialOutput.getBytes(a-this._partialBytes)),this._partialBytes=a,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}this._s=this.ghash(this._hashSubkey,this._s,this._outBlock),rn(this._inBlock)};X.gcm.prototype.decrypt=function(t,e,r){var n=t.length();if(n<this.blockSize&&!(r&&n>0))return!0;this.cipher.encrypt(this._inBlock,this._outBlock),rn(this._inBlock),this._hashBlock[0]=t.getInt32(),this._hashBlock[1]=t.getInt32(),this._hashBlock[2]=t.getInt32(),this._hashBlock[3]=t.getInt32(),this._s=this.ghash(this._hashSubkey,this._s,this._hashBlock);for(var i=0;i<this._ints;++i)e.putInt32(this._outBlock[i]^this._hashBlock[i]);n<this.blockSize?this._cipherLength+=n%this.blockSize:this._cipherLength+=this.blockSize};X.gcm.prototype.afterFinish=function(t,e){var r=!0;e.decrypt&&e.overflow&&t.truncate(this.blockSize-e.overflow),this.tag=Rt.util.createBuffer();var n=this._aDataLength.concat(ai(this._cipherLength*8));this._s=this.ghash(this._hashSubkey,this._s,n);var i=[];this.cipher.encrypt(this._j0,i);for(var a=0;a<this._ints;++a)this.tag.putInt32(this._s[a]^i[a]);return this.tag.truncate(this.tag.length()%(this._tagLength/8)),e.decrypt&&this.tag.bytes()!==this._tag&&(r=!1),r};X.gcm.prototype.multiply=function(t,e){for(var r=[0,0,0,0],n=e.slice(0),i=0;i<128;++i){var a=t[i/32|0]&1<<31-i%32;a&&(r[0]^=n[0],r[1]^=n[1],r[2]^=n[2],r[3]^=n[3]),this.pow(n,n)}return r};X.gcm.prototype.pow=function(t,e){for(var r=t[3]&1,n=3;n>0;--n)e[n]=t[n]>>>1|(t[n-1]&1)<<31;e[0]=t[0]>>>1,r&&(e[0]^=this._R)};X.gcm.prototype.tableMultiply=function(t){for(var e=[0,0,0,0],r=0;r<32;++r){var n=r/8|0,i=t[n]>>>(7-r%8)*4&15,a=this._m[r][i];e[0]^=a[0],e[1]^=a[1],e[2]^=a[2],e[3]^=a[3]}return e};X.gcm.prototype.ghash=function(t,e,r){return e[0]^=r[0],e[1]^=r[1],e[2]^=r[2],e[3]^=r[3],this.tableMultiply(e)};X.gcm.prototype.generateHashTable=function(t,e){for(var r=8/e,n=4*r,i=16*r,a=new Array(i),s=0;s<i;++s){var o=[0,0,0,0],f=s/n|0,c=(n-1-s%n)*e;o[f]=1<<e-1<<c,a[s]=this.generateSubHashTable(this.multiply(o,t),e)}return a};X.gcm.prototype.generateSubHashTable=function(t,e){var r=1<<e,n=r>>>1,i=new Array(r);i[n]=t.slice(0);for(var a=n>>>1;a>0;)this.pow(i[2*a],i[a]=[]),a>>=1;for(a=2;a<n;){for(var s=1;s<a;++s){var o=i[a],f=i[s];i[a+s]=[o[0]^f[0],o[1]^f[1],o[2]^f[2],o[3]^f[3]]}a*=2}for(i[0]=[0,0,0,0],a=n+1;a<r;++a){var c=i[a^n];i[a]=[t[0]^c[0],t[1]^c[1],t[2]^c[2],t[3]^c[3]]}return i};function en(t,e){if(typeof t=="string"&&(t=Rt.util.createBuffer(t)),Rt.util.isArray(t)&&t.length>4){var r=t;t=Rt.util.createBuffer();for(var n=0;n<r.length;++n)t.putByte(r[n])}if(t.length()<e)throw new Error("Invalid IV length; got "+t.length()+" bytes and expected "+e+" bytes.");if(!Rt.util.isArray(t)){for(var i=[],a=e/4,n=0;n<a;++n)i.push(t.getInt32());t=i}return t}function rn(t){t[t.length-1]=t[t.length-1]+1&4294967295}function ai(t){return[t/4294967296|0,t&4294967295]}});var an=Q((Wd,xo)=>{var ut=st();ii();oi();Bt();xo.exports=ut.aes=ut.aes||{};ut.aes.startEncrypting=function(t,e,r,n){var i=nn({key:t,output:r,decrypt:!1,mode:n});return i.start(e),i};ut.aes.createEncryptionCipher=function(t,e){return nn({key:t,output:null,decrypt:!1,mode:e})};ut.aes.startDecrypting=function(t,e,r,n){var i=nn({key:t,output:r,decrypt:!0,mode:n});return i.start(e),i};ut.aes.createDecryptionCipher=function(t,e){return nn({key:t,output:null,decrypt:!0,mode:e})};ut.aes.Algorithm=function(t,e){ci||po();var r=this;r.name=t,r.mode=new e({blockSize:16,cipher:{encrypt:function(n,i){return fi(r._w,n,i,!1)},decrypt:function(n,i){return fi(r._w,n,i,!0)}}}),r._init=!1};ut.aes.Algorithm.prototype.initialize=function(t){if(!this._init){var e=t.key,r;if(typeof e=="string"&&(e.length===16||e.length===24||e.length===32))e=ut.util.createBuffer(e);else if(ut.util.isArray(e)&&(e.length===16||e.length===24||e.length===32)){r=e,e=ut.util.createBuffer();for(var n=0;n<r.length;++n)e.putByte(r[n])}if(!ut.util.isArray(e)){r=e,e=[];var i=r.length();if(i===16||i===24||i===32){i=i>>>2;for(var n=0;n<i;++n)e.push(r.getInt32())}}if(!ut.util.isArray(e)||!(e.length===4||e.length===6||e.length===8))throw new Error("Invalid key parameter.");var a=this.mode.name,s=["CFB","OFB","CTR","GCM"].indexOf(a)!==-1;this._w=yo(e,t.decrypt&&!s),this._init=!0}};ut.aes._expandKey=function(t,e){return ci||po(),yo(t,e)};ut.aes._updateBlock=fi;or("AES-ECB",ut.cipher.modes.ecb);or("AES-CBC",ut.cipher.modes.cbc);or("AES-CFB",ut.cipher.modes.cfb);or("AES-OFB",ut.cipher.modes.ofb);or("AES-CTR",ut.cipher.modes.ctr);or("AES-GCM",ut.cipher.modes.gcm);function or(t,e){var r=function(){return new ut.aes.Algorithm(t,e)};ut.cipher.registerAlgorithm(t,r)}var ci=!1,ar=4,Ot,si,lo,He,$t;function po(){ci=!0,lo=[0,1,2,4,8,16,32,64,128,27,54];for(var t=new Array(256),e=0;e<128;++e)t[e]=e<<1,t[e+128]=e+128<<1^283;Ot=new Array(256),si=new Array(256),He=new Array(4),$t=new Array(4);for(var e=0;e<4;++e)He[e]=new Array(256),$t[e]=new Array(256);for(var r=0,n=0,i,a,s,o,f,c,u,e=0;e<256;++e){o=n^n<<1^n<<2^n<<3^n<<4,o=o>>8^o&255^99,Ot[r]=o,si[o]=r,f=t[o],i=t[r],a=t[i],s=t[a],c=f<<24^o<<16^o<<8^(o^f),u=(i^a^s)<<24^(r^s)<<16^(r^a^s)<<8^(r^i^s);for(var h=0;h<4;++h)He[h][r]=c,$t[h][o]=u,c=c<<24|c>>>8,u=u<<24|u>>>8;r===0?r=n=1:(r=i^t[t[t[i^s]]],n^=t[t[n]])}}function yo(t,e){for(var r=t.slice(0),n,i=1,a=r.length,s=a+6+1,o=ar*s,f=a;f<o;++f)n=r[f-1],f%a===0?(n=Ot[n>>>16&255]<<24^Ot[n>>>8&255]<<16^Ot[n&255]<<8^Ot[n>>>24]^lo[i]<<24,i++):a>6&&f%a===4&&(n=Ot[n>>>24]<<24^Ot[n>>>16&255]<<16^Ot[n>>>8&255]<<8^Ot[n&255]),r[f]=r[f-a]^n;if(e){var c,u=$t[0],h=$t[1],l=$t[2],x=$t[3],p=r.slice(0);o=r.length;for(var f=0,d=o-ar;f<o;f+=ar,d-=ar)if(f===0||f===o-ar)p[f]=r[d],p[f+1]=r[d+3],p[f+2]=r[d+2],p[f+3]=r[d+1];else for(var y=0;y<ar;++y)c=r[d+y],p[f+(3&-y)]=u[Ot[c>>>24]]^h[Ot[c>>>16&255]]^l[Ot[c>>>8&255]]^x[Ot[c&255]];r=p}return r}function fi(t,e,r,n){var i=t.length/4-1,a,s,o,f,c;n?(a=$t[0],s=$t[1],o=$t[2],f=$t[3],c=si):(a=He[0],s=He[1],o=He[2],f=He[3],c=Ot);var u,h,l,x,p,d,y;u=e[0]^t[0],h=e[n?3:1]^t[1],l=e[2]^t[2],x=e[n?1:3]^t[3];for(var m=3,E=1;E<i;++E)p=a[u>>>24]^s[h>>>16&255]^o[l>>>8&255]^f[x&255]^t[++m],d=a[h>>>24]^s[l>>>16&255]^o[x>>>8&255]^f[u&255]^t[++m],y=a[l>>>24]^s[x>>>16&255]^o[u>>>8&255]^f[h&255]^t[++m],x=a[x>>>24]^s[u>>>16&255]^o[h>>>8&255]^f[l&255]^t[++m],u=p,h=d,l=y;r[0]=c[u>>>24]<<24^c[h>>>16&255]<<16^c[l>>>8&255]<<8^c[x&255]^t[++m],r[n?3:1]=c[h>>>24]<<24^c[l>>>16&255]<<16^c[x>>>8&255]<<8^c[u&255]^t[++m],r[2]=c[l>>>24]<<24^c[x>>>16&255]<<16^c[u>>>8&255]<<8^c[h&255]^t[++m],r[n?1:3]=c[x>>>24]<<24^c[u>>>16&255]<<16^c[h>>>8&255]<<8^c[l&255]^t[++m]}function nn(t){t=t||{};var e=(t.mode||"CBC").toUpperCase(),r="AES-"+e,n;t.decrypt?n=ut.cipher.createDecipher(r,t.key):n=ut.cipher.createCipher(r,t.key);var i=n.start;return n.start=function(a,s){var o=null;s instanceof ut.util.ByteBuffer&&(o=s,s={}),s=s||{},s.output=o,s.iv=a,i.call(n,s)},n}});var hn=Q((Y1,Vo)=>{var Ur=st();Ur.pki=Ur.pki||{};var Pi=Vo.exports=Ur.pki.oids=Ur.oids=Ur.oids||{};function I(t,e){Pi[t]=e,Pi[e]=t}function at(t,e){Pi[t]=e}I("1.2.840.113549.1.1.1","rsaEncryption");I("1.2.840.113549.1.1.4","md5WithRSAEncryption");I("1.2.840.113549.1.1.5","sha1WithRSAEncryption");I("1.2.840.113549.1.1.7","RSAES-OAEP");I("1.2.840.113549.1.1.8","mgf1");I("1.2.840.113549.1.1.9","pSpecified");I("1.2.840.113549.1.1.10","RSASSA-PSS");I("1.2.840.113549.1.1.11","sha256WithRSAEncryption");I("1.2.840.113549.1.1.12","sha384WithRSAEncryption");I("1.2.840.113549.1.1.13","sha512WithRSAEncryption");I("1.3.101.112","EdDSA25519");I("1.2.840.10040.4.3","dsa-with-sha1");I("1.3.14.3.2.7","desCBC");I("1.3.14.3.2.26","sha1");I("1.3.14.3.2.29","sha1WithRSASignature");I("2.16.840.1.101.3.4.2.1","sha256");I("2.16.840.1.101.3.4.2.2","sha384");I("2.16.840.1.101.3.4.2.3","sha512");I("2.16.840.1.101.3.4.2.4","sha224");I("2.16.840.1.101.3.4.2.5","sha512-224");I("2.16.840.1.101.3.4.2.6","sha512-256");I("1.2.840.113549.2.2","md2");I("1.2.840.113549.2.5","md5");I("1.2.840.113549.1.7.1","data");I("1.2.840.113549.1.7.2","signedData");I("1.2.840.113549.1.7.3","envelopedData");I("1.2.840.113549.1.7.4","signedAndEnvelopedData");I("1.2.840.113549.1.7.5","digestedData");I("1.2.840.113549.1.7.6","encryptedData");I("1.2.840.113549.1.9.1","emailAddress");I("1.2.840.113549.1.9.2","unstructuredName");I("1.2.840.113549.1.9.3","contentType");I("1.2.840.113549.1.9.4","messageDigest");I("1.2.840.113549.1.9.5","signingTime");I("1.2.840.113549.1.9.6","counterSignature");I("1.2.840.113549.1.9.7","challengePassword");I("1.2.840.113549.1.9.8","unstructuredAddress");I("1.2.840.113549.1.9.14","extensionRequest");I("1.2.840.113549.1.9.20","friendlyName");I("1.2.840.113549.1.9.21","localKeyId");I("1.2.840.113549.1.9.22.1","x509Certificate");I("1.2.840.113549.1.12.10.1.1","keyBag");I("1.2.840.113549.1.12.10.1.2","pkcs8ShroudedKeyBag");I("1.2.840.113549.1.12.10.1.3","certBag");I("1.2.840.113549.1.12.10.1.4","crlBag");I("1.2.840.113549.1.12.10.1.5","secretBag");I("1.2.840.113549.1.12.10.1.6","safeContentsBag");I("1.2.840.113549.1.5.13","pkcs5PBES2");I("1.2.840.113549.1.5.12","pkcs5PBKDF2");I("1.2.840.113549.1.12.1.1","pbeWithSHAAnd128BitRC4");I("1.2.840.113549.1.12.1.2","pbeWithSHAAnd40BitRC4");I("1.2.840.113549.1.12.1.3","pbeWithSHAAnd3-KeyTripleDES-CBC");I("1.2.840.113549.1.12.1.4","pbeWithSHAAnd2-KeyTripleDES-CBC");I("1.2.840.113549.1.12.1.5","pbeWithSHAAnd128BitRC2-CBC");I("1.2.840.113549.1.12.1.6","pbewithSHAAnd40BitRC2-CBC");I("1.2.840.113549.2.7","hmacWithSHA1");I("1.2.840.113549.2.8","hmacWithSHA224");I("1.2.840.113549.2.9","hmacWithSHA256");I("1.2.840.113549.2.10","hmacWithSHA384");I("1.2.840.113549.2.11","hmacWithSHA512");I("1.2.840.113549.3.7","des-EDE3-CBC");I("2.16.840.1.101.3.4.1.2","aes128-CBC");I("2.16.840.1.101.3.4.1.22","aes192-CBC");I("2.16.840.1.101.3.4.1.42","aes256-CBC");I("2.5.4.3","commonName");I("2.5.4.4","surname");I("2.5.4.5","serialNumber");I("2.5.4.6","countryName");I("2.5.4.7","localityName");I("2.5.4.8","stateOrProvinceName");I("2.5.4.9","streetAddress");I("2.5.4.10","organizationName");I("2.5.4.11","organizationalUnitName");I("2.5.4.12","title");I("2.5.4.13","description");I("2.5.4.15","businessCategory");I("2.5.4.17","postalCode");I("2.5.4.42","givenName");I("1.3.6.1.4.1.311.60.2.1.2","jurisdictionOfIncorporationStateOrProvinceName");I("1.3.6.1.4.1.311.60.2.1.3","jurisdictionOfIncorporationCountryName");I("2.16.840.1.113730.1.1","nsCertType");I("2.16.840.1.113730.1.13","nsComment");at("2.5.29.1","authorityKeyIdentifier");at("2.5.29.2","keyAttributes");at("2.5.29.3","certificatePolicies");at("2.5.29.4","keyUsageRestriction");at("2.5.29.5","policyMapping");at("2.5.29.6","subtreesConstraint");at("2.5.29.7","subjectAltName");at("2.5.29.8","issuerAltName");at("2.5.29.9","subjectDirectoryAttributes");at("2.5.29.10","basicConstraints");at("2.5.29.11","nameConstraints");at("2.5.29.12","policyConstraints");at("2.5.29.13","basicConstraints");I("2.5.29.14","subjectKeyIdentifier");I("2.5.29.15","keyUsage");at("2.5.29.16","privateKeyUsagePeriod");I("2.5.29.17","subjectAltName");I("2.5.29.18","issuerAltName");I("2.5.29.19","basicConstraints");at("2.5.29.20","cRLNumber");at("2.5.29.21","cRLReason");at("2.5.29.22","expirationDate");at("2.5.29.23","instructionCode");at("2.5.29.24","invalidityDate");at("2.5.29.25","cRLDistributionPoints");at("2.5.29.26","issuingDistributionPoint");at("2.5.29.27","deltaCRLIndicator");at("2.5.29.28","issuingDistributionPoint");at("2.5.29.29","certificateIssuer");at("2.5.29.30","nameConstraints");I("2.5.29.31","cRLDistributionPoints");I("2.5.29.32","certificatePolicies");at("2.5.29.33","policyMappings");at("2.5.29.34","policyConstraints");I("2.5.29.35","authorityKeyIdentifier");at("2.5.29.36","policyConstraints");I("2.5.29.37","extKeyUsage");at("2.5.29.46","freshestCRL");at("2.5.29.54","inhibitAnyPolicy");I("1.3.6.1.4.1.11129.2.4.2","timestampList");I("1.3.6.1.5.5.7.1.1","authorityInfoAccess");I("1.3.6.1.5.5.7.3.1","serverAuth");I("1.3.6.1.5.5.7.3.2","clientAuth");I("1.3.6.1.5.5.7.3.3","codeSigning");I("1.3.6.1.5.5.7.3.4","emailProtection");I("1.3.6.1.5.5.7.3.8","timeStamping")});var Or=Q((Z1,Ho)=>{var ht=st();Bt();hn();var P=Ho.exports=ht.asn1=ht.asn1||{};P.Class={UNIVERSAL:0,APPLICATION:64,CONTEXT_SPECIFIC:128,PRIVATE:192};P.Type={NONE:0,BOOLEAN:1,INTEGER:2,BITSTRING:3,OCTETSTRING:4,NULL:5,OID:6,ODESC:7,EXTERNAL:8,REAL:9,ENUMERATED:10,EMBEDDED:11,UTF8:12,ROID:13,SEQUENCE:16,SET:17,PRINTABLESTRING:19,IA5STRING:22,UTCTIME:23,GENERALIZEDTIME:24,BMPSTRING:30};P.create=function(t,e,r,n,i){if(ht.util.isArray(n)){for(var a=[],s=0;s<n.length;++s)n[s]!==void 0&&a.push(n[s]);n=a}var o={tagClass:t,type:e,constructed:r,composed:r||ht.util.isArray(n),value:n};return i&&"bitStringContents"in i&&(o.bitStringContents=i.bitStringContents,o.original=P.copy(o)),o};P.copy=function(t,e){var r;if(ht.util.isArray(t)){r=[];for(var n=0;n<t.length;++n)r.push(P.copy(t[n],e));return r}return typeof t=="string"?t:(r={tagClass:t.tagClass,type:t.type,constructed:t.constructed,composed:t.composed,value:P.copy(t.value,e)},e&&!e.excludeBitStringContents&&(r.bitStringContents=t.bitStringContents),r)};P.equals=function(t,e,r){if(ht.util.isArray(t)){if(!ht.util.isArray(e)||t.length!==e.length)return!1;for(var n=0;n<t.length;++n)if(!P.equals(t[n],e[n]))return!1;return!0}if(typeof t!=typeof e)return!1;if(typeof t=="string")return t===e;var i=t.tagClass===e.tagClass&&t.type===e.type&&t.constructed===e.constructed&&t.composed===e.composed&&P.equals(t.value,e.value);return r&&r.includeBitStringContents&&(i=i&&t.bitStringContents===e.bitStringContents),i};P.getBerValueLength=function(t){var e=t.getByte();if(e!==128){var r,n=e&128;return n?r=t.getInt((e&127)<<3):r=e,r}};function Kr(t,e,r){if(r>e){var n=new Error("Too few bytes to parse DER.");throw n.available=t.length(),n.remaining=e,n.requested=r,n}}var bu=function(t,e){var r=t.getByte();if(e--,r!==128){var n,i=r&128;if(!i)n=r;else{var a=r&127;Kr(t,e,a),n=t.getInt(a<<3)}if(n<0)throw new Error("Negative length: "+n);return n}};P.fromDer=function(t,e){e===void 0&&(e={strict:!0,parseAllBytes:!0,decodeBitStrings:!0}),typeof e=="boolean"&&(e={strict:e,parseAllBytes:!0,decodeBitStrings:!0}),"strict"in e||(e.strict=!0),"parseAllBytes"in e||(e.parseAllBytes=!0),"decodeBitStrings"in e||(e.decodeBitStrings=!0),typeof t=="string"&&(t=ht.util.createBuffer(t));var r=t.length(),n=ln(t,t.length(),0,e);if(e.parseAllBytes&&t.length()!==0){var i=new Error("Unparsed DER bytes remain after ASN.1 parsing.");throw i.byteCount=r,i.remaining=t.length(),i}return n};function ln(t,e,r,n){var i;Kr(t,e,2);var a=t.getByte();e--;var s=a&192,o=a&31;i=t.length();var f=bu(t,e);if(e-=i-t.length(),f!==void 0&&f>e){if(n.strict){var c=new Error("Too few bytes to read ASN.1 value.");throw c.available=t.length(),c.remaining=e,c.requested=f,c}f=e}var u,h,l=(a&32)===32;if(l)if(u=[],f===void 0)for(;;){if(Kr(t,e,2),t.bytes(2)===String.fromCharCode(0,0)){t.getBytes(2),e-=2;break}i=t.length(),u.push(ln(t,e,r+1,n)),e-=i-t.length()}else for(;f>0;)i=t.length(),u.push(ln(t,f,r+1,n)),e-=i-t.length(),f-=i-t.length();if(u===void 0&&s===P.Class.UNIVERSAL&&o===P.Type.BITSTRING&&(h=t.bytes(f)),u===void 0&&n.decodeBitStrings&&s===P.Class.UNIVERSAL&&o===P.Type.BITSTRING&&f>1){var x=t.read,p=e,d=0;if(o===P.Type.BITSTRING&&(Kr(t,e,1),d=t.getByte(),e--),d===0)try{i=t.length();var y={strict:!0,decodeBitStrings:!0},m=ln(t,e,r+1,y),E=i-t.length();e-=E,o==P.Type.BITSTRING&&E++;var b=m.tagClass;E===f&&(b===P.Class.UNIVERSAL||b===P.Class.CONTEXT_SPECIFIC)&&(u=[m])}catch{}u===void 0&&(t.read=x,e=p)}if(u===void 0){if(f===void 0){if(n.strict)throw new Error("Non-constructed ASN.1 object of indefinite length.");f=e}if(o===P.Type.BMPSTRING)for(u="";f>0;f-=2)Kr(t,e,2),u+=String.fromCharCode(t.getInt16()),e-=2;else u=t.getBytes(f),e-=f}var R=h===void 0?null:{bitStringContents:h};return P.create(s,o,l,u,R)}P.toDer=function(t){var e=ht.util.createBuffer(),r=t.tagClass|t.type,n=ht.util.createBuffer(),i=!1;if("bitStringContents"in t&&(i=!0,t.original&&(i=P.equals(t,t.original))),i)n.putBytes(t.bitStringContents);else if(t.composed){t.constructed?r|=32:n.putByte(0);for(var a=0;a<t.value.length;++a)t.value[a]!==void 0&&n.putBuffer(P.toDer(t.value[a]))}else if(t.type===P.Type.BMPSTRING)for(var a=0;a<t.value.length;++a)n.putInt16(t.value.charCodeAt(a));else t.type===P.Type.INTEGER&&t.value.length>1&&(t.value.charCodeAt(0)===0&&!(t.value.charCodeAt(1)&128)||t.value.charCodeAt(0)===255&&(t.value.charCodeAt(1)&128)===128)?n.putBytes(t.value.substr(1)):n.putBytes(t.value);if(e.putByte(r),n.length()<=127)e.putByte(n.length()&127);else{var s=n.length(),o="";do o+=String.fromCharCode(s&255),s=s>>>8;while(s>0);e.putByte(o.length|128);for(var a=o.length-1;a>=0;--a)e.putByte(o.charCodeAt(a))}return e.putBuffer(n),e};P.oidToDer=function(t){var e=t.split("."),r=ht.util.createBuffer();r.putByte(40*parseInt(e[0],10)+parseInt(e[1],10));for(var n,i,a,s,o=2;o<e.length;++o){n=!0,i=[],a=parseInt(e[o],10);do s=a&127,a=a>>>7,n||(s|=128),i.push(s),n=!1;while(a>0);for(var f=i.length-1;f>=0;--f)r.putByte(i[f])}return r};P.derToOid=function(t){var e;typeof t=="string"&&(t=ht.util.createBuffer(t));var r=t.getByte();e=Math.floor(r/40)+"."+r%40;for(var n=0;t.length()>0;)r=t.getByte(),n=n<<7,r&128?n+=r&127:(e+="."+(n+r),n=0);return e};P.utcTimeToDate=function(t){var e=new Date,r=parseInt(t.substr(0,2),10);r=r>=50?1900+r:2e3+r;var n=parseInt(t.substr(2,2),10)-1,i=parseInt(t.substr(4,2),10),a=parseInt(t.substr(6,2),10),s=parseInt(t.substr(8,2),10),o=0;if(t.length>11){var f=t.charAt(10),c=10;f!=="+"&&f!=="-"&&(o=parseInt(t.substr(10,2),10),c+=2)}if(e.setUTCFullYear(r,n,i),e.setUTCHours(a,s,o,0),c&&(f=t.charAt(c),f==="+"||f==="-")){var u=parseInt(t.substr(c+1,2),10),h=parseInt(t.substr(c+4,2),10),l=u*60+h;l*=6e4,f==="+"?e.setTime(+e-l):e.setTime(+e+l)}return e};P.generalizedTimeToDate=function(t){var e=new Date,r=parseInt(t.substr(0,4),10),n=parseInt(t.substr(4,2),10)-1,i=parseInt(t.substr(6,2),10),a=parseInt(t.substr(8,2),10),s=parseInt(t.substr(10,2),10),o=parseInt(t.substr(12,2),10),f=0,c=0,u=!1;t.charAt(t.length-1)==="Z"&&(u=!0);var h=t.length-5,l=t.charAt(h);if(l==="+"||l==="-"){var x=parseInt(t.substr(h+1,2),10),p=parseInt(t.substr(h+4,2),10);c=x*60+p,c*=6e4,l==="+"&&(c*=-1),u=!0}return t.charAt(14)==="."&&(f=parseFloat(t.substr(14),10)*1e3),u?(e.setUTCFullYear(r,n,i),e.setUTCHours(a,s,o,f),e.setTime(+e+c)):(e.setFullYear(r,n,i),e.setHours(a,s,o,f)),e};P.dateToUtcTime=function(t){if(typeof t=="string")return t;var e="",r=[];r.push((""+t.getUTCFullYear()).substr(2)),r.push(""+(t.getUTCMonth()+1)),r.push(""+t.getUTCDate()),r.push(""+t.getUTCHours()),r.push(""+t.getUTCMinutes()),r.push(""+t.getUTCSeconds());for(var n=0;n<r.length;++n)r[n].length<2&&(e+="0"),e+=r[n];return e+="Z",e};P.dateToGeneralizedTime=function(t){if(typeof t=="string")return t;var e="",r=[];r.push(""+t.getUTCFullYear()),r.push(""+(t.getUTCMonth()+1)),r.push(""+t.getUTCDate()),r.push(""+t.getUTCHours()),r.push(""+t.getUTCMinutes()),r.push(""+t.getUTCSeconds());for(var n=0;n<r.length;++n)r[n].length<2&&(e+="0"),e+=r[n];return e+="Z",e};P.integerToDer=function(t){var e=ht.util.createBuffer();if(t>=-128&&t<128)return e.putSignedInt(t,8);if(t>=-32768&&t<32768)return e.putSignedInt(t,16);if(t>=-8388608&&t<8388608)return e.putSignedInt(t,24);if(t>=-2147483648&&t<2147483648)return e.putSignedInt(t,32);var r=new Error("Integer too large; max is 32-bits.");throw r.integer=t,r};P.derToInteger=function(t){typeof t=="string"&&(t=ht.util.createBuffer(t));var e=t.length()*8;if(e>32)throw new Error("Integer too large; max is 32-bits.");return t.getSignedInt(e)};P.validate=function(t,e,r,n){var i=!1;if((t.tagClass===e.tagClass||typeof e.tagClass>"u")&&(t.type===e.type||typeof e.type>"u"))if(t.constructed===e.constructed||typeof e.constructed>"u"){if(i=!0,e.value&&ht.util.isArray(e.value))for(var a=0,s=0;i&&s<e.value.length;++s)i=e.value[s].optional||!1,t.value[a]&&(i=P.validate(t.value[a],e.value[s],r,n),i?++a:e.value[s].optional&&(i=!0)),!i&&n&&n.push("["+e.name+'] Tag class "'+e.tagClass+'", type "'+e.type+'" expected value length "'+e.value.length+'", got "'+t.value.length+'"');if(i&&r&&(e.capture&&(r[e.capture]=t.value),e.captureAsn1&&(r[e.captureAsn1]=t),e.captureBitStringContents&&"bitStringContents"in t&&(r[e.captureBitStringContents]=t.bitStringContents),e.captureBitStringValue&&"bitStringContents"in t)){var o;if(t.bitStringContents.length<2)r[e.captureBitStringValue]="";else{var f=t.bitStringContents.charCodeAt(0);if(f!==0)throw new Error("captureBitStringValue only supported for zero unused bits");r[e.captureBitStringValue]=t.bitStringContents.slice(1)}}}else n&&n.push("["+e.name+'] Expected constructed "'+e.constructed+'", got "'+t.constructed+'"');else n&&(t.tagClass!==e.tagClass&&n.push("["+e.name+'] Expected tag class "'+e.tagClass+'", got "'+t.tagClass+'"'),t.type!==e.type&&n.push("["+e.name+'] Expected type "'+e.type+'", got "'+t.type+'"'));return i};var Fo=/[^\\u0000-\\u00ff]/;P.prettyPrint=function(t,e,r){var n="";e=e||0,r=r||2,e>0&&(n+=`
`);for(var i="",a=0;a<e*r;++a)i+=" ";switch(n+=i+"Tag: ",t.tagClass){case P.Class.UNIVERSAL:n+="Universal:";break;case P.Class.APPLICATION:n+="Application:";break;case P.Class.CONTEXT_SPECIFIC:n+="Context-Specific:";break;case P.Class.PRIVATE:n+="Private:";break}if(t.tagClass===P.Class.UNIVERSAL)switch(n+=t.type,t.type){case P.Type.NONE:n+=" (None)";break;case P.Type.BOOLEAN:n+=" (Boolean)";break;case P.Type.INTEGER:n+=" (Integer)";break;case P.Type.BITSTRING:n+=" (Bit string)";break;case P.Type.OCTETSTRING:n+=" (Octet string)";break;case P.Type.NULL:n+=" (Null)";break;case P.Type.OID:n+=" (Object Identifier)";break;case P.Type.ODESC:n+=" (Object Descriptor)";break;case P.Type.EXTERNAL:n+=" (External or Instance of)";break;case P.Type.REAL:n+=" (Real)";break;case P.Type.ENUMERATED:n+=" (Enumerated)";break;case P.Type.EMBEDDED:n+=" (Embedded PDV)";break;case P.Type.UTF8:n+=" (UTF8)";break;case P.Type.ROID:n+=" (Relative Object Identifier)";break;case P.Type.SEQUENCE:n+=" (Sequence)";break;case P.Type.SET:n+=" (Set)";break;case P.Type.PRINTABLESTRING:n+=" (Printable String)";break;case P.Type.IA5String:n+=" (IA5String (ASCII))";break;case P.Type.UTCTIME:n+=" (UTC time)";break;case P.Type.GENERALIZEDTIME:n+=" (Generalized time)";break;case P.Type.BMPSTRING:n+=" (BMP String)";break}else n+=t.type;if(n+=`
`,n+=i+"Constructed: "+t.constructed+`
`,t.composed){for(var s=0,o="",a=0;a<t.value.length;++a)t.value[a]!==void 0&&(s+=1,o+=P.prettyPrint(t.value[a],e+1,r),a+1<t.value.length&&(o+=","));n+=i+"Sub values: "+s+o}else{if(n+=i+"Value: ",t.type===P.Type.OID){var f=P.derToOid(t.value);n+=f,ht.pki&&ht.pki.oids&&f in ht.pki.oids&&(n+=" ("+ht.pki.oids[f]+") ")}if(t.type===P.Type.INTEGER)try{n+=P.derToInteger(t.value)}catch{n+="0x"+ht.util.bytesToHex(t.value)}else if(t.type===P.Type.BITSTRING){if(t.value.length>1?n+="0x"+ht.util.bytesToHex(t.value.slice(1)):n+="(none)",t.value.length>0){var c=t.value.charCodeAt(0);c==1?n+=" (1 unused bit shown)":c>1&&(n+=" ("+c+" unused bits shown)")}}else if(t.type===P.Type.OCTETSTRING)Fo.test(t.value)||(n+="("+t.value+") "),n+="0x"+ht.util.bytesToHex(t.value);else if(t.type===P.Type.UTF8)try{n+=ht.util.decodeUtf8(t.value)}catch(u){if(u.message==="URI malformed")n+="0x"+ht.util.bytesToHex(t.value)+" (malformed UTF8)";else throw u}else t.type===P.Type.PRINTABLESTRING||t.type===P.Type.IA5String?n+=t.value:Fo.test(t.value)?n+="0x"+ht.util.bytesToHex(t.value):t.value.length===0?n+="[null]":n+=t.value}return n}});var Wo=Q(($1,Go)=>{var dt=st();ii();oi();Bt();Go.exports=dt.des=dt.des||{};dt.des.startEncrypting=function(t,e,r,n){var i=pn({key:t,output:r,decrypt:!1,mode:n||(e===null?"ECB":"CBC")});return i.start(e),i};dt.des.createEncryptionCipher=function(t,e){return pn({key:t,output:null,decrypt:!1,mode:e})};dt.des.startDecrypting=function(t,e,r,n){var i=pn({key:t,output:r,decrypt:!0,mode:n||(e===null?"ECB":"CBC")});return i.start(e),i};dt.des.createDecryptionCipher=function(t,e){return pn({key:t,output:null,decrypt:!0,mode:e})};dt.des.Algorithm=function(t,e){var r=this;r.name=t,r.mode=new e({blockSize:8,cipher:{encrypt:function(n,i){return zo(r._keys,n,i,!1)},decrypt:function(n,i){return zo(r._keys,n,i,!0)}}}),r._init=!1};dt.des.Algorithm.prototype.initialize=function(t){if(!this._init){var e=dt.util.createBuffer(t.key);if(this.name.indexOf("3DES")===0&&e.length()!==24)throw new Error("Invalid Triple-DES key size: "+e.length()*8);this._keys=_u(e),this._init=!0}};oe("DES-ECB",dt.cipher.modes.ecb);oe("DES-CBC",dt.cipher.modes.cbc);oe("DES-CFB",dt.cipher.modes.cfb);oe("DES-OFB",dt.cipher.modes.ofb);oe("DES-CTR",dt.cipher.modes.ctr);oe("3DES-ECB",dt.cipher.modes.ecb);oe("3DES-CBC",dt.cipher.modes.cbc);oe("3DES-CFB",dt.cipher.modes.cfb);oe("3DES-OFB",dt.cipher.modes.ofb);oe("3DES-CTR",dt.cipher.modes.ctr);function oe(t,e){var r=function(){return new dt.des.Algorithm(t,e)};dt.cipher.registerAlgorithm(t,r)}var Eu=[16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756],wu=[-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344],Bu=[520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584],Su=[8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928],Au=[256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080],Cu=[536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312],Tu=[2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154],Iu=[268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696];function _u(t){for(var e=[0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964],r=[0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697],n=[0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272],i=[0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,139264,2236416,134356992,136454144],a=[0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256],s=[0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488],o=[0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746],f=[0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,537069568],c=[0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578],u=[0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488],h=[0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800],l=[0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744],x=[0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128],p=[0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261],d=t.length()>8?3:1,y=[],m=[0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0],E=0,b,R=0;R<d;R++){var w=t.getInt32(),B=t.getInt32();b=(w>>>4^B)&252645135,B^=b,w^=b<<4,b=(B>>>-16^w)&65535,w^=b,B^=b<<-16,b=(w>>>2^B)&858993459,B^=b,w^=b<<2,b=(B>>>-16^w)&65535,w^=b,B^=b<<-16,b=(w>>>1^B)&1431655765,B^=b,w^=b<<1,b=(B>>>8^w)&16711935,w^=b,B^=b<<8,b=(w>>>1^B)&1431655765,B^=b,w^=b<<1,b=w<<8|B>>>20&240,w=B<<24|B<<8&16711680|B>>>8&65280|B>>>24&240,B=b;for(var L=0;L<m.length;++L){m[L]?(w=w<<2|w>>>26,B=B<<2|B>>>26):(w=w<<1|w>>>27,B=B<<1|B>>>27),w&=-15,B&=-15;var D=e[w>>>28]|r[w>>>24&15]|n[w>>>20&15]|i[w>>>16&15]|a[w>>>12&15]|s[w>>>8&15]|o[w>>>4&15],G=f[B>>>28]|c[B>>>24&15]|u[B>>>20&15]|h[B>>>16&15]|l[B>>>12&15]|x[B>>>8&15]|p[B>>>4&15];b=(G>>>16^D)&65535,y[E++]=D^b,y[E++]=G^b<<16}}return y}function zo(t,e,r,n){var i=t.length===32?3:9,a;i===3?a=n?[30,-2,-2]:[0,32,2]:a=n?[94,62,-2,32,64,2,30,-2,-2]:[0,32,2,62,30,-2,64,96,2];var s,o=e[0],f=e[1];s=(o>>>4^f)&252645135,f^=s,o^=s<<4,s=(o>>>16^f)&65535,f^=s,o^=s<<16,s=(f>>>2^o)&858993459,o^=s,f^=s<<2,s=(f>>>8^o)&16711935,o^=s,f^=s<<8,s=(o>>>1^f)&1431655765,f^=s,o^=s<<1,o=o<<1|o>>>31,f=f<<1|f>>>31;for(var c=0;c<i;c+=3){for(var u=a[c+1],h=a[c+2],l=a[c];l!=u;l+=h){var x=f^t[l],p=(f>>>4|f<<28)^t[l+1];s=o,o=f,f=s^(wu[x>>>24&63]|Su[x>>>16&63]|Cu[x>>>8&63]|Iu[x&63]|Eu[p>>>24&63]|Bu[p>>>16&63]|Au[p>>>8&63]|Tu[p&63])}s=o,o=f,f=s}o=o>>>1|o<<31,f=f>>>1|f<<31,s=(o>>>1^f)&1431655765,f^=s,o^=s<<1,s=(f>>>8^o)&16711935,o^=s,f^=s<<8,s=(f>>>2^o)&858993459,o^=s,f^=s<<2,s=(o>>>16^f)&65535,f^=s,o^=s<<16,s=(o>>>4^f)&252645135,f^=s,o^=s<<4,r[0]=o,r[1]=f}function pn(t){t=t||{};var e=(t.mode||"CBC").toUpperCase(),r="DES-"+e,n;t.decrypt?n=dt.cipher.createDecipher(r,t.key):n=dt.cipher.createCipher(r,t.key);var i=n.start;return n.start=function(a,s){var o=null;s instanceof dt.util.ByteBuffer&&(o=s,s={}),s=s||{},s.output=o,s.iv=a,i.call(n,s)},n}});var Ge=Q((Q1,Yo)=>{var dn=st();Yo.exports=dn.md=dn.md||{};dn.md.algorithms=dn.md.algorithms||{}});var $o=Q((X1,Zo)=>{var me=st();Ge();Bt();var Ru=Zo.exports=me.hmac=me.hmac||{};Ru.create=function(){var t=null,e=null,r=null,n=null,i={};return i.start=function(a,s){if(a!==null)if(typeof a=="string")if(a=a.toLowerCase(),a in me.md.algorithms)e=me.md.algorithms[a].create();else throw new Error('Unknown hash algorithm "'+a+'"');else e=a;if(s===null)s=t;else{if(typeof s=="string")s=me.util.createBuffer(s);else if(me.util.isArray(s)){var o=s;s=me.util.createBuffer();for(var f=0;f<o.length;++f)s.putByte(o[f])}var c=s.length();c>e.blockLength&&(e.start(),e.update(s.bytes()),s=e.digest()),r=me.util.createBuffer(),n=me.util.createBuffer(),c=s.length();for(var f=0;f<c;++f){var o=s.at(f);r.putByte(54^o),n.putByte(92^o)}if(c<e.blockLength)for(var o=e.blockLength-c,f=0;f<o;++f)r.putByte(54),n.putByte(92);t=s,r=r.bytes(),n=n.bytes()}e.start(),e.update(r)},i.update=function(a){e.update(a)},i.getMac=function(){var a=e.digest().bytes();return e.start(),e.update(n),e.update(a),e.digest()},i.digest=i.getMac,i}});var yn=Q(()=>{});var Ui=Q((ty,Qo)=>{var Mt=st();$o();Ge();Bt();var Lu=Mt.pkcs5=Mt.pkcs5||{},ve;Mt.util.isNodejs&&!Mt.options.usePureJavaScript&&(ve=yn());Qo.exports=Mt.pbkdf2=Lu.pbkdf2=function(t,e,r,n,i,a){if(typeof i=="function"&&(a=i,i=null),Mt.util.isNodejs&&!Mt.options.usePureJavaScript&&ve.pbkdf2&&(i===null||typeof i!="object")&&(ve.pbkdf2Sync.length>4||!i||i==="sha1"))return typeof i!="string"&&(i="sha1"),t=Buffer.from(t,"binary"),e=Buffer.from(e,"binary"),a?ve.pbkdf2Sync.length===4?ve.pbkdf2(t,e,r,n,function(b,R){if(b)return a(b);a(null,R.toString("binary"))}):ve.pbkdf2(t,e,r,n,i,function(b,R){if(b)return a(b);a(null,R.toString("binary"))}):ve.pbkdf2Sync.length===4?ve.pbkdf2Sync(t,e,r,n).toString("binary"):ve.pbkdf2Sync(t,e,r,n,i).toString("binary");if((typeof i>"u"||i===null)&&(i="sha1"),typeof i=="string"){if(!(i in Mt.md.algorithms))throw new Error("Unknown hash algorithm: "+i);i=Mt.md[i].create()}var s=i.digestLength;if(n>4294967295*s){var o=new Error("Derived key is too long.");if(a)return a(o);throw o}var f=Math.ceil(n/s),c=n-(f-1)*s,u=Mt.hmac.create();u.start(i,t);var h="",l,x,p;if(!a){for(var d=1;d<=f;++d){u.start(null,null),u.update(e),u.update(Mt.util.int32ToBytes(d)),l=p=u.digest().getBytes();for(var y=2;y<=r;++y)u.start(null,null),u.update(p),x=u.digest().getBytes(),l=Mt.util.xorBytes(l,x,s),p=x;h+=d<f?l:l.substr(0,c)}return h}var d=1,y;function m(){if(d>f)return a(null,h);u.start(null,null),u.update(e),u.update(Mt.util.int32ToBytes(d)),l=p=u.digest().getBytes(),y=2,E()}function E(){if(y<=r)return u.start(null,null),u.update(p),x=u.digest().getBytes(),l=Mt.util.xorBytes(l,x,s),p=x,++y,Mt.util.setImmediate(E);h+=d<f?l:l.substr(0,c),++d,m()}m()}});var jo=Q((ey,Jo)=>{var gn=st();Bt();var Xo=Jo.exports=gn.pem=gn.pem||{};Xo.encode=function(t,e){e=e||{};var r="-----BEGIN "+t.type+`-----\r
`,n;if(t.procType&&(n={name:"Proc-Type",values:[String(t.procType.version),t.procType.type]},r+=xn(n)),t.contentDomain&&(n={name:"Content-Domain",values:[t.contentDomain]},r+=xn(n)),t.dekInfo&&(n={name:"DEK-Info",values:[t.dekInfo.algorithm]},t.dekInfo.parameters&&n.values.push(t.dekInfo.parameters),r+=xn(n)),t.headers)for(var i=0;i<t.headers.length;++i)r+=xn(t.headers[i]);return t.procType&&(r+=`\r
`),r+=gn.util.encode64(t.body,e.maxline||64)+`\r
`,r+="-----END "+t.type+`-----\r
`,r};Xo.decode=function(t){for(var e=[],r=/\s*-----BEGIN ([A-Z0-9- ]+)-----\r?\n?([\x21-\x7e\s]+?(?:\r?\n\r?\n))?([:A-Za-z0-9+\/=\s]+?)-----END \1-----/g,n=/([\x21-\x7e]+):\s*([\x21-\x7e\s^:]+)/,i=/\r?\n/,a;a=r.exec(t),!!a;){var s=a[1];s==="NEW CERTIFICATE REQUEST"&&(s="CERTIFICATE REQUEST");var o={type:s,procType:null,contentDomain:null,dekInfo:null,headers:[],body:gn.util.decode64(a[3])};if(e.push(o),!!a[2]){for(var f=a[2].split(i),c=0;a&&c<f.length;){for(var u=f[c].replace(/\s+$/,""),h=c+1;h<f.length;++h){var l=f[h];if(!/\s/.test(l[0]))break;u+=l,c=h}if(a=u.match(n),a){for(var x={name:a[1],values:[]},p=a[2].split(","),d=0;d<p.length;++d)x.values.push(Du(p[d]));if(o.procType)if(!o.contentDomain&&x.name==="Content-Domain")o.contentDomain=p[0]||"";else if(!o.dekInfo&&x.name==="DEK-Info"){if(x.values.length===0)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must have at least one subfield.');o.dekInfo={algorithm:p[0],parameters:p[1]||null}}else o.headers.push(x);else{if(x.name!=="Proc-Type")throw new Error('Invalid PEM formatted message. The first encapsulated header must be "Proc-Type".');if(x.values.length!==2)throw new Error('Invalid PEM formatted message. The "Proc-Type" header must have two subfields.');o.procType={version:p[0],type:p[1]}}}++c}if(o.procType==="ENCRYPTED"&&!o.dekInfo)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must be present if "Proc-Type" is "ENCRYPTED".')}}if(e.length===0)throw new Error("Invalid PEM formatted message.");return e};function xn(t){for(var e=t.name+": ",r=[],n=function(f,c){return" "+c},i=0;i<t.values.length;++i)r.push(t.values[i].replace(/^(\S+\r\n)/,n));e+=r.join(",")+`\r
`;for(var a=0,s=-1,i=0;i<e.length;++i,++a)if(a>65&&s!==-1){var o=e[s];o===","?(++s,e=e.substr(0,s)+`\r
 `+e.substr(s)):e=e.substr(0,s)+`\r
`+o+e.substr(s+1),a=i-s-1,s=-1,++i}else(e[i]===" "||e[i]==="	"||e[i]===",")&&(s=i);return e}function Du(t){return t.replace(/^\s+/,"")}});var as=Q((ry,is)=>{var se=st();Ge();Bt();var es=is.exports=se.sha256=se.sha256||{};se.md.sha256=se.md.algorithms.sha256=es;es.create=function(){rs||Nu();var t=null,e=se.util.createBuffer(),r=new Array(64),n={algorithm:"sha256",blockLength:64,digestLength:32,messageLength:0,fullMessageLength:null,messageLengthSize:8};return n.start=function(){n.messageLength=0,n.fullMessageLength=n.messageLength64=[];for(var i=n.messageLengthSize/4,a=0;a<i;++a)n.fullMessageLength.push(0);return e=se.util.createBuffer(),t={h0:1779033703,h1:3144134277,h2:1013904242,h3:2773480762,h4:1359893119,h5:2600822924,h6:528734635,h7:1541459225},n},n.start(),n.update=function(i,a){a==="utf8"&&(i=se.util.encodeUtf8(i));var s=i.length;n.messageLength+=s,s=[s/4294967296>>>0,s>>>0];for(var o=n.fullMessageLength.length-1;o>=0;--o)n.fullMessageLength[o]+=s[1],s[1]=s[0]+(n.fullMessageLength[o]/4294967296>>>0),n.fullMessageLength[o]=n.fullMessageLength[o]>>>0,s[0]=s[1]/4294967296>>>0;return e.putBytes(i),ts(t,r,e),(e.read>2048||e.length()===0)&&e.compact(),n},n.digest=function(){var i=se.util.createBuffer();i.putBytes(e.bytes());var a=n.fullMessageLength[n.fullMessageLength.length-1]+n.messageLengthSize,s=a&n.blockLength-1;i.putBytes(Ki.substr(0,n.blockLength-s));for(var o,f,c=n.fullMessageLength[0]*8,u=0;u<n.fullMessageLength.length-1;++u)o=n.fullMessageLength[u+1]*8,f=o/4294967296>>>0,c+=f,i.putInt32(c>>>0),c=o>>>0;i.putInt32(c);var h={h0:t.h0,h1:t.h1,h2:t.h2,h3:t.h3,h4:t.h4,h5:t.h5,h6:t.h6,h7:t.h7};ts(h,r,i);var l=se.util.createBuffer();return l.putInt32(h.h0),l.putInt32(h.h1),l.putInt32(h.h2),l.putInt32(h.h3),l.putInt32(h.h4),l.putInt32(h.h5),l.putInt32(h.h6),l.putInt32(h.h7),l},n};var Ki=null,rs=!1,ns=null;function Nu(){Ki=String.fromCharCode(128),Ki+=se.util.fillString(String.fromCharCode(0),64),ns=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],rs=!0}function ts(t,e,r){for(var n,i,a,s,o,f,c,u,h,l,x,p,d,y,m,E=r.length();E>=64;){for(c=0;c<16;++c)e[c]=r.getInt32();for(;c<64;++c)n=e[c-2],n=(n>>>17|n<<15)^(n>>>19|n<<13)^n>>>10,i=e[c-15],i=(i>>>7|i<<25)^(i>>>18|i<<14)^i>>>3,e[c]=n+e[c-7]+i+e[c-16]|0;for(u=t.h0,h=t.h1,l=t.h2,x=t.h3,p=t.h4,d=t.h5,y=t.h6,m=t.h7,c=0;c<64;++c)s=(p>>>6|p<<26)^(p>>>11|p<<21)^(p>>>25|p<<7),o=y^p&(d^y),a=(u>>>2|u<<30)^(u>>>13|u<<19)^(u>>>22|u<<10),f=u&h|l&(u^h),n=m+s+o+ns[c]+e[c],i=a+f,m=y,y=d,d=p,p=x+n>>>0,x=l,l=h,h=u,u=n+i>>>0;t.h0=t.h0+u|0,t.h1=t.h1+h|0,t.h2=t.h2+l|0,t.h3=t.h3+x|0,t.h4=t.h4+p|0,t.h5=t.h5+d|0,t.h6=t.h6+y|0,t.h7=t.h7+m|0,E-=64}}});var ss=Q((ny,os)=>{var fe=st();Bt();var mn=null;fe.util.isNodejs&&!fe.options.usePureJavaScript&&!process.versions["node-webkit"]&&(mn=yn());var ku=os.exports=fe.prng=fe.prng||{};ku.create=function(t){for(var e={plugin:t,key:null,seed:null,time:null,reseeds:0,generated:0,keyBytes:""},r=t.md,n=new Array(32),i=0;i<32;++i)n[i]=r.create();e.pools=n,e.pool=0,e.generate=function(c,u){if(!u)return e.generateSync(c);var h=e.plugin.cipher,l=e.plugin.increment,x=e.plugin.formatKey,p=e.plugin.formatSeed,d=fe.util.createBuffer();e.key=null,y();function y(m){if(m)return u(m);if(d.length()>=c)return u(null,d.getBytes(c));if(e.generated>1048575&&(e.key=null),e.key===null)return fe.util.nextTick(function(){a(y)});var E=h(e.key,e.seed);e.generated+=E.length,d.putBytes(E),e.key=x(h(e.key,l(e.seed))),e.seed=p(h(e.key,e.seed)),fe.util.setImmediate(y)}},e.generateSync=function(c){var u=e.plugin.cipher,h=e.plugin.increment,l=e.plugin.formatKey,x=e.plugin.formatSeed;e.key=null;for(var p=fe.util.createBuffer();p.length()<c;){e.generated>1048575&&(e.key=null),e.key===null&&s();var d=u(e.key,e.seed);e.generated+=d.length,p.putBytes(d),e.key=l(u(e.key,h(e.seed))),e.seed=x(u(e.key,e.seed))}return p.getBytes(c)};function a(c){if(e.pools[0].messageLength>=32)return o(),c();var u=32-e.pools[0].messageLength<<5;e.seedFile(u,function(h,l){if(h)return c(h);e.collect(l),o(),c()})}function s(){if(e.pools[0].messageLength>=32)return o();var c=32-e.pools[0].messageLength<<5;e.collect(e.seedFileSync(c)),o()}function o(){e.reseeds=e.reseeds===4294967295?0:e.reseeds+1;var c=e.plugin.md.create();c.update(e.keyBytes);for(var u=1,h=0;h<32;++h)e.reseeds%u===0&&(c.update(e.pools[h].digest().getBytes()),e.pools[h].start()),u=u<<1;e.keyBytes=c.digest().getBytes(),c.start(),c.update(e.keyBytes);var l=c.digest().getBytes();e.key=e.plugin.formatKey(e.keyBytes),e.seed=e.plugin.formatSeed(l),e.generated=0}function f(c){var u=null,h=fe.util.globalScope,l=h.crypto||h.msCrypto;l&&l.getRandomValues&&(u=function(w){return l.getRandomValues(w)});var x=fe.util.createBuffer();if(u)for(;x.length()<c;){var p=Math.max(1,Math.min(c-x.length(),65536)/4),d=new Uint32Array(Math.floor(p));try{u(d);for(var y=0;y<d.length;++y)x.putInt32(d[y])}catch(w){if(!(typeof QuotaExceededError<"u"&&w instanceof QuotaExceededError))throw w}}if(x.length()<c)for(var m,E,b,R=Math.floor(Math.random()*65536);x.length()<c;){E=16807*(R&65535),m=16807*(R>>16),E+=(m&32767)<<16,E+=m>>15,E=(E&2147483647)+(E>>31),R=E&4294967295;for(var y=0;y<3;++y)b=R>>>(y<<3),b^=Math.floor(Math.random()*256),x.putByte(b&255)}return x.getBytes(c)}return mn?(e.seedFile=function(c,u){mn.randomBytes(c,function(h,l){if(h)return u(h);u(null,l.toString())})},e.seedFileSync=function(c){return mn.randomBytes(c).toString()}):(e.seedFile=function(c,u){try{u(null,f(c))}catch(h){u(h)}},e.seedFileSync=f),e.collect=function(c){for(var u=c.length,h=0;h<u;++h)e.pools[e.pool].update(c.substr(h,1)),e.pool=e.pool===31?0:e.pool+1},e.collectInt=function(c,u){for(var h="",l=0;l<u;l+=8)h+=String.fromCharCode(c>>l&255);e.collect(h)},e.registerWorker=function(c){if(c===self)e.seedFile=function(h,l){function x(p){var d=p.data;d.forge&&d.forge.prng&&(self.removeEventListener("message",x),l(d.forge.prng.err,d.forge.prng.bytes))}self.addEventListener("message",x),self.postMessage({forge:{prng:{needed:h}}})};else{var u=function(h){var l=h.data;l.forge&&l.forge.prng&&e.seedFile(l.forge.prng.needed,function(x,p){c.postMessage({forge:{prng:{err:x,bytes:p}}})})};c.addEventListener("message",u)}},e}});var Mr=Q((iy,Oi)=>{var Dt=st();an();as();ss();Bt();(function(){if(Dt.random&&Dt.random.getBytes){Oi.exports=Dt.random;return}(function(t){var e={},r=new Array(4),n=Dt.util.createBuffer();e.formatKey=function(h){var l=Dt.util.createBuffer(h);return h=new Array(4),h[0]=l.getInt32(),h[1]=l.getInt32(),h[2]=l.getInt32(),h[3]=l.getInt32(),Dt.aes._expandKey(h,!1)},e.formatSeed=function(h){var l=Dt.util.createBuffer(h);return h=new Array(4),h[0]=l.getInt32(),h[1]=l.getInt32(),h[2]=l.getInt32(),h[3]=l.getInt32(),h},e.cipher=function(h,l){return Dt.aes._updateBlock(h,l,r,!1),n.putInt32(r[0]),n.putInt32(r[1]),n.putInt32(r[2]),n.putInt32(r[3]),n.getBytes()},e.increment=function(h){return++h[3],h},e.md=Dt.md.sha256;function i(){var h=Dt.prng.create(e);return h.getBytes=function(l,x){return h.generate(l,x)},h.getBytesSync=function(l){return h.generate(l)},h}var a=i(),s=null,o=Dt.util.globalScope,f=o.crypto||o.msCrypto;if(f&&f.getRandomValues&&(s=function(h){return f.getRandomValues(h)}),Dt.options.usePureJavaScript||!Dt.util.isNodejs&&!s){if(typeof window>"u"||window.document,a.collectInt(+new Date,32),typeof navigator<"u"){var c="";for(var u in navigator)try{typeof navigator[u]=="string"&&(c+=navigator[u])}catch{}a.collect(c),c=null}t&&(t().mousemove(function(h){a.collectInt(h.clientX,16),a.collectInt(h.clientY,16)}),t().keypress(function(h){a.collectInt(h.charCode,8)}))}if(!Dt.random)Dt.random=a;else for(var u in a)Dt.random[u]=a[u];Dt.random.createInstance=i,Oi.exports=Dt.random})(typeof jQuery<"u"?jQuery:null)})()});var hs=Q((ay,us)=>{var qt=st();Bt();var Mi=[217,120,249,196,25,221,181,237,40,233,253,121,74,160,216,157,198,126,55,131,43,118,83,142,98,76,100,136,68,139,251,162,23,154,89,245,135,179,79,19,97,69,109,141,9,129,125,50,189,143,64,235,134,183,123,11,240,149,33,34,92,107,78,130,84,214,101,147,206,96,178,28,115,86,192,20,167,140,241,220,18,117,202,31,59,190,228,209,66,61,212,48,163,60,182,38,111,191,14,218,70,105,7,87,39,242,29,155,188,148,67,3,248,17,199,246,144,239,62,231,6,195,213,47,200,102,30,215,8,232,234,222,128,82,238,247,132,170,114,172,53,77,106,42,150,26,210,113,90,21,73,116,75,159,208,94,4,24,164,236,194,224,65,110,15,81,203,204,36,145,175,80,161,244,112,57,153,124,58,133,35,184,180,122,252,2,54,91,37,85,151,49,45,93,250,152,227,138,146,174,5,223,41,16,103,108,186,201,211,0,230,207,225,158,168,44,99,22,1,63,88,226,137,169,13,56,52,27,171,51,255,176,187,72,12,95,185,177,205,46,197,243,219,71,229,165,156,119,10,166,32,104,254,127,193,173],fs=[1,2,3,5],Pu=function(t,e){return t<<e&65535|(t&65535)>>16-e},Uu=function(t,e){return(t&65535)>>e|t<<16-e&65535};us.exports=qt.rc2=qt.rc2||{};qt.rc2.expandKey=function(t,e){typeof t=="string"&&(t=qt.util.createBuffer(t)),e=e||128;var r=t,n=t.length(),i=e,a=Math.ceil(i/8),s=255>>(i&7),o;for(o=n;o<128;o++)r.putByte(Mi[r.at(o-1)+r.at(o-n)&255]);for(r.setAt(128-a,Mi[r.at(128-a)&s]),o=127-a;o>=0;o--)r.setAt(o,Mi[r.at(o+1)^r.at(o+a)]);return r};var cs=function(t,e,r){var n=!1,i=null,a=null,s=null,o,f,c,u,h=[];for(t=qt.rc2.expandKey(t,e),c=0;c<64;c++)h.push(t.getInt16Le());r?(o=function(p){for(c=0;c<4;c++)p[c]+=h[u]+(p[(c+3)%4]&p[(c+2)%4])+(~p[(c+3)%4]&p[(c+1)%4]),p[c]=Pu(p[c],fs[c]),u++},f=function(p){for(c=0;c<4;c++)p[c]+=h[p[(c+3)%4]&63]}):(o=function(p){for(c=3;c>=0;c--)p[c]=Uu(p[c],fs[c]),p[c]-=h[u]+(p[(c+3)%4]&p[(c+2)%4])+(~p[(c+3)%4]&p[(c+1)%4]),u--},f=function(p){for(c=3;c>=0;c--)p[c]-=h[p[(c+3)%4]&63]});var l=function(p){var d=[];for(c=0;c<4;c++){var y=i.getInt16Le();s!==null&&(r?y^=s.getInt16Le():s.putInt16Le(y)),d.push(y&65535)}u=r?0:63;for(var m=0;m<p.length;m++)for(var E=0;E<p[m][0];E++)p[m][1](d);for(c=0;c<4;c++)s!==null&&(r?s.putInt16Le(d[c]):d[c]^=s.getInt16Le()),a.putInt16Le(d[c])},x=null;return x={start:function(p,d){p&&typeof p=="string"&&(p=qt.util.createBuffer(p)),n=!1,i=qt.util.createBuffer(),a=d||new qt.util.createBuffer,s=p,x.output=a},update:function(p){for(n||i.putBuffer(p);i.length()>=8;)l([[5,o],[1,f],[6,o],[1,f],[5,o]])},finish:function(p){var d=!0;if(r)if(p)d=p(8,i,!r);else{var y=i.length()===8?8:8-i.length();i.fillWithByte(y,y)}if(d&&(n=!0,x.update()),!r&&(d=i.length()===0,d))if(p)d=p(8,a,!r);else{var m=a.length(),E=a.at(m-1);E>m?d=!1:a.truncate(E)}return d}},x};qt.rc2.startEncrypting=function(t,e,r){var n=qt.rc2.createEncryptionCipher(t,128);return n.start(e,r),n};qt.rc2.createEncryptionCipher=function(t,e){return cs(t,e,!0)};qt.rc2.startDecrypting=function(t,e,r){var n=qt.rc2.createDecryptionCipher(t,128);return n.start(e,r),n};qt.rc2.createDecryptionCipher=function(t,e){return cs(t,e,!1)}});var En=Q((oy,vs)=>{var qi=st();vs.exports=qi.jsbn=qi.jsbn||{};var be,Ku=0xdeadbeefcafe,ls=(Ku&16777215)==15715070;function C(t,e,r){this.data=[],t!=null&&(typeof t=="number"?this.fromNumber(t,e,r):e==null&&typeof t!="string"?this.fromString(t,256):this.fromString(t,e))}qi.jsbn.BigInteger=C;function rt(){return new C(null)}function Ou(t,e,r,n,i,a){for(;--a>=0;){var s=e*this.data[t++]+r.data[n]+i;i=Math.floor(s/67108864),r.data[n++]=s&67108863}return i}function Mu(t,e,r,n,i,a){for(var s=e&32767,o=e>>15;--a>=0;){var f=this.data[t]&32767,c=this.data[t++]>>15,u=o*f+c*s;f=s*f+((u&32767)<<15)+r.data[n]+(i&1073741823),i=(f>>>30)+(u>>>15)+o*c+(i>>>30),r.data[n++]=f&1073741823}return i}function ps(t,e,r,n,i,a){for(var s=e&16383,o=e>>14;--a>=0;){var f=this.data[t]&16383,c=this.data[t++]>>14,u=o*f+c*s;f=s*f+((u&16383)<<14)+r.data[n]+i,i=(f>>28)+(u>>14)+o*c,r.data[n++]=f&268435455}return i}typeof navigator>"u"?(C.prototype.am=ps,be=28):ls&&navigator.appName=="Microsoft Internet Explorer"?(C.prototype.am=Mu,be=30):ls&&navigator.appName!="Netscape"?(C.prototype.am=Ou,be=26):(C.prototype.am=ps,be=28);C.prototype.DB=be;C.prototype.DM=(1<<be)-1;C.prototype.DV=1<<be;var Vi=52;C.prototype.FV=Math.pow(2,Vi);C.prototype.F1=Vi-be;C.prototype.F2=2*be-Vi;var qu="0123456789abcdefghijklmnopqrstuvwxyz",vn=new Array,pr,Gt;pr="0".charCodeAt(0);for(Gt=0;Gt<=9;++Gt)vn[pr++]=Gt;pr="a".charCodeAt(0);for(Gt=10;Gt<36;++Gt)vn[pr++]=Gt;pr="A".charCodeAt(0);for(Gt=10;Gt<36;++Gt)vn[pr++]=Gt;function ds(t){return qu.charAt(t)}function ys(t,e){var r=vn[t.charCodeAt(e)];return r??-1}function Vu(t){for(var e=this.t-1;e>=0;--e)t.data[e]=this.data[e];t.t=this.t,t.s=this.s}function Fu(t){this.t=1,this.s=t<0?-1:0,t>0?this.data[0]=t:t<-1?this.data[0]=t+this.DV:this.t=0}function De(t){var e=rt();return e.fromInt(t),e}function Hu(t,e){var r;if(e==16)r=4;else if(e==8)r=3;else if(e==256)r=8;else if(e==2)r=1;else if(e==32)r=5;else if(e==4)r=2;else{this.fromRadix(t,e);return}this.t=0,this.s=0;for(var n=t.length,i=!1,a=0;--n>=0;){var s=r==8?t[n]&255:ys(t,n);if(s<0){t.charAt(n)=="-"&&(i=!0);continue}i=!1,a==0?this.data[this.t++]=s:a+r>this.DB?(this.data[this.t-1]|=(s&(1<<this.DB-a)-1)<<a,this.data[this.t++]=s>>this.DB-a):this.data[this.t-1]|=s<<a,a+=r,a>=this.DB&&(a-=this.DB)}r==8&&t[0]&128&&(this.s=-1,a>0&&(this.data[this.t-1]|=(1<<this.DB-a)-1<<a)),this.clamp(),i&&C.ZERO.subTo(this,this)}function zu(){for(var t=this.s&this.DM;this.t>0&&this.data[this.t-1]==t;)--this.t}function Gu(t){if(this.s<0)return"-"+this.negate().toString(t);var e;if(t==16)e=4;else if(t==8)e=3;else if(t==2)e=1;else if(t==32)e=5;else if(t==4)e=2;else return this.toRadix(t);var r=(1<<e)-1,n,i=!1,a="",s=this.t,o=this.DB-s*this.DB%e;if(s-- >0)for(o<this.DB&&(n=this.data[s]>>o)>0&&(i=!0,a=ds(n));s>=0;)o<e?(n=(this.data[s]&(1<<o)-1)<<e-o,n|=this.data[--s]>>(o+=this.DB-e)):(n=this.data[s]>>(o-=e)&r,o<=0&&(o+=this.DB,--s)),n>0&&(i=!0),i&&(a+=ds(n));return i?a:"0"}function Wu(){var t=rt();return C.ZERO.subTo(this,t),t}function Yu(){return this.s<0?this.negate():this}function Zu(t){var e=this.s-t.s;if(e!=0)return e;var r=this.t;if(e=r-t.t,e!=0)return this.s<0?-e:e;for(;--r>=0;)if((e=this.data[r]-t.data[r])!=0)return e;return 0}function bn(t){var e=1,r;return(r=t>>>16)!=0&&(t=r,e+=16),(r=t>>8)!=0&&(t=r,e+=8),(r=t>>4)!=0&&(t=r,e+=4),(r=t>>2)!=0&&(t=r,e+=2),(r=t>>1)!=0&&(t=r,e+=1),e}function $u(){return this.t<=0?0:this.DB*(this.t-1)+bn(this.data[this.t-1]^this.s&this.DM)}function Qu(t,e){var r;for(r=this.t-1;r>=0;--r)e.data[r+t]=this.data[r];for(r=t-1;r>=0;--r)e.data[r]=0;e.t=this.t+t,e.s=this.s}function Xu(t,e){for(var r=t;r<this.t;++r)e.data[r-t]=this.data[r];e.t=Math.max(this.t-t,0),e.s=this.s}function Ju(t,e){var r=t%this.DB,n=this.DB-r,i=(1<<n)-1,a=Math.floor(t/this.DB),s=this.s<<r&this.DM,o;for(o=this.t-1;o>=0;--o)e.data[o+a+1]=this.data[o]>>n|s,s=(this.data[o]&i)<<r;for(o=a-1;o>=0;--o)e.data[o]=0;e.data[a]=s,e.t=this.t+a+1,e.s=this.s,e.clamp()}function ju(t,e){e.s=this.s;var r=Math.floor(t/this.DB);if(r>=this.t){e.t=0;return}var n=t%this.DB,i=this.DB-n,a=(1<<n)-1;e.data[0]=this.data[r]>>n;for(var s=r+1;s<this.t;++s)e.data[s-r-1]|=(this.data[s]&a)<<i,e.data[s-r]=this.data[s]>>n;n>0&&(e.data[this.t-r-1]|=(this.s&a)<<i),e.t=this.t-r,e.clamp()}function th(t,e){for(var r=0,n=0,i=Math.min(t.t,this.t);r<i;)n+=this.data[r]-t.data[r],e.data[r++]=n&this.DM,n>>=this.DB;if(t.t<this.t){for(n-=t.s;r<this.t;)n+=this.data[r],e.data[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<t.t;)n-=t.data[r],e.data[r++]=n&this.DM,n>>=this.DB;n-=t.s}e.s=n<0?-1:0,n<-1?e.data[r++]=this.DV+n:n>0&&(e.data[r++]=n),e.t=r,e.clamp()}function eh(t,e){var r=this.abs(),n=t.abs(),i=r.t;for(e.t=i+n.t;--i>=0;)e.data[i]=0;for(i=0;i<n.t;++i)e.data[i+r.t]=r.am(0,n.data[i],e,i,0,r.t);e.s=0,e.clamp(),this.s!=t.s&&C.ZERO.subTo(e,e)}function rh(t){for(var e=this.abs(),r=t.t=2*e.t;--r>=0;)t.data[r]=0;for(r=0;r<e.t-1;++r){var n=e.am(r,e.data[r],t,2*r,0,1);(t.data[r+e.t]+=e.am(r+1,2*e.data[r],t,2*r+1,n,e.t-r-1))>=e.DV&&(t.data[r+e.t]-=e.DV,t.data[r+e.t+1]=1)}t.t>0&&(t.data[t.t-1]+=e.am(r,e.data[r],t,2*r,0,1)),t.s=0,t.clamp()}function nh(t,e,r){var n=t.abs();if(!(n.t<=0)){var i=this.abs();if(i.t<n.t){e?.fromInt(0),r!=null&&this.copyTo(r);return}r==null&&(r=rt());var a=rt(),s=this.s,o=t.s,f=this.DB-bn(n.data[n.t-1]);f>0?(n.lShiftTo(f,a),i.lShiftTo(f,r)):(n.copyTo(a),i.copyTo(r));var c=a.t,u=a.data[c-1];if(u!=0){var h=u*(1<<this.F1)+(c>1?a.data[c-2]>>this.F2:0),l=this.FV/h,x=(1<<this.F1)/h,p=1<<this.F2,d=r.t,y=d-c,m=e??rt();for(a.dlShiftTo(y,m),r.compareTo(m)>=0&&(r.data[r.t++]=1,r.subTo(m,r)),C.ONE.dlShiftTo(c,m),m.subTo(a,a);a.t<c;)a.data[a.t++]=0;for(;--y>=0;){var E=r.data[--d]==u?this.DM:Math.floor(r.data[d]*l+(r.data[d-1]+p)*x);if((r.data[d]+=a.am(0,E,r,y,0,c))<E)for(a.dlShiftTo(y,m),r.subTo(m,r);r.data[d]<--E;)r.subTo(m,r)}e!=null&&(r.drShiftTo(c,e),s!=o&&C.ZERO.subTo(e,e)),r.t=c,r.clamp(),f>0&&r.rShiftTo(f,r),s<0&&C.ZERO.subTo(r,r)}}}function ih(t){var e=rt();return this.abs().divRemTo(t,null,e),this.s<0&&e.compareTo(C.ZERO)>0&&t.subTo(e,e),e}function We(t){this.m=t}function ah(t){return t.s<0||t.compareTo(this.m)>=0?t.mod(this.m):t}function oh(t){return t}function sh(t){t.divRemTo(this.m,null,t)}function fh(t,e,r){t.multiplyTo(e,r),this.reduce(r)}function ch(t,e){t.squareTo(e),this.reduce(e)}We.prototype.convert=ah;We.prototype.revert=oh;We.prototype.reduce=sh;We.prototype.mulTo=fh;We.prototype.sqrTo=ch;function uh(){if(this.t<1)return 0;var t=this.data[0];if(!(t&1))return 0;var e=t&3;return e=e*(2-(t&15)*e)&15,e=e*(2-(t&255)*e)&255,e=e*(2-((t&65535)*e&65535))&65535,e=e*(2-t*e%this.DV)%this.DV,e>0?this.DV-e:-e}function Ye(t){this.m=t,this.mp=t.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<t.DB-15)-1,this.mt2=2*t.t}function hh(t){var e=rt();return t.abs().dlShiftTo(this.m.t,e),e.divRemTo(this.m,null,e),t.s<0&&e.compareTo(C.ZERO)>0&&this.m.subTo(e,e),e}function lh(t){var e=rt();return t.copyTo(e),this.reduce(e),e}function ph(t){for(;t.t<=this.mt2;)t.data[t.t++]=0;for(var e=0;e<this.m.t;++e){var r=t.data[e]&32767,n=r*this.mpl+((r*this.mph+(t.data[e]>>15)*this.mpl&this.um)<<15)&t.DM;for(r=e+this.m.t,t.data[r]+=this.m.am(0,n,t,e,0,this.m.t);t.data[r]>=t.DV;)t.data[r]-=t.DV,t.data[++r]++}t.clamp(),t.drShiftTo(this.m.t,t),t.compareTo(this.m)>=0&&t.subTo(this.m,t)}function dh(t,e){t.squareTo(e),this.reduce(e)}function yh(t,e,r){t.multiplyTo(e,r),this.reduce(r)}Ye.prototype.convert=hh;Ye.prototype.revert=lh;Ye.prototype.reduce=ph;Ye.prototype.mulTo=yh;Ye.prototype.sqrTo=dh;function xh(){return(this.t>0?this.data[0]&1:this.s)==0}function gh(t,e){if(t>4294967295||t<1)return C.ONE;var r=rt(),n=rt(),i=e.convert(this),a=bn(t)-1;for(i.copyTo(r);--a>=0;)if(e.sqrTo(r,n),(t&1<<a)>0)e.mulTo(n,i,r);else{var s=r;r=n,n=s}return e.revert(r)}function mh(t,e){var r;return t<256||e.isEven()?r=new We(e):r=new Ye(e),this.exp(t,r)}C.prototype.copyTo=Vu;C.prototype.fromInt=Fu;C.prototype.fromString=Hu;C.prototype.clamp=zu;C.prototype.dlShiftTo=Qu;C.prototype.drShiftTo=Xu;C.prototype.lShiftTo=Ju;C.prototype.rShiftTo=ju;C.prototype.subTo=th;C.prototype.multiplyTo=eh;C.prototype.squareTo=rh;C.prototype.divRemTo=nh;C.prototype.invDigit=uh;C.prototype.isEven=xh;C.prototype.exp=gh;C.prototype.toString=Gu;C.prototype.negate=Wu;C.prototype.abs=Yu;C.prototype.compareTo=Zu;C.prototype.bitLength=$u;C.prototype.mod=ih;C.prototype.modPowInt=mh;C.ZERO=De(0);C.ONE=De(1);function vh(){var t=rt();return this.copyTo(t),t}function bh(){if(this.s<0){if(this.t==1)return this.data[0]-this.DV;if(this.t==0)return-1}else{if(this.t==1)return this.data[0];if(this.t==0)return 0}return(this.data[1]&(1<<32-this.DB)-1)<<this.DB|this.data[0]}function Eh(){return this.t==0?this.s:this.data[0]<<24>>24}function wh(){return this.t==0?this.s:this.data[0]<<16>>16}function Bh(t){return Math.floor(Math.LN2*this.DB/Math.log(t))}function Sh(){return this.s<0?-1:this.t<=0||this.t==1&&this.data[0]<=0?0:1}function Ah(t){if(t==null&&(t=10),this.signum()==0||t<2||t>36)return"0";var e=this.chunkSize(t),r=Math.pow(t,e),n=De(r),i=rt(),a=rt(),s="";for(this.divRemTo(n,i,a);i.signum()>0;)s=(r+a.intValue()).toString(t).substr(1)+s,i.divRemTo(n,i,a);return a.intValue().toString(t)+s}function Ch(t,e){this.fromInt(0),e==null&&(e=10);for(var r=this.chunkSize(e),n=Math.pow(e,r),i=!1,a=0,s=0,o=0;o<t.length;++o){var f=ys(t,o);if(f<0){t.charAt(o)=="-"&&this.signum()==0&&(i=!0);continue}s=e*s+f,++a>=r&&(this.dMultiply(n),this.dAddOffset(s,0),a=0,s=0)}a>0&&(this.dMultiply(Math.pow(e,a)),this.dAddOffset(s,0)),i&&C.ZERO.subTo(this,this)}function Th(t,e,r){if(typeof e=="number")if(t<2)this.fromInt(1);else for(this.fromNumber(t,r),this.testBit(t-1)||this.bitwiseTo(C.ONE.shiftLeft(t-1),Fi,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(e);)this.dAddOffset(2,0),this.bitLength()>t&&this.subTo(C.ONE.shiftLeft(t-1),this);else{var n=new Array,i=t&7;n.length=(t>>3)+1,e.nextBytes(n),i>0?n[0]&=(1<<i)-1:n[0]=0,this.fromString(n,256)}}function Ih(){var t=this.t,e=new Array;e[0]=this.s;var r=this.DB-t*this.DB%8,n,i=0;if(t-- >0)for(r<this.DB&&(n=this.data[t]>>r)!=(this.s&this.DM)>>r&&(e[i++]=n|this.s<<this.DB-r);t>=0;)r<8?(n=(this.data[t]&(1<<r)-1)<<8-r,n|=this.data[--t]>>(r+=this.DB-8)):(n=this.data[t]>>(r-=8)&255,r<=0&&(r+=this.DB,--t)),n&128&&(n|=-256),i==0&&(this.s&128)!=(n&128)&&++i,(i>0||n!=this.s)&&(e[i++]=n);return e}function _h(t){return this.compareTo(t)==0}function Rh(t){return this.compareTo(t)<0?this:t}function Lh(t){return this.compareTo(t)>0?this:t}function Dh(t,e,r){var n,i,a=Math.min(t.t,this.t);for(n=0;n<a;++n)r.data[n]=e(this.data[n],t.data[n]);if(t.t<this.t){for(i=t.s&this.DM,n=a;n<this.t;++n)r.data[n]=e(this.data[n],i);r.t=this.t}else{for(i=this.s&this.DM,n=a;n<t.t;++n)r.data[n]=e(i,t.data[n]);r.t=t.t}r.s=e(this.s,t.s),r.clamp()}function Nh(t,e){return t&e}function kh(t){var e=rt();return this.bitwiseTo(t,Nh,e),e}function Fi(t,e){return t|e}function Ph(t){var e=rt();return this.bitwiseTo(t,Fi,e),e}function xs(t,e){return t^e}function Uh(t){var e=rt();return this.bitwiseTo(t,xs,e),e}function gs(t,e){return t&~e}function Kh(t){var e=rt();return this.bitwiseTo(t,gs,e),e}function Oh(){for(var t=rt(),e=0;e<this.t;++e)t.data[e]=this.DM&~this.data[e];return t.t=this.t,t.s=~this.s,t}function Mh(t){var e=rt();return t<0?this.rShiftTo(-t,e):this.lShiftTo(t,e),e}function qh(t){var e=rt();return t<0?this.lShiftTo(-t,e):this.rShiftTo(t,e),e}function Vh(t){if(t==0)return-1;var e=0;return t&65535||(t>>=16,e+=16),t&255||(t>>=8,e+=8),t&15||(t>>=4,e+=4),t&3||(t>>=2,e+=2),t&1||++e,e}function Fh(){for(var t=0;t<this.t;++t)if(this.data[t]!=0)return t*this.DB+Vh(this.data[t]);return this.s<0?this.t*this.DB:-1}function Hh(t){for(var e=0;t!=0;)t&=t-1,++e;return e}function zh(){for(var t=0,e=this.s&this.DM,r=0;r<this.t;++r)t+=Hh(this.data[r]^e);return t}function Gh(t){var e=Math.floor(t/this.DB);return e>=this.t?this.s!=0:(this.data[e]&1<<t%this.DB)!=0}function Wh(t,e){var r=C.ONE.shiftLeft(t);return this.bitwiseTo(r,e,r),r}function Yh(t){return this.changeBit(t,Fi)}function Zh(t){return this.changeBit(t,gs)}function $h(t){return this.changeBit(t,xs)}function Qh(t,e){for(var r=0,n=0,i=Math.min(t.t,this.t);r<i;)n+=this.data[r]+t.data[r],e.data[r++]=n&this.DM,n>>=this.DB;if(t.t<this.t){for(n+=t.s;r<this.t;)n+=this.data[r],e.data[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<t.t;)n+=t.data[r],e.data[r++]=n&this.DM,n>>=this.DB;n+=t.s}e.s=n<0?-1:0,n>0?e.data[r++]=n:n<-1&&(e.data[r++]=this.DV+n),e.t=r,e.clamp()}function Xh(t){var e=rt();return this.addTo(t,e),e}function Jh(t){var e=rt();return this.subTo(t,e),e}function jh(t){var e=rt();return this.multiplyTo(t,e),e}function tl(t){var e=rt();return this.divRemTo(t,e,null),e}function el(t){var e=rt();return this.divRemTo(t,null,e),e}function rl(t){var e=rt(),r=rt();return this.divRemTo(t,e,r),new Array(e,r)}function nl(t){this.data[this.t]=this.am(0,t-1,this,0,0,this.t),++this.t,this.clamp()}function il(t,e){if(t!=0){for(;this.t<=e;)this.data[this.t++]=0;for(this.data[e]+=t;this.data[e]>=this.DV;)this.data[e]-=this.DV,++e>=this.t&&(this.data[this.t++]=0),++this.data[e]}}function qr(){}function ms(t){return t}function al(t,e,r){t.multiplyTo(e,r)}function ol(t,e){t.squareTo(e)}qr.prototype.convert=ms;qr.prototype.revert=ms;qr.prototype.mulTo=al;qr.prototype.sqrTo=ol;function sl(t){return this.exp(t,new qr)}function fl(t,e,r){var n=Math.min(this.t+t.t,e);for(r.s=0,r.t=n;n>0;)r.data[--n]=0;var i;for(i=r.t-this.t;n<i;++n)r.data[n+this.t]=this.am(0,t.data[n],r,n,0,this.t);for(i=Math.min(t.t,e);n<i;++n)this.am(0,t.data[n],r,n,0,e-n);r.clamp()}function cl(t,e,r){--e;var n=r.t=this.t+t.t-e;for(r.s=0;--n>=0;)r.data[n]=0;for(n=Math.max(e-this.t,0);n<t.t;++n)r.data[this.t+n-e]=this.am(e-n,t.data[n],r,0,0,this.t+n-e);r.clamp(),r.drShiftTo(1,r)}function dr(t){this.r2=rt(),this.q3=rt(),C.ONE.dlShiftTo(2*t.t,this.r2),this.mu=this.r2.divide(t),this.m=t}function ul(t){if(t.s<0||t.t>2*this.m.t)return t.mod(this.m);if(t.compareTo(this.m)<0)return t;var e=rt();return t.copyTo(e),this.reduce(e),e}function hl(t){return t}function ll(t){for(t.drShiftTo(this.m.t-1,this.r2),t.t>this.m.t+1&&(t.t=this.m.t+1,t.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);t.compareTo(this.r2)<0;)t.dAddOffset(1,this.m.t+1);for(t.subTo(this.r2,t);t.compareTo(this.m)>=0;)t.subTo(this.m,t)}function pl(t,e){t.squareTo(e),this.reduce(e)}function dl(t,e,r){t.multiplyTo(e,r),this.reduce(r)}dr.prototype.convert=ul;dr.prototype.revert=hl;dr.prototype.reduce=ll;dr.prototype.mulTo=dl;dr.prototype.sqrTo=pl;function yl(t,e){var r=t.bitLength(),n,i=De(1),a;if(r<=0)return i;r<18?n=1:r<48?n=3:r<144?n=4:r<768?n=5:n=6,r<8?a=new We(e):e.isEven()?a=new dr(e):a=new Ye(e);var s=new Array,o=3,f=n-1,c=(1<<n)-1;if(s[1]=a.convert(this),n>1){var u=rt();for(a.sqrTo(s[1],u);o<=c;)s[o]=rt(),a.mulTo(u,s[o-2],s[o]),o+=2}var h=t.t-1,l,x=!0,p=rt(),d;for(r=bn(t.data[h])-1;h>=0;){for(r>=f?l=t.data[h]>>r-f&c:(l=(t.data[h]&(1<<r+1)-1)<<f-r,h>0&&(l|=t.data[h-1]>>this.DB+r-f)),o=n;!(l&1);)l>>=1,--o;if((r-=o)<0&&(r+=this.DB,--h),x)s[l].copyTo(i),x=!1;else{for(;o>1;)a.sqrTo(i,p),a.sqrTo(p,i),o-=2;o>0?a.sqrTo(i,p):(d=i,i=p,p=d),a.mulTo(p,s[l],i)}for(;h>=0&&!(t.data[h]&1<<r);)a.sqrTo(i,p),d=i,i=p,p=d,--r<0&&(r=this.DB-1,--h)}return a.revert(i)}function xl(t){var e=this.s<0?this.negate():this.clone(),r=t.s<0?t.negate():t.clone();if(e.compareTo(r)<0){var n=e;e=r,r=n}var i=e.getLowestSetBit(),a=r.getLowestSetBit();if(a<0)return e;for(i<a&&(a=i),a>0&&(e.rShiftTo(a,e),r.rShiftTo(a,r));e.signum()>0;)(i=e.getLowestSetBit())>0&&e.rShiftTo(i,e),(i=r.getLowestSetBit())>0&&r.rShiftTo(i,r),e.compareTo(r)>=0?(e.subTo(r,e),e.rShiftTo(1,e)):(r.subTo(e,r),r.rShiftTo(1,r));return a>0&&r.lShiftTo(a,r),r}function gl(t){if(t<=0)return 0;var e=this.DV%t,r=this.s<0?t-1:0;if(this.t>0)if(e==0)r=this.data[0]%t;else for(var n=this.t-1;n>=0;--n)r=(e*r+this.data[n])%t;return r}function ml(t){var e=t.isEven();if(this.isEven()&&e||t.signum()==0)return C.ZERO;for(var r=t.clone(),n=this.clone(),i=De(1),a=De(0),s=De(0),o=De(1);r.signum()!=0;){for(;r.isEven();)r.rShiftTo(1,r),e?((!i.isEven()||!a.isEven())&&(i.addTo(this,i),a.subTo(t,a)),i.rShiftTo(1,i)):a.isEven()||a.subTo(t,a),a.rShiftTo(1,a);for(;n.isEven();)n.rShiftTo(1,n),e?((!s.isEven()||!o.isEven())&&(s.addTo(this,s),o.subTo(t,o)),s.rShiftTo(1,s)):o.isEven()||o.subTo(t,o),o.rShiftTo(1,o);r.compareTo(n)>=0?(r.subTo(n,r),e&&i.subTo(s,i),a.subTo(o,a)):(n.subTo(r,n),e&&s.subTo(i,s),o.subTo(a,o))}if(n.compareTo(C.ONE)!=0)return C.ZERO;if(o.compareTo(t)>=0)return o.subtract(t);if(o.signum()<0)o.addTo(t,o);else return o;return o.signum()<0?o.add(t):o}var Qt=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509],vl=(1<<26)/Qt[Qt.length-1];function bl(t){var e,r=this.abs();if(r.t==1&&r.data[0]<=Qt[Qt.length-1]){for(e=0;e<Qt.length;++e)if(r.data[0]==Qt[e])return!0;return!1}if(r.isEven())return!1;for(e=1;e<Qt.length;){for(var n=Qt[e],i=e+1;i<Qt.length&&n<vl;)n*=Qt[i++];for(n=r.modInt(n);e<i;)if(n%Qt[e++]==0)return!1}return r.millerRabin(t)}function El(t){var e=this.subtract(C.ONE),r=e.getLowestSetBit();if(r<=0)return!1;for(var n=e.shiftRight(r),i=wl(),a,s=0;s<t;++s){do a=new C(this.bitLength(),i);while(a.compareTo(C.ONE)<=0||a.compareTo(e)>=0);var o=a.modPow(n,this);if(o.compareTo(C.ONE)!=0&&o.compareTo(e)!=0){for(var f=1;f++<r&&o.compareTo(e)!=0;)if(o=o.modPowInt(2,this),o.compareTo(C.ONE)==0)return!1;if(o.compareTo(e)!=0)return!1}}return!0}function wl(){return{nextBytes:function(t){for(var e=0;e<t.length;++e)t[e]=Math.floor(Math.random()*256)}}}C.prototype.chunkSize=Bh;C.prototype.toRadix=Ah;C.prototype.fromRadix=Ch;C.prototype.fromNumber=Th;C.prototype.bitwiseTo=Dh;C.prototype.changeBit=Wh;C.prototype.addTo=Qh;C.prototype.dMultiply=nl;C.prototype.dAddOffset=il;C.prototype.multiplyLowerTo=fl;C.prototype.multiplyUpperTo=cl;C.prototype.modInt=gl;C.prototype.millerRabin=El;C.prototype.clone=vh;C.prototype.intValue=bh;C.prototype.byteValue=Eh;C.prototype.shortValue=wh;C.prototype.signum=Sh;C.prototype.toByteArray=Ih;C.prototype.equals=_h;C.prototype.min=Rh;C.prototype.max=Lh;C.prototype.and=kh;C.prototype.or=Ph;C.prototype.xor=Uh;C.prototype.andNot=Kh;C.prototype.not=Oh;C.prototype.shiftLeft=Mh;C.prototype.shiftRight=qh;C.prototype.getLowestSetBit=Fh;C.prototype.bitCount=zh;C.prototype.testBit=Gh;C.prototype.setBit=Yh;C.prototype.clearBit=Zh;C.prototype.flipBit=$h;C.prototype.add=Xh;C.prototype.subtract=Jh;C.prototype.multiply=jh;C.prototype.divide=tl;C.prototype.remainder=el;C.prototype.divideAndRemainder=rl;C.prototype.modPow=yl;C.prototype.modInverse=ml;C.prototype.pow=sl;C.prototype.gcd=xl;C.prototype.isProbablePrime=bl});var Ss=Q((sy,Bs)=>{var ce=st();Ge();Bt();var Es=Bs.exports=ce.sha1=ce.sha1||{};ce.md.sha1=ce.md.algorithms.sha1=Es;Es.create=function(){ws||Bl();var t=null,e=ce.util.createBuffer(),r=new Array(80),n={algorithm:"sha1",blockLength:64,digestLength:20,messageLength:0,fullMessageLength:null,messageLengthSize:8};return n.start=function(){n.messageLength=0,n.fullMessageLength=n.messageLength64=[];for(var i=n.messageLengthSize/4,a=0;a<i;++a)n.fullMessageLength.push(0);return e=ce.util.createBuffer(),t={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878,h4:3285377520},n},n.start(),n.update=function(i,a){a==="utf8"&&(i=ce.util.encodeUtf8(i));var s=i.length;n.messageLength+=s,s=[s/4294967296>>>0,s>>>0];for(var o=n.fullMessageLength.length-1;o>=0;--o)n.fullMessageLength[o]+=s[1],s[1]=s[0]+(n.fullMessageLength[o]/4294967296>>>0),n.fullMessageLength[o]=n.fullMessageLength[o]>>>0,s[0]=s[1]/4294967296>>>0;return e.putBytes(i),bs(t,r,e),(e.read>2048||e.length()===0)&&e.compact(),n},n.digest=function(){var i=ce.util.createBuffer();i.putBytes(e.bytes());var a=n.fullMessageLength[n.fullMessageLength.length-1]+n.messageLengthSize,s=a&n.blockLength-1;i.putBytes(Hi.substr(0,n.blockLength-s));for(var o,f,c=n.fullMessageLength[0]*8,u=0;u<n.fullMessageLength.length-1;++u)o=n.fullMessageLength[u+1]*8,f=o/4294967296>>>0,c+=f,i.putInt32(c>>>0),c=o>>>0;i.putInt32(c);var h={h0:t.h0,h1:t.h1,h2:t.h2,h3:t.h3,h4:t.h4};bs(h,r,i);var l=ce.util.createBuffer();return l.putInt32(h.h0),l.putInt32(h.h1),l.putInt32(h.h2),l.putInt32(h.h3),l.putInt32(h.h4),l},n};var Hi=null,ws=!1;function Bl(){Hi=String.fromCharCode(128),Hi+=ce.util.fillString(String.fromCharCode(0),64),ws=!0}function bs(t,e,r){for(var n,i,a,s,o,f,c,u,h=r.length();h>=64;){for(i=t.h0,a=t.h1,s=t.h2,o=t.h3,f=t.h4,u=0;u<16;++u)n=r.getInt32(),e[u]=n,c=o^a&(s^o),n=(i<<5|i>>>27)+c+f+1518500249+n,f=o,o=s,s=(a<<30|a>>>2)>>>0,a=i,i=n;for(;u<20;++u)n=e[u-3]^e[u-8]^e[u-14]^e[u-16],n=n<<1|n>>>31,e[u]=n,c=o^a&(s^o),n=(i<<5|i>>>27)+c+f+1518500249+n,f=o,o=s,s=(a<<30|a>>>2)>>>0,a=i,i=n;for(;u<32;++u)n=e[u-3]^e[u-8]^e[u-14]^e[u-16],n=n<<1|n>>>31,e[u]=n,c=a^s^o,n=(i<<5|i>>>27)+c+f+1859775393+n,f=o,o=s,s=(a<<30|a>>>2)>>>0,a=i,i=n;for(;u<40;++u)n=e[u-6]^e[u-16]^e[u-28]^e[u-32],n=n<<2|n>>>30,e[u]=n,c=a^s^o,n=(i<<5|i>>>27)+c+f+1859775393+n,f=o,o=s,s=(a<<30|a>>>2)>>>0,a=i,i=n;for(;u<60;++u)n=e[u-6]^e[u-16]^e[u-28]^e[u-32],n=n<<2|n>>>30,e[u]=n,c=a&s|o&(a^s),n=(i<<5|i>>>27)+c+f+2400959708+n,f=o,o=s,s=(a<<30|a>>>2)>>>0,a=i,i=n;for(;u<80;++u)n=e[u-6]^e[u-16]^e[u-28]^e[u-32],n=n<<2|n>>>30,e[u]=n,c=a^s^o,n=(i<<5|i>>>27)+c+f+3395469782+n,f=o,o=s,s=(a<<30|a>>>2)>>>0,a=i,i=n;t.h0=t.h0+i|0,t.h1=t.h1+a|0,t.h2=t.h2+s|0,t.h3=t.h3+o|0,t.h4=t.h4+f|0,h-=64}}});var Ts=Q((fy,Cs)=>{var ue=st();Bt();Mr();Ss();var As=Cs.exports=ue.pkcs1=ue.pkcs1||{};As.encode_rsa_oaep=function(t,e,r){var n,i,a,s;typeof r=="string"?(n=r,i=arguments[3]||void 0,a=arguments[4]||void 0):r&&(n=r.label||void 0,i=r.seed||void 0,a=r.md||void 0,r.mgf1&&r.mgf1.md&&(s=r.mgf1.md)),a?a.start():a=ue.md.sha1.create(),s||(s=a);var o=Math.ceil(t.n.bitLength()/8),f=o-2*a.digestLength-2;if(e.length>f){var c=new Error("RSAES-OAEP input message length is too long.");throw c.length=e.length,c.maxLength=f,c}n||(n=""),a.update(n,"raw");for(var u=a.digest(),h="",l=f-e.length,x=0;x<l;x++)h+="\0";var p=u.getBytes()+h+""+e;if(!i)i=ue.random.getBytes(a.digestLength);else if(i.length!==a.digestLength){var c=new Error("Invalid RSAES-OAEP seed. The seed length must match the digest length.");throw c.seedLength=i.length,c.digestLength=a.digestLength,c}var d=wn(i,o-a.digestLength-1,s),y=ue.util.xorBytes(p,d,p.length),m=wn(y,a.digestLength,s),E=ue.util.xorBytes(i,m,i.length);return"\0"+E+y};As.decode_rsa_oaep=function(t,e,r){var n,i,a;typeof r=="string"?(n=r,i=arguments[3]||void 0):r&&(n=r.label||void 0,i=r.md||void 0,r.mgf1&&r.mgf1.md&&(a=r.mgf1.md));var s=Math.ceil(t.n.bitLength()/8);if(e.length!==s){var y=new Error("RSAES-OAEP encoded message length is invalid.");throw y.length=e.length,y.expectedLength=s,y}if(i===void 0?i=ue.md.sha1.create():i.start(),a||(a=i),s<2*i.digestLength+2)throw new Error("RSAES-OAEP key is too short for the hash function.");n||(n=""),i.update(n,"raw");for(var o=i.digest().getBytes(),f=e.charAt(0),c=e.substring(1,i.digestLength+1),u=e.substring(1+i.digestLength),h=wn(u,i.digestLength,a),l=ue.util.xorBytes(c,h,c.length),x=wn(l,s-i.digestLength-1,a),p=ue.util.xorBytes(u,x,u.length),d=p.substring(0,i.digestLength),y=f!=="\0",m=0;m<i.digestLength;++m)y|=o.charAt(m)!==d.charAt(m);for(var E=1,b=i.digestLength,R=i.digestLength;R<p.length;R++){var w=p.charCodeAt(R),B=w&1^1,L=E?65534:0;y|=w&L,E=E&B,b+=E}if(y||p.charCodeAt(b)!==1)throw new Error("Invalid RSAES-OAEP padding.");return p.substring(b+1)};function wn(t,e,r){r||(r=ue.md.sha1.create());for(var n="",i=Math.ceil(e/r.digestLength),a=0;a<i;++a){var s=String.fromCharCode(a>>24&255,a>>16&255,a>>8&255,a&255);r.start(),r.update(t+s),n+=r.digest().getBytes()}return n.substring(0,e)}});var Is=Q((cy,zi)=>{var Ne=st();Bt();En();Mr();(function(){if(Ne.prime){zi.exports=Ne.prime;return}var t=zi.exports=Ne.prime=Ne.prime||{},e=Ne.jsbn.BigInteger,r=[6,4,2,4,2,4,6,2],n=new e(null);n.fromInt(30);var i=function(h,l){return h|l};t.generateProbablePrime=function(h,l,x){typeof l=="function"&&(x=l,l={}),l=l||{};var p=l.algorithm||"PRIMEINC";typeof p=="string"&&(p={name:p}),p.options=p.options||{};var d=l.prng||Ne.random,y={nextBytes:function(m){for(var E=d.getBytesSync(m.length),b=0;b<m.length;++b)m[b]=E.charCodeAt(b)}};if(p.name==="PRIMEINC")return a(h,y,p.options,x);throw new Error("Invalid prime generation algorithm: "+p.name)};function a(h,l,x,p){return"workers"in x?f(h,l,x,p):s(h,l,x,p)}function s(h,l,x,p){var d=c(h,l),y=0,m=u(d.bitLength());"millerRabinTests"in x&&(m=x.millerRabinTests);var E=10;"maxBlockTime"in x&&(E=x.maxBlockTime),o(d,h,l,y,m,E,p)}function o(h,l,x,p,d,y,m){var E=+new Date;do{if(h.bitLength()>l&&(h=c(l,x)),h.isProbablePrime(d))return m(null,h);h.dAddOffset(r[p++%8],0)}while(y<0||+new Date-E<y);Ne.util.setImmediate(function(){o(h,l,x,p,d,y,m)})}function f(h,l,x,p){if(typeof Worker>"u")return s(h,l,x,p);var d=c(h,l),y=x.workers,m=x.workLoad||100,E=m*30/8,b=x.workerScript||"forge/prime.worker.js";if(y===-1)return Ne.util.estimateCores(function(w,B){w&&(B=2),y=B-1,R()});R();function R(){y=Math.max(1,y);for(var w=[],B=0;B<y;++B)w[B]=new Worker(b);for(var L=y,B=0;B<y;++B)w[B].addEventListener("message",G);var D=!1;function G(z){if(!D){--L;var V=z.data;if(V.found){for(var J=0;J<w.length;++J)w[J].terminate();return D=!0,p(null,new e(V.prime,16))}d.bitLength()>h&&(d=c(h,l));var ft=d.toString(16);z.target.postMessage({hex:ft,workLoad:m}),d.dAddOffset(E,0)}}}}function c(h,l){var x=new e(h,l),p=h-1;return x.testBit(p)||x.bitwiseTo(e.ONE.shiftLeft(p),i,x),x.dAddOffset(31-x.mod(n).byteValue(),0),x}function u(h){return h<=100?27:h<=150?18:h<=200?15:h<=250?12:h<=300?9:h<=350?8:h<=400?7:h<=500?6:h<=600?5:h<=800?4:h<=1250?3:2}})()});var Sn=Q((uy,Ps)=>{var q=st();Or();En();hn();Ts();Is();Mr();Bt();typeof et>"u"&&(et=q.jsbn.BigInteger);var et,Gi=q.util.isNodejs?yn():null,v=q.asn1,Wt=q.util;q.pki=q.pki||{};Ps.exports=q.pki.rsa=q.rsa=q.rsa||{};var W=q.pki,Sl=[6,4,2,4,2,4,6,2],Al={name:"PrivateKeyInfo",tagClass:v.Class.UNIVERSAL,type:v.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:v.Class.UNIVERSAL,type:v.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:v.Class.UNIVERSAL,type:v.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:v.Class.UNIVERSAL,type:v.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]},Cl={name:"RSAPrivateKey",tagClass:v.Class.UNIVERSAL,type:v.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPrivateKey.version",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"RSAPrivateKey.modulus",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"privateKeyModulus"},{name:"RSAPrivateKey.publicExponent",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"privateKeyPublicExponent"},{name:"RSAPrivateKey.privateExponent",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"privateKeyPrivateExponent"},{name:"RSAPrivateKey.prime1",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"privateKeyPrime1"},{name:"RSAPrivateKey.prime2",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"privateKeyPrime2"},{name:"RSAPrivateKey.exponent1",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"privateKeyExponent1"},{name:"RSAPrivateKey.exponent2",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"privateKeyExponent2"},{name:"RSAPrivateKey.coefficient",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"privateKeyCoefficient"}]},Tl={name:"RSAPublicKey",tagClass:v.Class.UNIVERSAL,type:v.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPublicKey.modulus",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"publicKeyModulus"},{name:"RSAPublicKey.exponent",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"publicKeyExponent"}]},Il=q.pki.rsa.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:v.Class.UNIVERSAL,type:v.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:v.Class.UNIVERSAL,type:v.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:v.Class.UNIVERSAL,type:v.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{name:"SubjectPublicKeyInfo.subjectPublicKey",tagClass:v.Class.UNIVERSAL,type:v.Type.BITSTRING,constructed:!1,value:[{name:"SubjectPublicKeyInfo.subjectPublicKey.RSAPublicKey",tagClass:v.Class.UNIVERSAL,type:v.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"rsaPublicKey"}]}]},_l={name:"DigestInfo",tagClass:v.Class.UNIVERSAL,type:v.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm",tagClass:v.Class.UNIVERSAL,type:v.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm.algorithmIdentifier",tagClass:v.Class.UNIVERSAL,type:v.Type.OID,constructed:!1,capture:"algorithmIdentifier"},{name:"DigestInfo.DigestAlgorithm.parameters",tagClass:v.Class.UNIVERSAL,type:v.Type.NULL,capture:"parameters",optional:!0,constructed:!1}]},{name:"DigestInfo.digest",tagClass:v.Class.UNIVERSAL,type:v.Type.OCTETSTRING,constructed:!1,capture:"digest"}]},Rl=function(t){var e;if(t.algorithm in W.oids)e=W.oids[t.algorithm];else{var r=new Error("Unknown message digest algorithm.");throw r.algorithm=t.algorithm,r}var n=v.oidToDer(e).getBytes(),i=v.create(v.Class.UNIVERSAL,v.Type.SEQUENCE,!0,[]),a=v.create(v.Class.UNIVERSAL,v.Type.SEQUENCE,!0,[]);a.value.push(v.create(v.Class.UNIVERSAL,v.Type.OID,!1,n)),a.value.push(v.create(v.Class.UNIVERSAL,v.Type.NULL,!1,""));var s=v.create(v.Class.UNIVERSAL,v.Type.OCTETSTRING,!1,t.digest().getBytes());return i.value.push(a),i.value.push(s),v.toDer(i).getBytes()},Ns=function(t,e,r){if(r)return t.modPow(e.e,e.n);if(!e.p||!e.q)return t.modPow(e.d,e.n);e.dP||(e.dP=e.d.mod(e.p.subtract(et.ONE))),e.dQ||(e.dQ=e.d.mod(e.q.subtract(et.ONE))),e.qInv||(e.qInv=e.q.modInverse(e.p));var n;do n=new et(q.util.bytesToHex(q.random.getBytes(e.n.bitLength()/8)),16);while(n.compareTo(e.n)>=0||!n.gcd(e.n).equals(et.ONE));t=t.multiply(n.modPow(e.e,e.n)).mod(e.n);for(var i=t.mod(e.p).modPow(e.dP,e.p),a=t.mod(e.q).modPow(e.dQ,e.q);i.compareTo(a)<0;)i=i.add(e.p);var s=i.subtract(a).multiply(e.qInv).mod(e.p).multiply(e.q).add(a);return s=s.multiply(n.modInverse(e.n)).mod(e.n),s};W.rsa.encrypt=function(t,e,r){var n=r,i,a=Math.ceil(e.n.bitLength()/8);r!==!1&&r!==!0?(n=r===2,i=ks(t,e,r)):(i=q.util.createBuffer(),i.putBytes(t));for(var s=new et(i.toHex(),16),o=Ns(s,e,n),f=o.toString(16),c=q.util.createBuffer(),u=a-Math.ceil(f.length/2);u>0;)c.putByte(0),--u;return c.putBytes(q.util.hexToBytes(f)),c.getBytes()};W.rsa.decrypt=function(t,e,r,n){var i=Math.ceil(e.n.bitLength()/8);if(t.length!==i){var a=new Error("Encrypted message length is invalid.");throw a.length=t.length,a.expected=i,a}var s=new et(q.util.createBuffer(t).toHex(),16);if(s.compareTo(e.n)>=0)throw new Error("Encrypted message is invalid.");for(var o=Ns(s,e,r),f=o.toString(16),c=q.util.createBuffer(),u=i-Math.ceil(f.length/2);u>0;)c.putByte(0),--u;return c.putBytes(q.util.hexToBytes(f)),n!==!1?Bn(c.getBytes(),e,r):c.getBytes()};W.rsa.createKeyPairGenerationState=function(t,e,r){typeof t=="string"&&(t=parseInt(t,10)),t=t||2048,r=r||{};var n=r.prng||q.random,i={nextBytes:function(o){for(var f=n.getBytesSync(o.length),c=0;c<o.length;++c)o[c]=f.charCodeAt(c)}},a=r.algorithm||"PRIMEINC",s;if(a==="PRIMEINC")s={algorithm:a,state:0,bits:t,rng:i,eInt:e||65537,e:new et(null),p:null,q:null,qBits:t>>1,pBits:t-(t>>1),pqState:0,num:null,keys:null},s.e.fromInt(s.eInt);else throw new Error("Invalid key generation algorithm: "+a);return s};W.rsa.stepKeyPairGenerationState=function(t,e){"algorithm"in t||(t.algorithm="PRIMEINC");var r=new et(null);r.fromInt(30);for(var n=0,i=function(h,l){return h|l},a=+new Date,s,o=0;t.keys===null&&(e<=0||o<e);){if(t.state===0){var f=t.p===null?t.pBits:t.qBits,c=f-1;t.pqState===0?(t.num=new et(f,t.rng),t.num.testBit(c)||t.num.bitwiseTo(et.ONE.shiftLeft(c),i,t.num),t.num.dAddOffset(31-t.num.mod(r).byteValue(),0),n=0,++t.pqState):t.pqState===1?t.num.bitLength()>f?t.pqState=0:t.num.isProbablePrime(Dl(t.num.bitLength()))?++t.pqState:t.num.dAddOffset(Sl[n++%8],0):t.pqState===2?t.pqState=t.num.subtract(et.ONE).gcd(t.e).compareTo(et.ONE)===0?3:0:t.pqState===3&&(t.pqState=0,t.p===null?t.p=t.num:t.q=t.num,t.p!==null&&t.q!==null&&++t.state,t.num=null)}else if(t.state===1)t.p.compareTo(t.q)<0&&(t.num=t.p,t.p=t.q,t.q=t.num),++t.state;else if(t.state===2)t.p1=t.p.subtract(et.ONE),t.q1=t.q.subtract(et.ONE),t.phi=t.p1.multiply(t.q1),++t.state;else if(t.state===3)t.phi.gcd(t.e).compareTo(et.ONE)===0?++t.state:(t.p=null,t.q=null,t.state=0);else if(t.state===4)t.n=t.p.multiply(t.q),t.n.bitLength()===t.bits?++t.state:(t.q=null,t.state=0);else if(t.state===5){var u=t.e.modInverse(t.phi);t.keys={privateKey:W.rsa.setPrivateKey(t.n,t.e,u,t.p,t.q,u.mod(t.p1),u.mod(t.q1),t.q.modInverse(t.p)),publicKey:W.rsa.setPublicKey(t.n,t.e)}}s=+new Date,o+=s-a,a=s}return t.keys!==null};W.rsa.generateKeyPair=function(t,e,r,n){if(arguments.length===1?typeof t=="object"?(r=t,t=void 0):typeof t=="function"&&(n=t,t=void 0):arguments.length===2?typeof t=="number"?typeof e=="function"?(n=e,e=void 0):typeof e!="number"&&(r=e,e=void 0):(r=t,n=e,t=void 0,e=void 0):arguments.length===3&&(typeof e=="number"?typeof r=="function"&&(n=r,r=void 0):(n=r,r=e,e=void 0)),r=r||{},t===void 0&&(t=r.bits||2048),e===void 0&&(e=r.e||65537),!q.options.usePureJavaScript&&!r.prng&&t>=256&&t<=16384&&(e===65537||e===3)){if(n){if(_s("generateKeyPair"))return Gi.generateKeyPair("rsa",{modulusLength:t,publicExponent:e,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}},function(o,f,c){if(o)return n(o);n(null,{privateKey:W.privateKeyFromPem(c),publicKey:W.publicKeyFromPem(f)})});if(Rs("generateKey")&&Rs("exportKey"))return Wt.globalScope.crypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:t,publicExponent:Ds(e),hash:{name:"SHA-256"}},!0,["sign","verify"]).then(function(o){return Wt.globalScope.crypto.subtle.exportKey("pkcs8",o.privateKey)}).then(void 0,function(o){n(o)}).then(function(o){if(o){var f=W.privateKeyFromAsn1(v.fromDer(q.util.createBuffer(o)));n(null,{privateKey:f,publicKey:W.setRsaPublicKey(f.n,f.e)})}});if(Ls("generateKey")&&Ls("exportKey")){var i=Wt.globalScope.msCrypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:t,publicExponent:Ds(e),hash:{name:"SHA-256"}},!0,["sign","verify"]);i.oncomplete=function(o){var f=o.target.result,c=Wt.globalScope.msCrypto.subtle.exportKey("pkcs8",f.privateKey);c.oncomplete=function(u){var h=u.target.result,l=W.privateKeyFromAsn1(v.fromDer(q.util.createBuffer(h)));n(null,{privateKey:l,publicKey:W.setRsaPublicKey(l.n,l.e)})},c.onerror=function(u){n(u)}},i.onerror=function(o){n(o)};return}}else if(_s("generateKeyPairSync")){var a=Gi.generateKeyPairSync("rsa",{modulusLength:t,publicExponent:e,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}});return{privateKey:W.privateKeyFromPem(a.privateKey),publicKey:W.publicKeyFromPem(a.publicKey)}}}var s=W.rsa.createKeyPairGenerationState(t,e,r);if(!n)return W.rsa.stepKeyPairGenerationState(s,0),s.keys;Ll(s,r,n)};W.setRsaPublicKey=W.rsa.setPublicKey=function(t,e){var r={n:t,e};return r.encrypt=function(n,i,a){if(typeof i=="string"?i=i.toUpperCase():i===void 0&&(i="RSAES-PKCS1-V1_5"),i==="RSAES-PKCS1-V1_5")i={encode:function(o,f,c){return ks(o,f,2).getBytes()}};else if(i==="RSA-OAEP"||i==="RSAES-OAEP")i={encode:function(o,f){return q.pkcs1.encode_rsa_oaep(f,o,a)}};else if(["RAW","NONE","NULL",null].indexOf(i)!==-1)i={encode:function(o){return o}};else if(typeof i=="string")throw new Error('Unsupported encryption scheme: "'+i+'".');var s=i.encode(n,r,!0);return W.rsa.encrypt(s,r,!0)},r.verify=function(n,i,a,s){typeof a=="string"?a=a.toUpperCase():a===void 0&&(a="RSASSA-PKCS1-V1_5"),s===void 0&&(s={_parseAllDigestBytes:!0}),"_parseAllDigestBytes"in s||(s._parseAllDigestBytes=!0),a==="RSASSA-PKCS1-V1_5"?a={verify:function(f,c){c=Bn(c,r,!0);var u=v.fromDer(c,{parseAllBytes:s._parseAllDigestBytes}),h={},l=[];if(!v.validate(u,_l,h,l)){var x=new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value.");throw x.errors=l,x}var p=v.derToOid(h.algorithmIdentifier);if(!(p===q.oids.md2||p===q.oids.md5||p===q.oids.sha1||p===q.oids.sha224||p===q.oids.sha256||p===q.oids.sha384||p===q.oids.sha512||p===q.oids["sha512-224"]||p===q.oids["sha512-256"])){var x=new Error("Unknown RSASSA-PKCS1-v1_5 DigestAlgorithm identifier.");throw x.oid=p,x}if((p===q.oids.md2||p===q.oids.md5)&&!("parameters"in h))throw new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value. Missing algorithm identifer NULL parameters.");return f===h.digest}}:(a==="NONE"||a==="NULL"||a===null)&&(a={verify:function(f,c){return c=Bn(c,r,!0),f===c}});var o=W.rsa.decrypt(i,r,!0,!1);return a.verify(n,o,r.n.bitLength())},r};W.setRsaPrivateKey=W.rsa.setPrivateKey=function(t,e,r,n,i,a,s,o){var f={n:t,e,d:r,p:n,q:i,dP:a,dQ:s,qInv:o};return f.decrypt=function(c,u,h){typeof u=="string"?u=u.toUpperCase():u===void 0&&(u="RSAES-PKCS1-V1_5");var l=W.rsa.decrypt(c,f,!1,!1);if(u==="RSAES-PKCS1-V1_5")u={decode:Bn};else if(u==="RSA-OAEP"||u==="RSAES-OAEP")u={decode:function(x,p){return q.pkcs1.decode_rsa_oaep(p,x,h)}};else if(["RAW","NONE","NULL",null].indexOf(u)!==-1)u={decode:function(x){return x}};else throw new Error('Unsupported encryption scheme: "'+u+'".');return u.decode(l,f,!1)},f.sign=function(c,u){var h=!1;typeof u=="string"&&(u=u.toUpperCase()),u===void 0||u==="RSASSA-PKCS1-V1_5"?(u={encode:Rl},h=1):(u==="NONE"||u==="NULL"||u===null)&&(u={encode:function(){return c}},h=1);var l=u.encode(c,f.n.bitLength());return W.rsa.encrypt(l,f,h)},f};W.wrapRsaPrivateKey=function(t){return v.create(v.Class.UNIVERSAL,v.Type.SEQUENCE,!0,[v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,v.integerToDer(0).getBytes()),v.create(v.Class.UNIVERSAL,v.Type.SEQUENCE,!0,[v.create(v.Class.UNIVERSAL,v.Type.OID,!1,v.oidToDer(W.oids.rsaEncryption).getBytes()),v.create(v.Class.UNIVERSAL,v.Type.NULL,!1,"")]),v.create(v.Class.UNIVERSAL,v.Type.OCTETSTRING,!1,v.toDer(t).getBytes())])};W.privateKeyFromAsn1=function(t){var e={},r=[];if(v.validate(t,Al,e,r)&&(t=v.fromDer(q.util.createBuffer(e.privateKey))),e={},r=[],!v.validate(t,Cl,e,r)){var n=new Error("Cannot read private key. ASN.1 object does not contain an RSAPrivateKey.");throw n.errors=r,n}var i,a,s,o,f,c,u,h;return i=q.util.createBuffer(e.privateKeyModulus).toHex(),a=q.util.createBuffer(e.privateKeyPublicExponent).toHex(),s=q.util.createBuffer(e.privateKeyPrivateExponent).toHex(),o=q.util.createBuffer(e.privateKeyPrime1).toHex(),f=q.util.createBuffer(e.privateKeyPrime2).toHex(),c=q.util.createBuffer(e.privateKeyExponent1).toHex(),u=q.util.createBuffer(e.privateKeyExponent2).toHex(),h=q.util.createBuffer(e.privateKeyCoefficient).toHex(),W.setRsaPrivateKey(new et(i,16),new et(a,16),new et(s,16),new et(o,16),new et(f,16),new et(c,16),new et(u,16),new et(h,16))};W.privateKeyToAsn1=W.privateKeyToRSAPrivateKey=function(t){return v.create(v.Class.UNIVERSAL,v.Type.SEQUENCE,!0,[v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,v.integerToDer(0).getBytes()),v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,he(t.n)),v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,he(t.e)),v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,he(t.d)),v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,he(t.p)),v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,he(t.q)),v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,he(t.dP)),v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,he(t.dQ)),v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,he(t.qInv))])};W.publicKeyFromAsn1=function(t){var e={},r=[];if(v.validate(t,Il,e,r)){var n=v.derToOid(e.publicKeyOid);if(n!==W.oids.rsaEncryption){var i=new Error("Cannot read public key. Unknown OID.");throw i.oid=n,i}t=e.rsaPublicKey}if(r=[],!v.validate(t,Tl,e,r)){var i=new Error("Cannot read public key. ASN.1 object does not contain an RSAPublicKey.");throw i.errors=r,i}var a=q.util.createBuffer(e.publicKeyModulus).toHex(),s=q.util.createBuffer(e.publicKeyExponent).toHex();return W.setRsaPublicKey(new et(a,16),new et(s,16))};W.publicKeyToAsn1=W.publicKeyToSubjectPublicKeyInfo=function(t){return v.create(v.Class.UNIVERSAL,v.Type.SEQUENCE,!0,[v.create(v.Class.UNIVERSAL,v.Type.SEQUENCE,!0,[v.create(v.Class.UNIVERSAL,v.Type.OID,!1,v.oidToDer(W.oids.rsaEncryption).getBytes()),v.create(v.Class.UNIVERSAL,v.Type.NULL,!1,"")]),v.create(v.Class.UNIVERSAL,v.Type.BITSTRING,!1,[W.publicKeyToRSAPublicKey(t)])])};W.publicKeyToRSAPublicKey=function(t){return v.create(v.Class.UNIVERSAL,v.Type.SEQUENCE,!0,[v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,he(t.n)),v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,he(t.e))])};function ks(t,e,r){var n=q.util.createBuffer(),i=Math.ceil(e.n.bitLength()/8);if(t.length>i-11){var a=new Error("Message is too long for PKCS#1 v1.5 padding.");throw a.length=t.length,a.max=i-11,a}n.putByte(0),n.putByte(r);var s=i-3-t.length,o;if(r===0||r===1){o=r===0?0:255;for(var f=0;f<s;++f)n.putByte(o)}else for(;s>0;){for(var c=0,u=q.random.getBytes(s),f=0;f<s;++f)o=u.charCodeAt(f),o===0?++c:n.putByte(o);s=c}return n.putByte(0),n.putBytes(t),n}function Bn(t,e,r,n){var i=Math.ceil(e.n.bitLength()/8),a=q.util.createBuffer(t),s=a.getByte(),o=a.getByte();if(s!==0||r&&o!==0&&o!==1||!r&&o!=2||r&&o===0&&typeof n>"u")throw new Error("Encryption block is invalid.");var f=0;if(o===0){f=i-3-n;for(var c=0;c<f;++c)if(a.getByte()!==0)throw new Error("Encryption block is invalid.")}else if(o===1)for(f=0;a.length()>1;){if(a.getByte()!==255){--a.read;break}++f}else if(o===2)for(f=0;a.length()>1;){if(a.getByte()===0){--a.read;break}++f}var u=a.getByte();if(u!==0||f!==i-3-a.length())throw new Error("Encryption block is invalid.");return a.getBytes()}function Ll(t,e,r){typeof e=="function"&&(r=e,e={}),e=e||{};var n={algorithm:{name:e.algorithm||"PRIMEINC",options:{workers:e.workers||2,workLoad:e.workLoad||100,workerScript:e.workerScript}}};"prng"in e&&(n.prng=e.prng),i();function i(){a(t.pBits,function(o,f){if(o)return r(o);if(t.p=f,t.q!==null)return s(o,t.q);a(t.qBits,s)})}function a(o,f){q.prime.generateProbablePrime(o,n,f)}function s(o,f){if(o)return r(o);if(t.q=f,t.p.compareTo(t.q)<0){var c=t.p;t.p=t.q,t.q=c}if(t.p.subtract(et.ONE).gcd(t.e).compareTo(et.ONE)!==0){t.p=null,i();return}if(t.q.subtract(et.ONE).gcd(t.e).compareTo(et.ONE)!==0){t.q=null,a(t.qBits,s);return}if(t.p1=t.p.subtract(et.ONE),t.q1=t.q.subtract(et.ONE),t.phi=t.p1.multiply(t.q1),t.phi.gcd(t.e).compareTo(et.ONE)!==0){t.p=t.q=null,i();return}if(t.n=t.p.multiply(t.q),t.n.bitLength()!==t.bits){t.q=null,a(t.qBits,s);return}var u=t.e.modInverse(t.phi);t.keys={privateKey:W.rsa.setPrivateKey(t.n,t.e,u,t.p,t.q,u.mod(t.p1),u.mod(t.q1),t.q.modInverse(t.p)),publicKey:W.rsa.setPublicKey(t.n,t.e)},r(null,t.keys)}}function he(t){var e=t.toString(16);e[0]>="8"&&(e="00"+e);var r=q.util.hexToBytes(e);return r.length>1&&(r.charCodeAt(0)===0&&!(r.charCodeAt(1)&128)||r.charCodeAt(0)===255&&(r.charCodeAt(1)&128)===128)?r.substr(1):r}function Dl(t){return t<=100?27:t<=150?18:t<=200?15:t<=250?12:t<=300?9:t<=350?8:t<=400?7:t<=500?6:t<=600?5:t<=800?4:t<=1250?3:2}function _s(t){return q.util.isNodejs&&typeof Gi[t]=="function"}function Rs(t){return typeof Wt.globalScope<"u"&&typeof Wt.globalScope.crypto=="object"&&typeof Wt.globalScope.crypto.subtle=="object"&&typeof Wt.globalScope.crypto.subtle[t]=="function"}function Ls(t){return typeof Wt.globalScope<"u"&&typeof Wt.globalScope.msCrypto=="object"&&typeof Wt.globalScope.msCrypto.subtle=="object"&&typeof Wt.globalScope.msCrypto.subtle[t]=="function"}function Ds(t){for(var e=q.util.hexToBytes(t.toString(16)),r=new Uint8Array(e.length),n=0;n<e.length;++n)r[n]=e.charCodeAt(n);return r}});var Vs=Q((hy,qs)=>{var U=st();an();Or();Wo();Ge();hn();Ui();jo();Mr();hs();Sn();Bt();typeof Us>"u"&&(Us=U.jsbn.BigInteger);var Us,S=U.asn1,Y=U.pki=U.pki||{};qs.exports=Y.pbe=U.pbe=U.pbe||{};var Ze=Y.oids,Nl={name:"EncryptedPrivateKeyInfo",tagClass:S.Class.UNIVERSAL,type:S.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedPrivateKeyInfo.encryptionAlgorithm",tagClass:S.Class.UNIVERSAL,type:S.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:S.Class.UNIVERSAL,type:S.Type.OID,constructed:!1,capture:"encryptionOid"},{name:"AlgorithmIdentifier.parameters",tagClass:S.Class.UNIVERSAL,type:S.Type.SEQUENCE,constructed:!0,captureAsn1:"encryptionParams"}]},{name:"EncryptedPrivateKeyInfo.encryptedData",tagClass:S.Class.UNIVERSAL,type:S.Type.OCTETSTRING,constructed:!1,capture:"encryptedData"}]},kl={name:"PBES2Algorithms",tagClass:S.Class.UNIVERSAL,type:S.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc",tagClass:S.Class.UNIVERSAL,type:S.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc.oid",tagClass:S.Class.UNIVERSAL,type:S.Type.OID,constructed:!1,capture:"kdfOid"},{name:"PBES2Algorithms.params",tagClass:S.Class.UNIVERSAL,type:S.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.params.salt",tagClass:S.Class.UNIVERSAL,type:S.Type.OCTETSTRING,constructed:!1,capture:"kdfSalt"},{name:"PBES2Algorithms.params.iterationCount",tagClass:S.Class.UNIVERSAL,type:S.Type.INTEGER,constructed:!1,capture:"kdfIterationCount"},{name:"PBES2Algorithms.params.keyLength",tagClass:S.Class.UNIVERSAL,type:S.Type.INTEGER,constructed:!1,optional:!0,capture:"keyLength"},{name:"PBES2Algorithms.params.prf",tagClass:S.Class.UNIVERSAL,type:S.Type.SEQUENCE,constructed:!0,optional:!0,value:[{name:"PBES2Algorithms.params.prf.algorithm",tagClass:S.Class.UNIVERSAL,type:S.Type.OID,constructed:!1,capture:"prfOid"}]}]}]},{name:"PBES2Algorithms.encryptionScheme",tagClass:S.Class.UNIVERSAL,type:S.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.encryptionScheme.oid",tagClass:S.Class.UNIVERSAL,type:S.Type.OID,constructed:!1,capture:"encOid"},{name:"PBES2Algorithms.encryptionScheme.iv",tagClass:S.Class.UNIVERSAL,type:S.Type.OCTETSTRING,constructed:!1,capture:"encIv"}]}]},Pl={name:"pkcs-12PbeParams",tagClass:S.Class.UNIVERSAL,type:S.Type.SEQUENCE,constructed:!0,value:[{name:"pkcs-12PbeParams.salt",tagClass:S.Class.UNIVERSAL,type:S.Type.OCTETSTRING,constructed:!1,capture:"salt"},{name:"pkcs-12PbeParams.iterations",tagClass:S.Class.UNIVERSAL,type:S.Type.INTEGER,constructed:!1,capture:"iterations"}]};Y.encryptPrivateKeyInfo=function(t,e,r){r=r||{},r.saltSize=r.saltSize||8,r.count=r.count||2048,r.algorithm=r.algorithm||"aes128",r.prfAlgorithm=r.prfAlgorithm||"sha1";var n=U.random.getBytesSync(r.saltSize),i=r.count,a=S.integerToDer(i),s,o,f;if(r.algorithm.indexOf("aes")===0||r.algorithm==="des"){var c,u,h;switch(r.algorithm){case"aes128":s=16,c=16,u=Ze["aes128-CBC"],h=U.aes.createEncryptionCipher;break;case"aes192":s=24,c=16,u=Ze["aes192-CBC"],h=U.aes.createEncryptionCipher;break;case"aes256":s=32,c=16,u=Ze["aes256-CBC"],h=U.aes.createEncryptionCipher;break;case"des":s=8,c=8,u=Ze.desCBC,h=U.des.createEncryptionCipher;break;default:var l=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw l.algorithm=r.algorithm,l}var x="hmacWith"+r.prfAlgorithm.toUpperCase(),p=Ms(x),d=U.pkcs5.pbkdf2(e,n,i,s,p),y=U.random.getBytesSync(c),m=h(d);m.start(y),m.update(S.toDer(t)),m.finish(),f=m.output.getBytes();var E=Ul(n,a,s,x);o=S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[S.create(S.Class.UNIVERSAL,S.Type.OID,!1,S.oidToDer(Ze.pkcs5PBES2).getBytes()),S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[S.create(S.Class.UNIVERSAL,S.Type.OID,!1,S.oidToDer(Ze.pkcs5PBKDF2).getBytes()),E]),S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[S.create(S.Class.UNIVERSAL,S.Type.OID,!1,S.oidToDer(u).getBytes()),S.create(S.Class.UNIVERSAL,S.Type.OCTETSTRING,!1,y)])])])}else if(r.algorithm==="3des"){s=24;var b=new U.util.ByteBuffer(n),d=Y.pbe.generatePkcs12Key(e,b,1,i,s),y=Y.pbe.generatePkcs12Key(e,b,2,i,s),m=U.des.createEncryptionCipher(d);m.start(y),m.update(S.toDer(t)),m.finish(),f=m.output.getBytes(),o=S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[S.create(S.Class.UNIVERSAL,S.Type.OID,!1,S.oidToDer(Ze["pbeWithSHAAnd3-KeyTripleDES-CBC"]).getBytes()),S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[S.create(S.Class.UNIVERSAL,S.Type.OCTETSTRING,!1,n),S.create(S.Class.UNIVERSAL,S.Type.INTEGER,!1,a.getBytes())])])}else{var l=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw l.algorithm=r.algorithm,l}var R=S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[o,S.create(S.Class.UNIVERSAL,S.Type.OCTETSTRING,!1,f)]);return R};Y.decryptPrivateKeyInfo=function(t,e){var r=null,n={},i=[];if(!S.validate(t,Nl,n,i)){var a=new Error("Cannot read encrypted private key. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw a.errors=i,a}var s=S.derToOid(n.encryptionOid),o=Y.pbe.getCipher(s,n.encryptionParams,e),f=U.util.createBuffer(n.encryptedData);return o.update(f),o.finish()&&(r=S.fromDer(o.output)),r};Y.encryptedPrivateKeyToPem=function(t,e){var r={type:"ENCRYPTED PRIVATE KEY",body:S.toDer(t).getBytes()};return U.pem.encode(r,{maxline:e})};Y.encryptedPrivateKeyFromPem=function(t){var e=U.pem.decode(t)[0];if(e.type!=="ENCRYPTED PRIVATE KEY"){var r=new Error('Could not convert encrypted private key from PEM; PEM header type is "ENCRYPTED PRIVATE KEY".');throw r.headerType=e.type,r}if(e.procType&&e.procType.type==="ENCRYPTED")throw new Error("Could not convert encrypted private key from PEM; PEM is encrypted.");return S.fromDer(e.body)};Y.encryptRsaPrivateKey=function(t,e,r){if(r=r||{},!r.legacy){var n=Y.wrapRsaPrivateKey(Y.privateKeyToAsn1(t));return n=Y.encryptPrivateKeyInfo(n,e,r),Y.encryptedPrivateKeyToPem(n)}var i,a,s,o;switch(r.algorithm){case"aes128":i="AES-128-CBC",s=16,a=U.random.getBytesSync(16),o=U.aes.createEncryptionCipher;break;case"aes192":i="AES-192-CBC",s=24,a=U.random.getBytesSync(16),o=U.aes.createEncryptionCipher;break;case"aes256":i="AES-256-CBC",s=32,a=U.random.getBytesSync(16),o=U.aes.createEncryptionCipher;break;case"3des":i="DES-EDE3-CBC",s=24,a=U.random.getBytesSync(8),o=U.des.createEncryptionCipher;break;case"des":i="DES-CBC",s=8,a=U.random.getBytesSync(8),o=U.des.createEncryptionCipher;break;default:var f=new Error('Could not encrypt RSA private key; unsupported encryption algorithm "'+r.algorithm+'".');throw f.algorithm=r.algorithm,f}var c=U.pbe.opensslDeriveBytes(e,a.substr(0,8),s),u=o(c);u.start(a),u.update(S.toDer(Y.privateKeyToAsn1(t))),u.finish();var h={type:"RSA PRIVATE KEY",procType:{version:"4",type:"ENCRYPTED"},dekInfo:{algorithm:i,parameters:U.util.bytesToHex(a).toUpperCase()},body:u.output.getBytes()};return U.pem.encode(h)};Y.decryptRsaPrivateKey=function(t,e){var r=null,n=U.pem.decode(t)[0];if(n.type!=="ENCRYPTED PRIVATE KEY"&&n.type!=="PRIVATE KEY"&&n.type!=="RSA PRIVATE KEY"){var i=new Error('Could not convert private key from PEM; PEM header type is not "ENCRYPTED PRIVATE KEY", "PRIVATE KEY", or "RSA PRIVATE KEY".');throw i.headerType=i,i}if(n.procType&&n.procType.type==="ENCRYPTED"){var a,s;switch(n.dekInfo.algorithm){case"DES-CBC":a=8,s=U.des.createDecryptionCipher;break;case"DES-EDE3-CBC":a=24,s=U.des.createDecryptionCipher;break;case"AES-128-CBC":a=16,s=U.aes.createDecryptionCipher;break;case"AES-192-CBC":a=24,s=U.aes.createDecryptionCipher;break;case"AES-256-CBC":a=32,s=U.aes.createDecryptionCipher;break;case"RC2-40-CBC":a=5,s=function(h){return U.rc2.createDecryptionCipher(h,40)};break;case"RC2-64-CBC":a=8,s=function(h){return U.rc2.createDecryptionCipher(h,64)};break;case"RC2-128-CBC":a=16,s=function(h){return U.rc2.createDecryptionCipher(h,128)};break;default:var i=new Error('Could not decrypt private key; unsupported encryption algorithm "'+n.dekInfo.algorithm+'".');throw i.algorithm=n.dekInfo.algorithm,i}var o=U.util.hexToBytes(n.dekInfo.parameters),f=U.pbe.opensslDeriveBytes(e,o.substr(0,8),a),c=s(f);if(c.start(o),c.update(U.util.createBuffer(n.body)),c.finish())r=c.output.getBytes();else return r}else r=n.body;return n.type==="ENCRYPTED PRIVATE KEY"?r=Y.decryptPrivateKeyInfo(S.fromDer(r),e):r=S.fromDer(r),r!==null&&(r=Y.privateKeyFromAsn1(r)),r};Y.pbe.generatePkcs12Key=function(t,e,r,n,i,a){var s,o;if(typeof a>"u"||a===null){if(!("sha1"in U.md))throw new Error('"sha1" hash algorithm unavailable.');a=U.md.sha1.create()}var f=a.digestLength,c=a.blockLength,u=new U.util.ByteBuffer,h=new U.util.ByteBuffer;if(t!=null){for(o=0;o<t.length;o++)h.putInt16(t.charCodeAt(o));h.putInt16(0)}var l=h.length(),x=e.length(),p=new U.util.ByteBuffer;p.fillWithByte(r,c);var d=c*Math.ceil(x/c),y=new U.util.ByteBuffer;for(o=0;o<d;o++)y.putByte(e.at(o%x));var m=c*Math.ceil(l/c),E=new U.util.ByteBuffer;for(o=0;o<m;o++)E.putByte(h.at(o%l));var b=y;b.putBuffer(E);for(var R=Math.ceil(i/f),w=1;w<=R;w++){var B=new U.util.ByteBuffer;B.putBytes(p.bytes()),B.putBytes(b.bytes());for(var L=0;L<n;L++)a.start(),a.update(B.getBytes()),B=a.digest();var D=new U.util.ByteBuffer;for(o=0;o<c;o++)D.putByte(B.at(o%f));var G=Math.ceil(x/c)+Math.ceil(l/c),z=new U.util.ByteBuffer;for(s=0;s<G;s++){var V=new U.util.ByteBuffer(b.getBytes(c)),J=511;for(o=D.length()-1;o>=0;o--)J=J>>8,J+=D.at(o)+V.at(o),V.setAt(o,J&255);z.putBuffer(V)}b=z,u.putBuffer(B)}return u.truncate(u.length()-i),u};Y.pbe.getCipher=function(t,e,r){switch(t){case Y.oids.pkcs5PBES2:return Y.pbe.getCipherForPBES2(t,e,r);case Y.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:case Y.oids["pbewithSHAAnd40BitRC2-CBC"]:return Y.pbe.getCipherForPKCS12PBE(t,e,r);default:var n=new Error("Cannot read encrypted PBE data block. Unsupported OID.");throw n.oid=t,n.supportedOids=["pkcs5PBES2","pbeWithSHAAnd3-KeyTripleDES-CBC","pbewithSHAAnd40BitRC2-CBC"],n}};Y.pbe.getCipherForPBES2=function(t,e,r){var n={},i=[];if(!S.validate(e,kl,n,i)){var a=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw a.errors=i,a}if(t=S.derToOid(n.kdfOid),t!==Y.oids.pkcs5PBKDF2){var a=new Error("Cannot read encrypted private key. Unsupported key derivation function OID.");throw a.oid=t,a.supportedOids=["pkcs5PBKDF2"],a}if(t=S.derToOid(n.encOid),t!==Y.oids["aes128-CBC"]&&t!==Y.oids["aes192-CBC"]&&t!==Y.oids["aes256-CBC"]&&t!==Y.oids["des-EDE3-CBC"]&&t!==Y.oids.desCBC){var a=new Error("Cannot read encrypted private key. Unsupported encryption scheme OID.");throw a.oid=t,a.supportedOids=["aes128-CBC","aes192-CBC","aes256-CBC","des-EDE3-CBC","desCBC"],a}var s=n.kdfSalt,o=U.util.createBuffer(n.kdfIterationCount);o=o.getInt(o.length()<<3);var f,c;switch(Y.oids[t]){case"aes128-CBC":f=16,c=U.aes.createDecryptionCipher;break;case"aes192-CBC":f=24,c=U.aes.createDecryptionCipher;break;case"aes256-CBC":f=32,c=U.aes.createDecryptionCipher;break;case"des-EDE3-CBC":f=24,c=U.des.createDecryptionCipher;break;case"desCBC":f=8,c=U.des.createDecryptionCipher;break}var u=Os(n.prfOid),h=U.pkcs5.pbkdf2(r,s,o,f,u),l=n.encIv,x=c(h);return x.start(l),x};Y.pbe.getCipherForPKCS12PBE=function(t,e,r){var n={},i=[];if(!S.validate(e,Pl,n,i)){var a=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw a.errors=i,a}var s=U.util.createBuffer(n.salt),o=U.util.createBuffer(n.iterations);o=o.getInt(o.length()<<3);var f,c,u;switch(t){case Y.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:f=24,c=8,u=U.des.startDecrypting;break;case Y.oids["pbewithSHAAnd40BitRC2-CBC"]:f=5,c=8,u=function(d,y){var m=U.rc2.createDecryptionCipher(d,40);return m.start(y,null),m};break;default:var a=new Error("Cannot read PKCS #12 PBE data block. Unsupported OID.");throw a.oid=t,a}var h=Os(n.prfOid),l=Y.pbe.generatePkcs12Key(r,s,1,o,f,h);h.start();var x=Y.pbe.generatePkcs12Key(r,s,2,o,c,h);return u(l,x)};Y.pbe.opensslDeriveBytes=function(t,e,r,n){if(typeof n>"u"||n===null){if(!("md5"in U.md))throw new Error('"md5" hash algorithm unavailable.');n=U.md.md5.create()}e===null&&(e="");for(var i=[Ks(n,t+e)],a=16,s=1;a<r;++s,a+=16)i.push(Ks(n,i[s-1]+t+e));return i.join("").substr(0,r)};function Ks(t,e){return t.start().update(e).digest().getBytes()}function Os(t){var e;if(!t)e="hmacWithSHA1";else if(e=Y.oids[S.derToOid(t)],!e){var r=new Error("Unsupported PRF OID.");throw r.oid=t,r.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],r}return Ms(e)}function Ms(t){var e=U.md;switch(t){case"hmacWithSHA224":e=U.md.sha512;case"hmacWithSHA1":case"hmacWithSHA256":case"hmacWithSHA384":case"hmacWithSHA512":t=t.substr(8).toLowerCase();break;default:var r=new Error("Unsupported PRF algorithm.");throw r.algorithm=t,r.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],r}if(!e||!(t in e))throw new Error("Unknown hash algorithm: "+t);return e[t].create()}function Ul(t,e,r,n){var i=S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[S.create(S.Class.UNIVERSAL,S.Type.OCTETSTRING,!1,t),S.create(S.Class.UNIVERSAL,S.Type.INTEGER,!1,e.getBytes())]);return n!=="hmacWithSHA1"&&i.value.push(S.create(S.Class.UNIVERSAL,S.Type.INTEGER,!1,U.util.hexToBytes(r.toString(16))),S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[S.create(S.Class.UNIVERSAL,S.Type.OID,!1,S.oidToDer(Y.oids[n]).getBytes()),S.create(S.Class.UNIVERSAL,S.Type.NULL,!1,"")])),i}});var p0=Q((s2,l0)=>{"use strict";l0.exports=Vp;function Vp(t,e){for(var r=new Array(arguments.length-1),n=0,i=2,a=!0;i<arguments.length;)r[n++]=arguments[i++];return new Promise(function(o,f){r[n]=function(u){if(a)if(a=!1,u)f(u);else{for(var h=new Array(arguments.length-1),l=0;l<h.length;)h[l++]=arguments[l];o.apply(null,h)}};try{t.apply(e||null,r)}catch(c){a&&(a=!1,f(c))}})}});var g0=Q(x0=>{"use strict";var qn=x0;qn.length=function(e){var r=e.length;if(!r)return 0;for(var n=0;--r%4>1&&e.charAt(r)==="=";)++n;return Math.ceil(e.length*3)/4-n};var wr=new Array(64),y0=new Array(123);for(te=0;te<64;)y0[wr[te]=te<26?te+65:te<52?te+71:te<62?te-4:te-59|43]=te++;var te;qn.encode=function(e,r,n){for(var i=null,a=[],s=0,o=0,f;r<n;){var c=e[r++];switch(o){case 0:a[s++]=wr[c>>2],f=(c&3)<<4,o=1;break;case 1:a[s++]=wr[f|c>>4],f=(c&15)<<2,o=2;break;case 2:a[s++]=wr[f|c>>6],a[s++]=wr[c&63],o=0;break}s>8191&&((i||(i=[])).push(String.fromCharCode.apply(String,a)),s=0)}return o&&(a[s++]=wr[f],a[s++]=61,o===1&&(a[s++]=61)),i?(s&&i.push(String.fromCharCode.apply(String,a.slice(0,s))),i.join("")):String.fromCharCode.apply(String,a.slice(0,s))};var d0="invalid encoding";qn.decode=function(e,r,n){for(var i=n,a=0,s,o=0;o<e.length;){var f=e.charCodeAt(o++);if(f===61&&a>1)break;if((f=y0[f])===void 0)throw Error(d0);switch(a){case 0:s=f,a=1;break;case 1:r[n++]=s<<2|(f&48)>>4,s=f,a=2;break;case 2:r[n++]=(s&15)<<4|(f&60)>>2,s=f,a=3;break;case 3:r[n++]=(s&3)<<6|f,a=0;break}}if(a===1)throw Error(d0);return n-i};qn.test=function(e){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)}});var v0=Q((c2,m0)=>{"use strict";m0.exports=Vn;function Vn(){this._listeners={}}Vn.prototype.on=function(e,r,n){return(this._listeners[e]||(this._listeners[e]=[])).push({fn:r,ctx:n||this}),this};Vn.prototype.off=function(e,r){if(e===void 0)this._listeners={};else if(r===void 0)this._listeners[e]=[];else for(var n=this._listeners[e],i=0;i<n.length;)n[i].fn===r?n.splice(i,1):++i;return this};Vn.prototype.emit=function(e){var r=this._listeners[e];if(r){for(var n=[],i=1;i<arguments.length;)n.push(arguments[i++]);for(i=0;i<r.length;)r[i].fn.apply(r[i++].ctx,n)}return this}});var C0=Q((u2,A0)=>{"use strict";A0.exports=b0(b0);function b0(t){return typeof Float32Array<"u"?function(){var e=new Float32Array([-0]),r=new Uint8Array(e.buffer),n=r[3]===128;function i(f,c,u){e[0]=f,c[u]=r[0],c[u+1]=r[1],c[u+2]=r[2],c[u+3]=r[3]}function a(f,c,u){e[0]=f,c[u]=r[3],c[u+1]=r[2],c[u+2]=r[1],c[u+3]=r[0]}t.writeFloatLE=n?i:a,t.writeFloatBE=n?a:i;function s(f,c){return r[0]=f[c],r[1]=f[c+1],r[2]=f[c+2],r[3]=f[c+3],e[0]}function o(f,c){return r[3]=f[c],r[2]=f[c+1],r[1]=f[c+2],r[0]=f[c+3],e[0]}t.readFloatLE=n?s:o,t.readFloatBE=n?o:s}():function(){function e(n,i,a,s){var o=i<0?1:0;if(o&&(i=-i),i===0)n(1/i>0?0:2147483648,a,s);else if(isNaN(i))n(2143289344,a,s);else if(i>34028234663852886e22)n((o<<31|2139095040)>>>0,a,s);else if(i<11754943508222875e-54)n((o<<31|Math.round(i/1401298464324817e-60))>>>0,a,s);else{var f=Math.floor(Math.log(i)/Math.LN2),c=Math.round(i*Math.pow(2,-f)*8388608)&8388607;n((o<<31|f+127<<23|c)>>>0,a,s)}}t.writeFloatLE=e.bind(null,E0),t.writeFloatBE=e.bind(null,w0);function r(n,i,a){var s=n(i,a),o=(s>>31)*2+1,f=s>>>23&255,c=s&8388607;return f===255?c?NaN:o*(1/0):f===0?o*1401298464324817e-60*c:o*Math.pow(2,f-150)*(c+8388608)}t.readFloatLE=r.bind(null,B0),t.readFloatBE=r.bind(null,S0)}(),typeof Float64Array<"u"?function(){var e=new Float64Array([-0]),r=new Uint8Array(e.buffer),n=r[7]===128;function i(f,c,u){e[0]=f,c[u]=r[0],c[u+1]=r[1],c[u+2]=r[2],c[u+3]=r[3],c[u+4]=r[4],c[u+5]=r[5],c[u+6]=r[6],c[u+7]=r[7]}function a(f,c,u){e[0]=f,c[u]=r[7],c[u+1]=r[6],c[u+2]=r[5],c[u+3]=r[4],c[u+4]=r[3],c[u+5]=r[2],c[u+6]=r[1],c[u+7]=r[0]}t.writeDoubleLE=n?i:a,t.writeDoubleBE=n?a:i;function s(f,c){return r[0]=f[c],r[1]=f[c+1],r[2]=f[c+2],r[3]=f[c+3],r[4]=f[c+4],r[5]=f[c+5],r[6]=f[c+6],r[7]=f[c+7],e[0]}function o(f,c){return r[7]=f[c],r[6]=f[c+1],r[5]=f[c+2],r[4]=f[c+3],r[3]=f[c+4],r[2]=f[c+5],r[1]=f[c+6],r[0]=f[c+7],e[0]}t.readDoubleLE=n?s:o,t.readDoubleBE=n?o:s}():function(){function e(n,i,a,s,o,f){var c=s<0?1:0;if(c&&(s=-s),s===0)n(0,o,f+i),n(1/s>0?0:2147483648,o,f+a);else if(isNaN(s))n(0,o,f+i),n(2146959360,o,f+a);else if(s>17976931348623157e292)n(0,o,f+i),n((c<<31|2146435072)>>>0,o,f+a);else{var u;if(s<22250738585072014e-324)u=s/5e-324,n(u>>>0,o,f+i),n((c<<31|u/4294967296)>>>0,o,f+a);else{var h=Math.floor(Math.log(s)/Math.LN2);h===1024&&(h=1023),u=s*Math.pow(2,-h),n(u*4503599627370496>>>0,o,f+i),n((c<<31|h+1023<<20|u*1048576&1048575)>>>0,o,f+a)}}}t.writeDoubleLE=e.bind(null,E0,0,4),t.writeDoubleBE=e.bind(null,w0,4,0);function r(n,i,a,s,o){var f=n(s,o+i),c=n(s,o+a),u=(c>>31)*2+1,h=c>>>20&2047,l=4294967296*(c&1048575)+f;return h===2047?l?NaN:u*(1/0):h===0?u*5e-324*l:u*Math.pow(2,h-1075)*(l+4503599627370496)}t.readDoubleLE=r.bind(null,B0,0,4),t.readDoubleBE=r.bind(null,S0,4,0)}(),t}function E0(t,e,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24}function w0(t,e,r){e[r]=t>>>24,e[r+1]=t>>>16&255,e[r+2]=t>>>8&255,e[r+3]=t&255}function B0(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16|t[e+3]<<24)>>>0}function S0(t,e){return(t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3])>>>0}});var T0=Q((exports,module)=>{"use strict";module.exports=inquire;function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(t){}return null}});var _0=Q(I0=>{"use strict";var ca=I0;ca.length=function(e){for(var r=0,n=0,i=0;i<e.length;++i)n=e.charCodeAt(i),n<128?r+=1:n<2048?r+=2:(n&64512)===55296&&(e.charCodeAt(i+1)&64512)===56320?(++i,r+=4):r+=3;return r};ca.read=function(e,r,n){var i=n-r;if(i<1)return"";for(var a=null,s=[],o=0,f;r<n;)f=e[r++],f<128?s[o++]=f:f>191&&f<224?s[o++]=(f&31)<<6|e[r++]&63:f>239&&f<365?(f=((f&7)<<18|(e[r++]&63)<<12|(e[r++]&63)<<6|e[r++]&63)-65536,s[o++]=55296+(f>>10),s[o++]=56320+(f&1023)):s[o++]=(f&15)<<12|(e[r++]&63)<<6|e[r++]&63,o>8191&&((a||(a=[])).push(String.fromCharCode.apply(String,s)),o=0);return a?(o&&a.push(String.fromCharCode.apply(String,s.slice(0,o))),a.join("")):String.fromCharCode.apply(String,s.slice(0,o))};ca.write=function(e,r,n){for(var i=n,a,s,o=0;o<e.length;++o)a=e.charCodeAt(o),a<128?r[n++]=a:a<2048?(r[n++]=a>>6|192,r[n++]=a&63|128):(a&64512)===55296&&((s=e.charCodeAt(o+1))&64512)===56320?(a=65536+((a&1023)<<10)+(s&1023),++o,r[n++]=a>>18|240,r[n++]=a>>12&63|128,r[n++]=a>>6&63|128,r[n++]=a&63|128):(r[n++]=a>>12|224,r[n++]=a>>6&63|128,r[n++]=a&63|128);return n-i}});var L0=Q((l2,R0)=>{"use strict";R0.exports=Fp;function Fp(t,e,r){var n=r||8192,i=n>>>1,a=null,s=n;return function(f){if(f<1||f>i)return t(f);s+f>n&&(a=t(n),s=0);var c=e.call(a,s,s+=f);return s&7&&(s=(s|7)+1),c}}});var N0=Q((p2,D0)=>{"use strict";D0.exports=Nt;var zr=je();function Nt(t,e){this.lo=t>>>0,this.hi=e>>>0}var Je=Nt.zero=new Nt(0,0);Je.toNumber=function(){return 0};Je.zzEncode=Je.zzDecode=function(){return this};Je.length=function(){return 1};var Hp=Nt.zeroHash="\0\0\0\0\0\0\0\0";Nt.fromNumber=function(e){if(e===0)return Je;var r=e<0;r&&(e=-e);var n=e>>>0,i=(e-n)/4294967296>>>0;return r&&(i=~i>>>0,n=~n>>>0,++n>4294967295&&(n=0,++i>4294967295&&(i=0))),new Nt(n,i)};Nt.from=function(e){if(typeof e=="number")return Nt.fromNumber(e);if(zr.isString(e))if(zr.Long)e=zr.Long.fromString(e);else return Nt.fromNumber(parseInt(e,10));return e.low||e.high?new Nt(e.low>>>0,e.high>>>0):Je};Nt.prototype.toNumber=function(e){if(!e&&this.hi>>>31){var r=~this.lo+1>>>0,n=~this.hi>>>0;return r||(n=n+1>>>0),-(r+n*4294967296)}return this.lo+this.hi*4294967296};Nt.prototype.toLong=function(e){return zr.Long?new zr.Long(this.lo|0,this.hi|0,!!e):{low:this.lo|0,high:this.hi|0,unsigned:!!e}};var Oe=String.prototype.charCodeAt;Nt.fromHash=function(e){return e===Hp?Je:new Nt((Oe.call(e,0)|Oe.call(e,1)<<8|Oe.call(e,2)<<16|Oe.call(e,3)<<24)>>>0,(Oe.call(e,4)|Oe.call(e,5)<<8|Oe.call(e,6)<<16|Oe.call(e,7)<<24)>>>0)};Nt.prototype.toHash=function(){return String.fromCharCode(this.lo&255,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,this.hi&255,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)};Nt.prototype.zzEncode=function(){var e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this};Nt.prototype.zzDecode=function(){var e=-(this.lo&1);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this};Nt.prototype.length=function(){var e=this.lo,r=(this.lo>>>28|this.hi<<4)>>>0,n=this.hi>>>24;return n===0?r===0?e<16384?e<128?1:2:e<2097152?3:4:r<16384?r<128?5:6:r<2097152?7:8:n<128?9:10}});var je=Q(ua=>{"use strict";var M=ua;M.asPromise=p0();M.base64=g0();M.EventEmitter=v0();M.float=C0();M.inquire=T0();M.utf8=_0();M.pool=L0();M.LongBits=N0();M.isNode=!!(typeof globalThis<"u"&&globalThis&&globalThis.process&&globalThis.process.versions&&globalThis.process.versions.node);M.global=M.isNode&&globalThis||typeof window<"u"&&window||typeof self<"u"&&self||ua;M.emptyArray=Object.freeze?Object.freeze([]):[];M.emptyObject=Object.freeze?Object.freeze({}):{};M.isInteger=Number.isInteger||function(e){return typeof e=="number"&&isFinite(e)&&Math.floor(e)===e};M.isString=function(e){return typeof e=="string"||e instanceof String};M.isObject=function(e){return e&&typeof e=="object"};M.isset=M.isSet=function(e,r){var n=e[r];return n!=null&&e.hasOwnProperty(r)?typeof n!="object"||(Array.isArray(n)?n.length:Object.keys(n).length)>0:!1};M.Buffer=function(){try{var t=M.inquire("buffer").Buffer;return t.prototype.utf8Write?t:null}catch{return null}}();M._Buffer_from=null;M._Buffer_allocUnsafe=null;M.newBuffer=function(e){return typeof e=="number"?M.Buffer?M._Buffer_allocUnsafe(e):new M.Array(e):M.Buffer?M._Buffer_from(e):typeof Uint8Array>"u"?e:new Uint8Array(e)};M.Array=typeof Uint8Array<"u"?Uint8Array:Array;M.Long=M.global.dcodeIO&&M.global.dcodeIO.Long||M.global.Long||M.inquire("long");M.key2Re=/^true|false|0|1$/;M.key32Re=/^-?(?:0|[1-9][0-9]*)$/;M.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/;M.longToHash=function(e){return e?M.LongBits.from(e).toHash():M.LongBits.zeroHash};M.longFromHash=function(e,r){var n=M.LongBits.fromHash(e);return M.Long?M.Long.fromBits(n.lo,n.hi,r):n.toNumber(!!r)};function k0(t,e,r){for(var n=Object.keys(e),i=0;i<n.length;++i)(t[n[i]]===void 0||!r)&&(t[n[i]]=e[n[i]]);return t}M.merge=k0;M.lcFirst=function(e){return e.charAt(0).toLowerCase()+e.substring(1)};function P0(t){function e(r,n){if(!(this instanceof e))return new e(r,n);Object.defineProperty(this,"message",{get:function(){return r}}),Error.captureStackTrace?Error.captureStackTrace(this,e):Object.defineProperty(this,"stack",{value:new Error().stack||""}),n&&k0(this,n)}return e.prototype=Object.create(Error.prototype,{constructor:{value:e,writable:!0,enumerable:!1,configurable:!0},name:{get:function(){return t},set:void 0,enumerable:!1,configurable:!0},toString:{value:function(){return this.name+": "+this.message},writable:!0,enumerable:!1,configurable:!0}}),e}M.newError=P0;M.ProtocolError=P0("ProtocolError");M.oneOfGetter=function(e){for(var r={},n=0;n<e.length;++n)r[e[n]]=1;return function(){for(var i=Object.keys(this),a=i.length-1;a>-1;--a)if(r[i[a]]===1&&this[i[a]]!==void 0&&this[i[a]]!==null)return i[a]}};M.oneOfSetter=function(e){return function(r){for(var n=0;n<e.length;++n)e[n]!==r&&delete this[e[n]]}};M.toJSONOptions={longs:String,enums:String,bytes:String,json:!0};M._configure=function(){var t=M.Buffer;if(!t){M._Buffer_from=M._Buffer_allocUnsafe=null;return}M._Buffer_from=t.from!==Uint8Array.from&&t.from||function(r,n){return new t(r,n)},M._Buffer_allocUnsafe=t.allocUnsafe||function(r){return new t(r)}}});var pa=Q((y2,q0)=>{"use strict";q0.exports=At;var ee=je(),la,O0=ee.LongBits,zp=ee.utf8;function re(t,e){return RangeError("index out of range: "+t.pos+" + "+(e||1)+" > "+t.len)}function At(t){this.buf=t,this.pos=0,this.len=t.length}var U0=typeof Uint8Array<"u"?function(e){if(e instanceof Uint8Array||Array.isArray(e))return new At(e);throw Error("illegal buffer")}:function(e){if(Array.isArray(e))return new At(e);throw Error("illegal buffer")},M0=function(){return ee.Buffer?function(r){return(At.create=function(i){return ee.Buffer.isBuffer(i)?new la(i):U0(i)})(r)}:U0};At.create=M0();At.prototype._slice=ee.Array.prototype.subarray||ee.Array.prototype.slice;At.prototype.uint32=function(){var e=4294967295;return function(){if(e=(this.buf[this.pos]&127)>>>0,this.buf[this.pos++]<128||(e=(e|(this.buf[this.pos]&127)<<7)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<14)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<21)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&15)<<28)>>>0,this.buf[this.pos++]<128))return e;if((this.pos+=5)>this.len)throw this.pos=this.len,re(this,10);return e}}();At.prototype.int32=function(){return this.uint32()|0};At.prototype.sint32=function(){var e=this.uint32();return e>>>1^-(e&1)|0};function ha(){var t=new O0(0,0),e=0;if(this.len-this.pos>4){for(;e<4;++e)if(t.lo=(t.lo|(this.buf[this.pos]&127)<<e*7)>>>0,this.buf[this.pos++]<128)return t;if(t.lo=(t.lo|(this.buf[this.pos]&127)<<28)>>>0,t.hi=(t.hi|(this.buf[this.pos]&127)>>4)>>>0,this.buf[this.pos++]<128)return t;e=0}else{for(;e<3;++e){if(this.pos>=this.len)throw re(this);if(t.lo=(t.lo|(this.buf[this.pos]&127)<<e*7)>>>0,this.buf[this.pos++]<128)return t}return t.lo=(t.lo|(this.buf[this.pos++]&127)<<e*7)>>>0,t}if(this.len-this.pos>4){for(;e<5;++e)if(t.hi=(t.hi|(this.buf[this.pos]&127)<<e*7+3)>>>0,this.buf[this.pos++]<128)return t}else for(;e<5;++e){if(this.pos>=this.len)throw re(this);if(t.hi=(t.hi|(this.buf[this.pos]&127)<<e*7+3)>>>0,this.buf[this.pos++]<128)return t}throw Error("invalid varint encoding")}At.prototype.bool=function(){return this.uint32()!==0};function Fn(t,e){return(t[e-4]|t[e-3]<<8|t[e-2]<<16|t[e-1]<<24)>>>0}At.prototype.fixed32=function(){if(this.pos+4>this.len)throw re(this,4);return Fn(this.buf,this.pos+=4)};At.prototype.sfixed32=function(){if(this.pos+4>this.len)throw re(this,4);return Fn(this.buf,this.pos+=4)|0};function K0(){if(this.pos+8>this.len)throw re(this,8);return new O0(Fn(this.buf,this.pos+=4),Fn(this.buf,this.pos+=4))}At.prototype.float=function(){if(this.pos+4>this.len)throw re(this,4);var e=ee.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e};At.prototype.double=function(){if(this.pos+8>this.len)throw re(this,4);var e=ee.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e};At.prototype.bytes=function(){var e=this.uint32(),r=this.pos,n=this.pos+e;if(n>this.len)throw re(this,e);if(this.pos+=e,Array.isArray(this.buf))return this.buf.slice(r,n);if(r===n){var i=ee.Buffer;return i?i.alloc(0):new this.buf.constructor(0)}return this._slice.call(this.buf,r,n)};At.prototype.string=function(){var e=this.bytes();return zp.read(e,0,e.length)};At.prototype.skip=function(e){if(typeof e=="number"){if(this.pos+e>this.len)throw re(this,e);this.pos+=e}else do if(this.pos>=this.len)throw re(this);while(this.buf[this.pos++]&128);return this};At.prototype.skipType=function(t){switch(t){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(t=this.uint32()&7)!==4;)this.skipType(t);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+t+" at offset "+this.pos)}return this};At._configure=function(t){la=t,At.create=M0(),la._configure();var e=ee.Long?"toLong":"toNumber";ee.merge(At.prototype,{int64:function(){return ha.call(this)[e](!1)},uint64:function(){return ha.call(this)[e](!0)},sint64:function(){return ha.call(this).zzDecode()[e](!1)},fixed64:function(){return K0.call(this)[e](!0)},sfixed64:function(){return K0.call(this)[e](!1)}})}});var z0=Q((x2,H0)=>{"use strict";H0.exports=tr;var F0=pa();(tr.prototype=Object.create(F0.prototype)).constructor=tr;var V0=je();function tr(t){F0.call(this,t)}tr._configure=function(){V0.Buffer&&(tr.prototype._slice=V0.Buffer.prototype.slice)};tr.prototype.string=function(){var e=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+e,this.len))};tr._configure()});var ba=Q((g2,Z0)=>{"use strict";Z0.exports=nt;var Yt=je(),da,Hn=Yt.LongBits,G0=Yt.base64,W0=Yt.utf8;function Gr(t,e,r){this.fn=t,this.len=e,this.next=void 0,this.val=r}function xa(){}function Gp(t){this.head=t.head,this.tail=t.tail,this.len=t.len,this.next=t.states}function nt(){this.len=0,this.head=new Gr(xa,0,0),this.tail=this.head,this.states=null}var Y0=function(){return Yt.Buffer?function(){return(nt.create=function(){return new da})()}:function(){return new nt}};nt.create=Y0();nt.alloc=function(e){return new Yt.Array(e)};Yt.Array!==Array&&(nt.alloc=Yt.pool(nt.alloc,Yt.Array.prototype.subarray));nt.prototype._push=function(e,r,n){return this.tail=this.tail.next=new Gr(e,r,n),this.len+=r,this};function ga(t,e,r){e[r]=t&255}function Wp(t,e,r){for(;t>127;)e[r++]=t&127|128,t>>>=7;e[r]=t}function ma(t,e){this.len=t,this.next=void 0,this.val=e}ma.prototype=Object.create(Gr.prototype);ma.prototype.fn=Wp;nt.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new ma((e=e>>>0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this};nt.prototype.int32=function(e){return e<0?this._push(va,10,Hn.fromNumber(e)):this.uint32(e)};nt.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)};function va(t,e,r){for(;t.hi;)e[r++]=t.lo&127|128,t.lo=(t.lo>>>7|t.hi<<25)>>>0,t.hi>>>=7;for(;t.lo>127;)e[r++]=t.lo&127|128,t.lo=t.lo>>>7;e[r++]=t.lo}nt.prototype.uint64=function(e){var r=Hn.from(e);return this._push(va,r.length(),r)};nt.prototype.int64=nt.prototype.uint64;nt.prototype.sint64=function(e){var r=Hn.from(e).zzEncode();return this._push(va,r.length(),r)};nt.prototype.bool=function(e){return this._push(ga,1,e?1:0)};function ya(t,e,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24}nt.prototype.fixed32=function(e){return this._push(ya,4,e>>>0)};nt.prototype.sfixed32=nt.prototype.fixed32;nt.prototype.fixed64=function(e){var r=Hn.from(e);return this._push(ya,4,r.lo)._push(ya,4,r.hi)};nt.prototype.sfixed64=nt.prototype.fixed64;nt.prototype.float=function(e){return this._push(Yt.float.writeFloatLE,4,e)};nt.prototype.double=function(e){return this._push(Yt.float.writeDoubleLE,8,e)};var Yp=Yt.Array.prototype.set?function(e,r,n){r.set(e,n)}:function(e,r,n){for(var i=0;i<e.length;++i)r[n+i]=e[i]};nt.prototype.bytes=function(e){var r=e.length>>>0;if(!r)return this._push(ga,1,0);if(Yt.isString(e)){var n=nt.alloc(r=G0.length(e));G0.decode(e,n,0),e=n}return this.uint32(r)._push(Yp,r,e)};nt.prototype.string=function(e){var r=W0.length(e);return r?this.uint32(r)._push(W0.write,r,e):this._push(ga,1,0)};nt.prototype.fork=function(){return this.states=new Gp(this),this.head=this.tail=new Gr(xa,0,0),this.len=0,this};nt.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new Gr(xa,0,0),this.len=0),this};nt.prototype.ldelim=function(){var e=this.head,r=this.tail,n=this.len;return this.reset().uint32(n),n&&(this.tail.next=e.next,this.tail=r,this.len+=n),this};nt.prototype.finish=function(){for(var e=this.head.next,r=this.constructor.alloc(this.len),n=0;e;)e.fn(e.val,r,n),n+=e.len,e=e.next;return r};nt._configure=function(t){da=t,nt.create=Y0(),da._configure()}});var X0=Q((m2,Q0)=>{"use strict";Q0.exports=de;var $0=ba();(de.prototype=Object.create($0.prototype)).constructor=de;var Me=je();function de(){$0.call(this)}de._configure=function(){de.alloc=Me._Buffer_allocUnsafe,de.writeBytesBuffer=Me.Buffer&&Me.Buffer.prototype instanceof Uint8Array&&Me.Buffer.prototype.set.name==="set"?function(e,r,n){r.set(e,n)}:function(e,r,n){if(e.copy)e.copy(r,n,0,e.length);else for(var i=0;i<e.length;)r[n++]=e[i++]}};de.prototype.bytes=function(e){Me.isString(e)&&(e=Me._Buffer_from(e,"base64"));var r=e.length>>>0;return this.uint32(r),r&&this._push(de.writeBytesBuffer,r,e),this};function Zp(t,e,r){t.length<40?Me.utf8.write(t,e,r):e.utf8Write?e.utf8Write(t,r):e.write(t,r)}de.prototype.string=function(e){var r=Me.Buffer.byteLength(e);return this.uint32(r),r&&this._push(Zp,r,e),this};de._configure()});var xf=Q((cx,yf)=>{var pt=st();Ge();Bt();var Yr=yf.exports=pt.sha512=pt.sha512||{};pt.md.sha512=pt.md.algorithms.sha512=Yr;var pf=pt.sha384=pt.sha512.sha384=pt.sha512.sha384||{};pf.create=function(){return Yr.create("SHA-384")};pt.md.sha384=pt.md.algorithms.sha384=pf;pt.sha512.sha256=pt.sha512.sha256||{create:function(){return Yr.create("SHA-512/256")}};pt.md["sha512/256"]=pt.md.algorithms["sha512/256"]=pt.sha512.sha256;pt.sha512.sha224=pt.sha512.sha224||{create:function(){return Yr.create("SHA-512/224")}};pt.md["sha512/224"]=pt.md.algorithms["sha512/224"]=pt.sha512.sha224;Yr.create=function(t){if(df||id(),typeof t>"u"&&(t="SHA-512"),!(t in rr))throw new Error("Invalid SHA-512 algorithm: "+t);for(var e=rr[t],r=null,n=pt.util.createBuffer(),i=new Array(80),a=0;a<80;++a)i[a]=new Array(2);var s=64;switch(t){case"SHA-384":s=48;break;case"SHA-512/256":s=32;break;case"SHA-512/224":s=28;break}var o={algorithm:t.replace("-","").toLowerCase(),blockLength:128,digestLength:s,messageLength:0,fullMessageLength:null,messageLengthSize:16};return o.start=function(){o.messageLength=0,o.fullMessageLength=o.messageLength128=[];for(var f=o.messageLengthSize/4,c=0;c<f;++c)o.fullMessageLength.push(0);n=pt.util.createBuffer(),r=new Array(e.length);for(var c=0;c<e.length;++c)r[c]=e[c].slice(0);return o},o.start(),o.update=function(f,c){c==="utf8"&&(f=pt.util.encodeUtf8(f));var u=f.length;o.messageLength+=u,u=[u/4294967296>>>0,u>>>0];for(var h=o.fullMessageLength.length-1;h>=0;--h)o.fullMessageLength[h]+=u[1],u[1]=u[0]+(o.fullMessageLength[h]/4294967296>>>0),o.fullMessageLength[h]=o.fullMessageLength[h]>>>0,u[0]=u[1]/4294967296>>>0;return n.putBytes(f),lf(r,i,n),(n.read>2048||n.length()===0)&&n.compact(),o},o.digest=function(){var f=pt.util.createBuffer();f.putBytes(n.bytes());var c=o.fullMessageLength[o.fullMessageLength.length-1]+o.messageLengthSize,u=c&o.blockLength-1;f.putBytes(Ra.substr(0,o.blockLength-u));for(var h,l,x=o.fullMessageLength[0]*8,p=0;p<o.fullMessageLength.length-1;++p)h=o.fullMessageLength[p+1]*8,l=h/4294967296>>>0,x+=l,f.putInt32(x>>>0),x=h>>>0;f.putInt32(x);for(var d=new Array(r.length),p=0;p<r.length;++p)d[p]=r[p].slice(0);lf(d,i,f);var y=pt.util.createBuffer(),m;t==="SHA-512"?m=d.length:t==="SHA-384"?m=d.length-2:m=d.length-4;for(var p=0;p<m;++p)y.putInt32(d[p][0]),(p!==m-1||t!=="SHA-512/224")&&y.putInt32(d[p][1]);return y},o};var Ra=null,df=!1,La=null,rr=null;function id(){Ra=String.fromCharCode(128),Ra+=pt.util.fillString(String.fromCharCode(0),128),La=[[1116352408,3609767458],[1899447441,602891725],[3049323471,3964484399],[3921009573,2173295548],[961987163,4081628472],[1508970993,3053834265],[2453635748,2937671579],[2870763221,3664609560],[3624381080,2734883394],[310598401,1164996542],[607225278,1323610764],[1426881987,3590304994],[1925078388,4068182383],[2162078206,991336113],[2614888103,633803317],[3248222580,3479774868],[3835390401,2666613458],[4022224774,944711139],[264347078,2341262773],[604807628,2007800933],[770255983,1495990901],[1249150122,1856431235],[1555081692,3175218132],[1996064986,2198950837],[2554220882,3999719339],[2821834349,766784016],[2952996808,2566594879],[3210313671,3203337956],[3336571891,1034457026],[3584528711,2466948901],[113926993,3758326383],[338241895,168717936],[666307205,1188179964],[773529912,1546045734],[1294757372,1522805485],[1396182291,2643833823],[1695183700,2343527390],[1986661051,1014477480],[2177026350,1206759142],[2456956037,344077627],[2730485921,1290863460],[2820302411,3158454273],[3259730800,3505952657],[3345764771,106217008],[3516065817,3606008344],[3600352804,1432725776],[4094571909,1467031594],[275423344,851169720],[430227734,3100823752],[506948616,1363258195],[659060556,3750685593],[883997877,3785050280],[958139571,3318307427],[1322822218,3812723403],[1537002063,2003034995],[1747873779,3602036899],[1955562222,1575990012],[2024104815,1125592928],[2227730452,2716904306],[2361852424,442776044],[2428436474,593698344],[2756734187,3733110249],[3204031479,2999351573],[3329325298,3815920427],[3391569614,3928383900],[3515267271,566280711],[3940187606,3454069534],[4118630271,4000239992],[116418474,1914138554],[174292421,2731055270],[289380356,3203993006],[460393269,320620315],[685471733,587496836],[852142971,1086792851],[1017036298,365543100],[1126000580,2618297676],[1288033470,3409855158],[1501505948,4234509866],[1607167915,987167468],[1816402316,1246189591]],rr={},rr["SHA-512"]=[[1779033703,4089235720],[3144134277,2227873595],[1013904242,4271175723],[2773480762,1595750129],[1359893119,2917565137],[2600822924,725511199],[528734635,4215389547],[1541459225,327033209]],rr["SHA-384"]=[[3418070365,3238371032],[1654270250,914150663],[2438529370,812702999],[355462360,4144912697],[1731405415,4290775857],[2394180231,1750603025],[3675008525,1694076839],[1203062813,3204075428]],rr["SHA-512/256"]=[[573645204,4230739756],[2673172387,3360449730],[596883563,1867755857],[2520282905,1497426621],[2519219938,2827943907],[3193839141,1401305490],[721525244,746961066],[246885852,2177182882]],rr["SHA-512/224"]=[[2352822216,424955298],[1944164710,2312950998],[502970286,855612546],[1738396948,1479516111],[258812777,2077511080],[2011393907,79989058],[1067287976,1780299464],[286451373,2446758561]],df=!0}function lf(t,e,r){for(var n,i,a,s,o,f,c,u,h,l,x,p,d,y,m,E,b,R,w,B,L,D,G,z,V,J,ft,kt,T,k,_,N,A,K,O,F=r.length();F>=128;){for(T=0;T<16;++T)e[T][0]=r.getInt32()>>>0,e[T][1]=r.getInt32()>>>0;for(;T<80;++T)N=e[T-2],k=N[0],_=N[1],n=((k>>>19|_<<13)^(_>>>29|k<<3)^k>>>6)>>>0,i=((k<<13|_>>>19)^(_<<3|k>>>29)^(k<<26|_>>>6))>>>0,K=e[T-15],k=K[0],_=K[1],a=((k>>>1|_<<31)^(k>>>8|_<<24)^k>>>7)>>>0,s=((k<<31|_>>>1)^(k<<24|_>>>8)^(k<<25|_>>>7))>>>0,A=e[T-7],O=e[T-16],_=i+A[1]+s+O[1],e[T][0]=n+A[0]+a+O[0]+(_/4294967296>>>0)>>>0,e[T][1]=_>>>0;for(d=t[0][0],y=t[0][1],m=t[1][0],E=t[1][1],b=t[2][0],R=t[2][1],w=t[3][0],B=t[3][1],L=t[4][0],D=t[4][1],G=t[5][0],z=t[5][1],V=t[6][0],J=t[6][1],ft=t[7][0],kt=t[7][1],T=0;T<80;++T)c=((L>>>14|D<<18)^(L>>>18|D<<14)^(D>>>9|L<<23))>>>0,u=((L<<18|D>>>14)^(L<<14|D>>>18)^(D<<23|L>>>9))>>>0,h=(V^L&(G^V))>>>0,l=(J^D&(z^J))>>>0,o=((d>>>28|y<<4)^(y>>>2|d<<30)^(y>>>7|d<<25))>>>0,f=((d<<4|y>>>28)^(y<<30|d>>>2)^(y<<25|d>>>7))>>>0,x=(d&m|b&(d^m))>>>0,p=(y&E|R&(y^E))>>>0,_=kt+u+l+La[T][1]+e[T][1],n=ft+c+h+La[T][0]+e[T][0]+(_/4294967296>>>0)>>>0,i=_>>>0,_=f+p,a=o+x+(_/4294967296>>>0)>>>0,s=_>>>0,ft=V,kt=J,V=G,J=z,G=L,z=D,_=B+i,L=w+n+(_/4294967296>>>0)>>>0,D=_>>>0,w=b,B=R,b=m,R=E,m=d,E=y,_=i+s,d=n+a+(_/4294967296>>>0)>>>0,y=_>>>0;_=t[0][1]+y,t[0][0]=t[0][0]+d+(_/4294967296>>>0)>>>0,t[0][1]=_>>>0,_=t[1][1]+E,t[1][0]=t[1][0]+m+(_/4294967296>>>0)>>>0,t[1][1]=_>>>0,_=t[2][1]+R,t[2][0]=t[2][0]+b+(_/4294967296>>>0)>>>0,t[2][1]=_>>>0,_=t[3][1]+B,t[3][0]=t[3][0]+w+(_/4294967296>>>0)>>>0,t[3][1]=_>>>0,_=t[4][1]+D,t[4][0]=t[4][0]+L+(_/4294967296>>>0)>>>0,t[4][1]=_>>>0,_=t[5][1]+z,t[5][0]=t[5][0]+G+(_/4294967296>>>0)>>>0,t[5][1]=_>>>0,_=t[6][1]+J,t[6][0]=t[6][0]+V+(_/4294967296>>>0)>>>0,t[6][1]=_>>>0,_=t[7][1]+kt,t[7][0]=t[7][0]+ft+(_/4294967296>>>0)>>>0,t[7][1]=_>>>0,F-=128}}});var Ud={};vt(Ud,{aes:()=>Ni,hmac:()=>un,keys:()=>Ha,pbkdf2:()=>za,randomBytes:()=>Cr});var Ni={};vt(Ni,{create:()=>gu});var H=class extends Error{code;props;constructor(e,r,n){super(e),this.code=r,this.name=n?.name??"CodeError",this.props=n??{}}};var to={16:"aes-128-ctr",32:"aes-256-ctr"};function eo(t){if(t.length===16||t.length===32)return to[t.length];let e=Object.entries(to).map(([r,n])=>`${r} (${n})`).join(" / ");throw new H(`Invalid key length ${t.length} bytes. Must be ${e}`,"ERR_INVALID_KEY_LENGTH")}var M1=bt(an(),1),Pr=bt(st(),1);function sr(t){return globalThis.Buffer!=null?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t}var di={};vt(di,{base10:()=>xc});function hc(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<t.length;i++){var a=t.charAt(i),s=a.charCodeAt(0);if(r[s]!==255)throw new TypeError(a+" is ambiguous");r[s]=i}var o=t.length,f=t.charAt(0),c=Math.log(o)/Math.log(256),u=Math.log(256)/Math.log(o);function h(p){if(p instanceof Uint8Array||(ArrayBuffer.isView(p)?p=new Uint8Array(p.buffer,p.byteOffset,p.byteLength):Array.isArray(p)&&(p=Uint8Array.from(p))),!(p instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(p.length===0)return"";for(var d=0,y=0,m=0,E=p.length;m!==E&&p[m]===0;)m++,d++;for(var b=(E-m)*u+1>>>0,R=new Uint8Array(b);m!==E;){for(var w=p[m],B=0,L=b-1;(w!==0||B<y)&&L!==-1;L--,B++)w+=256*R[L]>>>0,R[L]=w%o>>>0,w=w/o>>>0;if(w!==0)throw new Error("Non-zero carry");y=B,m++}for(var D=b-y;D!==b&&R[D]===0;)D++;for(var G=f.repeat(d);D<b;++D)G+=t.charAt(R[D]);return G}function l(p){if(typeof p!="string")throw new TypeError("Expected String");if(p.length===0)return new Uint8Array;var d=0;if(p[d]!==" "){for(var y=0,m=0;p[d]===f;)y++,d++;for(var E=(p.length-d)*c+1>>>0,b=new Uint8Array(E);p[d];){var R=r[p.charCodeAt(d)];if(R===255)return;for(var w=0,B=E-1;(R!==0||w<m)&&B!==-1;B--,w++)R+=o*b[B]>>>0,b[B]=R%256>>>0,R=R/256>>>0;if(R!==0)throw new Error("Non-zero carry");m=w,d++}if(p[d]!==" "){for(var L=E-m;L!==E&&b[L]===0;)L++;for(var D=new Uint8Array(y+(E-L)),G=y;L!==E;)D[G++]=b[L++];return D}}}function x(p){var d=l(p);if(d)return d;throw new Error(`Non-${e} character`)}return{encode:h,decodeUnsafe:l,decode:x}}var lc=hc,pc=lc,go=pc;var $d=new Uint8Array(0);var mo=(t,e)=>{if(t===e)return!0;if(t.byteLength!==e.byteLength)return!1;for(let r=0;r<t.byteLength;r++)if(t[r]!==e[r])return!1;return!0},ge=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")};var vo=t=>new TextEncoder().encode(t),bo=t=>new TextDecoder().decode(t);var ui=class{constructor(e,r,n){this.name=e,this.prefix=r,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},hi=class{constructor(e,r,n){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return wo(this,e)}},li=class{constructor(e){this.decoders=e}or(e){return wo(this,e)}decode(e){let r=e[0],n=this.decoders[r];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}},wo=(t,e)=>new li({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}}),pi=class{constructor(e,r,n,i){this.name=e,this.prefix=r,this.baseEncode=n,this.baseDecode=i,this.encoder=new ui(e,r,n),this.decoder=new hi(e,r,i)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}},fr=({name:t,prefix:e,encode:r,decode:n})=>new pi(t,e,r,n),Le=({prefix:t,name:e,alphabet:r})=>{let{encode:n,decode:i}=go(r,e);return fr({prefix:t,name:e,encode:n,decode:a=>ge(i(a))})},dc=(t,e,r,n)=>{let i={};for(let u=0;u<e.length;++u)i[e[u]]=u;let a=t.length;for(;t[a-1]==="=";)--a;let s=new Uint8Array(a*r/8|0),o=0,f=0,c=0;for(let u=0;u<a;++u){let h=i[t[u]];if(h===void 0)throw new SyntaxError(`Non-${n} character`);f=f<<r|h,o+=r,o>=8&&(o-=8,s[c++]=255&f>>o)}if(o>=r||255&f<<8-o)throw new SyntaxError("Unexpected end of data");return s},yc=(t,e,r)=>{let n=e[e.length-1]==="=",i=(1<<r)-1,a="",s=0,o=0;for(let f=0;f<t.length;++f)for(o=o<<8|t[f],s+=8;s>r;)s-=r,a+=e[i&o>>s];if(s&&(a+=e[i&o<<r-s]),n)for(;a.length*r&7;)a+="=";return a},Et=({name:t,prefix:e,bitsPerChar:r,alphabet:n})=>fr({prefix:e,name:t,encode(i){return yc(i,n,r)},decode(i){return dc(i,n,r,t)}});var xc=Le({prefix:"9",name:"base10",alphabet:"0123456789"});var yi={};vt(yi,{base16:()=>gc,base16upper:()=>mc});var gc=Et({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),mc=Et({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var xi={};vt(xi,{base2:()=>vc});var vc=Et({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var gi={};vt(gi,{base256emoji:()=>Sc});var Bo=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),bc=Bo.reduce((t,e,r)=>(t[r]=e,t),[]),Ec=Bo.reduce((t,e,r)=>(t[e.codePointAt(0)]=r,t),[]);function wc(t){return t.reduce((e,r)=>(e+=bc[r],e),"")}function Bc(t){let e=[];for(let r of t){let n=Ec[r.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${r}`);e.push(n)}return new Uint8Array(e)}var Sc=fr({prefix:"\u{1F680}",name:"base256emoji",encode:wc,decode:Bc});var mi={};vt(mi,{base32:()=>cr,base32hex:()=>Ic,base32hexpad:()=>Rc,base32hexpadupper:()=>Lc,base32hexupper:()=>_c,base32pad:()=>Cc,base32padupper:()=>Tc,base32upper:()=>Ac,base32z:()=>Dc});var cr=Et({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Ac=Et({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Cc=Et({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Tc=Et({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Ic=Et({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),_c=Et({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Rc=Et({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Lc=Et({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Dc=Et({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var vi={};vt(vi,{base36:()=>Nc,base36upper:()=>kc});var Nc=Le({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),kc=Le({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var bi={};vt(bi,{base58btc:()=>zt,base58flickr:()=>Pc});var zt=Le({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Pc=Le({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var Ei={};vt(Ei,{base64:()=>Rr,base64pad:()=>Uc,base64url:()=>Kc,base64urlpad:()=>Oc});var Rr=Et({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Uc=Et({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Kc=Et({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Oc=Et({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var wi={};vt(wi,{base8:()=>Mc});var Mc=Et({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var Bi={};vt(Bi,{identity:()=>qc});var qc=fr({prefix:"\0",name:"identity",encode:t=>bo(t),decode:t=>vo(t)});var u1=new TextEncoder,h1=new TextDecoder;var Ci={};vt(Ci,{identity:()=>Ai});var Hc=Co,So=128,zc=127,Gc=~zc,Wc=Math.pow(2,31);function Co(t,e,r){e=e||[],r=r||0;for(var n=r;t>=Wc;)e[r++]=t&255|So,t/=128;for(;t&Gc;)e[r++]=t&255|So,t>>>=7;return e[r]=t|0,Co.bytes=r-n+1,e}var Yc=Si,Zc=128,Ao=127;function Si(t,n){var r=0,n=n||0,i=0,a=n,s,o=t.length;do{if(a>=o)throw Si.bytes=0,new RangeError("Could not decode varint");s=t[a++],r+=i<28?(s&Ao)<<i:(s&Ao)*Math.pow(2,i),i+=7}while(s>=Zc);return Si.bytes=a-n,r}var $c=Math.pow(2,7),Qc=Math.pow(2,14),Xc=Math.pow(2,21),Jc=Math.pow(2,28),jc=Math.pow(2,35),tu=Math.pow(2,42),eu=Math.pow(2,49),ru=Math.pow(2,56),nu=Math.pow(2,63),iu=function(t){return t<$c?1:t<Qc?2:t<Xc?3:t<Jc?4:t<jc?5:t<tu?6:t<eu?7:t<ru?8:t<nu?9:10},au={encode:Hc,decode:Yc,encodingLength:iu},ou=au,Lr=ou;var Dr=(t,e=0)=>[Lr.decode(t,e),Lr.decode.bytes],ur=(t,e,r=0)=>(Lr.encode(t,e,r),e),hr=t=>Lr.encodingLength(t);var ze=(t,e)=>{let r=e.byteLength,n=hr(t),i=n+hr(r),a=new Uint8Array(i+r);return ur(t,a,0),ur(r,a,n),a.set(e,i),new lr(t,r,e,a)},To=t=>{let e=ge(t),[r,n]=Dr(e),[i,a]=Dr(e.subarray(n)),s=e.subarray(n+a);if(s.byteLength!==i)throw new Error("Incorrect length");return new lr(r,i,s,e)},Io=(t,e)=>{if(t===e)return!0;{let r=e;return t.code===r.code&&t.size===r.size&&r.bytes instanceof Uint8Array&&mo(t.bytes,r.bytes)}},lr=class{constructor(e,r,n,i){this.code=e,this.size=r,this.digest=n,this.bytes=i}};var _o=0,su="identity",Ro=ge,fu=t=>ze(_o,Ro(t)),Ai={code:_o,name:su,encode:Ro,digest:fu};var _i={};vt(_i,{sha256:()=>Vt,sha512:()=>cu});var Ii=({name:t,code:e,encode:r})=>new Ti(t,e,r),Ti=class{constructor(e,r,n){this.name=e,this.code=r,this.encode=n}digest(e){if(e instanceof Uint8Array){let r=this.encode(e);return r instanceof Uint8Array?ze(this.code,r):r.then(n=>ze(this.code,n))}else throw Error("Unknown type, must be binary type")}};var Do=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),Vt=Ii({name:"sha2-256",code:18,encode:Do("SHA-256")}),cu=Ii({name:"sha2-512",code:19,encode:Do("SHA-512")});var No=(t,e)=>{let{bytes:r,version:n}=t;switch(n){case 0:return hu(r,Ri(t),e||zt.encoder);default:return lu(r,Ri(t),e||cr.encoder)}};var ko=new WeakMap,Ri=t=>{let e=ko.get(t);if(e==null){let r=new Map;return ko.set(t,r),r}return e},sn=class t{constructor(e,r,n,i){this.code=r,this.version=e,this.multihash=n,this.bytes=i,this["/"]=i}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{let{code:e,multihash:r}=this;if(e!==kr)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(r.code!==pu)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return t.createV0(r)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{let{code:e,digest:r}=this.multihash,n=ze(e,r);return t.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return t.equals(this,e)}static equals(e,r){let n=r;return n&&e.code===n.code&&e.version===n.version&&Io(e.multihash,n.multihash)}toString(e){return No(this,e)}toJSON(){return{"/":No(this)}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(e==null)return null;let r=e;if(r instanceof t)return r;if(r["/"]!=null&&r["/"]===r.bytes||r.asCID===r){let{version:n,code:i,multihash:a,bytes:s}=r;return new t(n,i,a,s||Po(n,i,a.bytes))}else if(r[du]===!0){let{version:n,multihash:i,code:a}=r,s=To(i);return t.create(n,a,s)}else return null}static create(e,r,n){if(typeof r!="number")throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:{if(r!==kr)throw new Error(`Version 0 CID must use dag-pb (code: ${kr}) block encoding`);return new t(e,r,n,n.bytes)}case 1:{let i=Po(e,r,n.bytes);return new t(e,r,n,i)}default:throw new Error("Invalid version")}}static createV0(e){return t.create(0,kr,e)}static createV1(e,r){return t.create(1,e,r)}static decode(e){let[r,n]=t.decodeFirst(e);if(n.length)throw new Error("Incorrect length");return r}static decodeFirst(e){let r=t.inspectBytes(e),n=r.size-r.multihashSize,i=ge(e.subarray(n,n+r.multihashSize));if(i.byteLength!==r.multihashSize)throw new Error("Incorrect length");let a=i.subarray(r.multihashSize-r.digestSize),s=new lr(r.multihashCode,r.digestSize,a,i);return[r.version===0?t.createV0(s):t.createV1(r.codec,s),e.subarray(r.size)]}static inspectBytes(e){let r=0,n=()=>{let[h,l]=Dr(e.subarray(r));return r+=l,h},i=n(),a=kr;if(i===18?(i=0,r=0):a=n(),i!==0&&i!==1)throw new RangeError(`Invalid CID version ${i}`);let s=r,o=n(),f=n(),c=r+f,u=c-s;return{version:i,codec:a,multihashCode:o,digestSize:f,multihashSize:u,size:c}}static parse(e,r){let[n,i]=uu(e,r),a=t.decode(i);if(a.version===0&&e[0]!=="Q")throw Error("Version 0 CID string must not include multibase prefix");return Ri(a).set(n,e),a}},uu=(t,e)=>{switch(t[0]){case"Q":{let r=e||zt;return[zt.prefix,r.decode(`${zt.prefix}${t}`)]}case zt.prefix:{let r=e||zt;return[zt.prefix,r.decode(t)]}case cr.prefix:{let r=e||cr;return[cr.prefix,r.decode(t)]}default:{if(e==null)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[t[0],e.decode(t)]}}},hu=(t,e,r)=>{let{prefix:n}=r;if(n!==zt.prefix)throw Error(`Cannot string encode V0 in ${r.name} encoding`);let i=e.get(n);if(i==null){let a=r.encode(t).slice(1);return e.set(n,a),a}else return i},lu=(t,e,r)=>{let{prefix:n}=r,i=e.get(n);if(i==null){let a=r.encode(t);return e.set(n,a),a}else return i},kr=112,pu=18,Po=(t,e,r)=>{let n=hr(t),i=n+hr(e),a=new Uint8Array(i+r.byteLength);return ur(t,a,0),ur(e,a,n),a.set(r,i),a},du=Symbol.for("@ipld/js-cid/CID");var Li={...Bi,...xi,...wi,...di,...yi,...mi,...vi,...bi,...Ei,...gi},T1={..._i,...Ci};function fn(t=0){return globalThis.Buffer?.allocUnsafe!=null?sr(globalThis.Buffer.allocUnsafe(t)):new Uint8Array(t)}function Ko(t,e,r,n){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:r},decoder:{decode:n}}}var Uo=Ko("utf8","u",t=>"u"+new TextDecoder("utf8").decode(t),t=>new TextEncoder().encode(t.substring(1))),Di=Ko("ascii","a",t=>{let e="a";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e},t=>{t=t.substring(1);let e=fn(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}),yu={utf8:Uo,"utf-8":Uo,hex:Li.base16,latin1:Di,ascii:Di,binary:Di,...Li},cn=yu;function Lt(t,e="utf8"){let r=cn[e];if(r==null)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?sr(globalThis.Buffer.from(t,"utf-8")):r.decoder.decode(`${r.prefix}${t}`)}function gt(t,e="utf8"){let r=cn[e];if(r==null)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t.buffer,t.byteOffset,t.byteLength).toString("utf8"):r.encoder.encode(t).substring(1)}function Oo(t,e,r){let n=Pr.default.cipher.createCipher("AES-CTR",gt(e,"ascii"));return n.start({iv:gt(r,"ascii")}),{update:i=>(n.update(Pr.default.util.createBuffer(gt(i,"ascii"))),Lt(n.output.getBytes(),"ascii"))}}function Mo(t,e,r){let n=Pr.default.cipher.createDecipher("AES-CTR",gt(e,"ascii"));return n.start({iv:gt(r,"ascii")}),{update:i=>(n.update(Pr.default.util.createBuffer(gt(i,"ascii"))),Lt(n.output.getBytes(),"ascii"))}}async function gu(t,e){let r=eo(t),n=Oo(r,t,e),i=Mo(r,t,e);return{async encrypt(s){return n.update(s)},async decrypt(s){return i.update(s)}}}var un={};vt(un,{create:()=>ki});var St={get(t=globalThis){let e=t.crypto;if(e==null||e.subtle==null)throw Object.assign(new Error("Missing Web Crypto API. The most likely cause of this error is that this page is being accessed from an insecure context (i.e. not HTTPS). For more information and possible resolutions see https://github.com/libp2p/js-libp2p-crypto/blob/master/README.md#web-crypto-api"),{code:"ERR_MISSING_WEB_CRYPTO"});return e}};var qo={SHA1:20,SHA256:32,SHA512:64};var mu={SHA1:"SHA-1",SHA256:"SHA-256",SHA512:"SHA-512"},vu=async(t,e)=>{let r=await St.get().subtle.sign({name:"HMAC"},t,e);return new Uint8Array(r,0,r.byteLength)};async function ki(t,e){let r=mu[t],n=await St.get().subtle.importKey("raw",e,{name:"HMAC",hash:{name:r}},!1,["sign"]);return{async digest(i){return vu(n,i)},length:qo[t]}}var Ha={};vt(Ha,{generateEphemeralKeyPair:()=>ff,generateKeyPair:()=>Rd,generateKeyPairFromSeed:()=>Ld,importKey:()=>Pd,keyStretcher:()=>hf,keysPBM:()=>Sr,marshalPrivateKey:()=>kd,marshalPublicKey:()=>Nd,supportedKeys:()=>ye,unmarshalPrivateKey:()=>qf,unmarshalPublicKey:()=>Dd});var ug=bt(Or(),1),hg=bt(Vs(),1);var Xn=bt(st(),1);var Ia={};vt(Ia,{Ed25519PrivateKey:()=>er,Ed25519PublicKey:()=>Wr,generateKeyPair:()=>td,generateKeyPairFromSeed:()=>Ta,unmarshalEd25519PrivateKey:()=>Jp,unmarshalEd25519PublicKey:()=>jp});function Xt(t,e){if(t===e)return!0;if(t.byteLength!==e.byteLength)return!1;for(let r=0;r<t.byteLength;r++)if(t[r]!==e[r])return!1;return!0}function Fs(t){if(!Number.isSafeInteger(t)||t<0)throw new Error(`Wrong positive integer: ${t}`)}function Wi(t,...e){if(!(t instanceof Uint8Array))throw new Error("Expected Uint8Array");if(e.length>0&&!e.includes(t.length))throw new Error(`Expected Uint8Array of length ${e}, not of length=${t.length}`)}function Hs(t){if(typeof t!="function"||typeof t.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");Fs(t.outputLen),Fs(t.blockLen)}function yr(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function zs(t,e){Wi(t);let r=e.outputLen;if(t.length<r)throw new Error(`digestInto() expects output buffer of length at least ${r}`)}var An=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;var Gs=t=>t instanceof Uint8Array;var Cn=t=>new DataView(t.buffer,t.byteOffset,t.byteLength),Jt=(t,e)=>t<<32-e|t>>>e,Kl=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!Kl)throw new Error("Non little-endian hardware is not supported");function Yi(t){if(typeof t!="string")throw new Error(`utf8ToBytes expected string, got ${typeof t}`);return new Uint8Array(new TextEncoder().encode(t))}function Vr(t){if(typeof t=="string"&&(t=Yi(t)),!Gs(t))throw new Error(`expected Uint8Array, got ${typeof t}`);return t}function Tn(...t){let e=new Uint8Array(t.reduce((n,i)=>n+i.length,0)),r=0;return t.forEach(n=>{if(!Gs(n))throw new Error("Uint8Array expected");e.set(n,r),r+=n.length}),e}var xr=class{clone(){return this._cloneInto()}},xy={}.toString;function In(t){let e=n=>t().update(Vr(n)).digest(),r=t();return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=()=>t(),e}function gr(t=32){if(An&&typeof An.getRandomValues=="function")return An.getRandomValues(new Uint8Array(t));throw new Error("crypto.getRandomValues must be defined")}function Ol(t,e,r,n){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,r,n);let i=BigInt(32),a=BigInt(4294967295),s=Number(r>>i&a),o=Number(r&a),f=n?4:0,c=n?0:4;t.setUint32(e+f,s,n),t.setUint32(e+c,o,n)}var mr=class extends xr{constructor(e,r,n,i){super(),this.blockLen=e,this.outputLen=r,this.padOffset=n,this.isLE=i,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=Cn(this.buffer)}update(e){yr(this);let{view:r,buffer:n,blockLen:i}=this;e=Vr(e);let a=e.length;for(let s=0;s<a;){let o=Math.min(i-this.pos,a-s);if(o===i){let f=Cn(e);for(;i<=a-s;s+=i)this.process(f,s);continue}n.set(e.subarray(s,s+o),this.pos),this.pos+=o,s+=o,this.pos===i&&(this.process(r,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){yr(this),zs(e,this),this.finished=!0;let{buffer:r,view:n,blockLen:i,isLE:a}=this,{pos:s}=this;r[s++]=128,this.buffer.subarray(s).fill(0),this.padOffset>i-s&&(this.process(n,0),s=0);for(let h=s;h<i;h++)r[h]=0;Ol(n,i-8,BigInt(this.length*8),a),this.process(n,0);let o=Cn(e),f=this.outputLen;if(f%4)throw new Error("_sha2: outputLen should be aligned to 32bit");let c=f/4,u=this.get();if(c>u.length)throw new Error("_sha2: outputLen bigger than state");for(let h=0;h<c;h++)o.setUint32(4*h,u[h],a)}digest(){let{buffer:e,outputLen:r}=this;this.digestInto(e);let n=e.slice(0,r);return this.destroy(),n}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());let{blockLen:r,buffer:n,length:i,finished:a,destroyed:s,pos:o}=this;return e.length=i,e.pos=o,e.finished=a,e.destroyed=s,i%r&&e.buffer.set(n),e}};var _n=BigInt(4294967295),Zi=BigInt(32);function Ws(t,e=!1){return e?{h:Number(t&_n),l:Number(t>>Zi&_n)}:{h:Number(t>>Zi&_n)|0,l:Number(t&_n)|0}}function Ml(t,e=!1){let r=new Uint32Array(t.length),n=new Uint32Array(t.length);for(let i=0;i<t.length;i++){let{h:a,l:s}=Ws(t[i],e);[r[i],n[i]]=[a,s]}return[r,n]}var ql=(t,e)=>BigInt(t>>>0)<<Zi|BigInt(e>>>0),Vl=(t,e,r)=>t>>>r,Fl=(t,e,r)=>t<<32-r|e>>>r,Hl=(t,e,r)=>t>>>r|e<<32-r,zl=(t,e,r)=>t<<32-r|e>>>r,Gl=(t,e,r)=>t<<64-r|e>>>r-32,Wl=(t,e,r)=>t>>>r-32|e<<64-r,Yl=(t,e)=>e,Zl=(t,e)=>t,$l=(t,e,r)=>t<<r|e>>>32-r,Ql=(t,e,r)=>e<<r|t>>>32-r,Xl=(t,e,r)=>e<<r-32|t>>>64-r,Jl=(t,e,r)=>t<<r-32|e>>>64-r;function jl(t,e,r,n){let i=(e>>>0)+(n>>>0);return{h:t+r+(i/2**32|0)|0,l:i|0}}var tp=(t,e,r)=>(t>>>0)+(e>>>0)+(r>>>0),ep=(t,e,r,n)=>e+r+n+(t/2**32|0)|0,rp=(t,e,r,n)=>(t>>>0)+(e>>>0)+(r>>>0)+(n>>>0),np=(t,e,r,n,i)=>e+r+n+i+(t/2**32|0)|0,ip=(t,e,r,n,i)=>(t>>>0)+(e>>>0)+(r>>>0)+(n>>>0)+(i>>>0),ap=(t,e,r,n,i,a)=>e+r+n+i+a+(t/2**32|0)|0;var op={fromBig:Ws,split:Ml,toBig:ql,shrSH:Vl,shrSL:Fl,rotrSH:Hl,rotrSL:zl,rotrBH:Gl,rotrBL:Wl,rotr32H:Yl,rotr32L:Zl,rotlSH:$l,rotlSL:Ql,rotlBH:Xl,rotlBL:Jl,add:jl,add3L:tp,add3H:ep,add4L:rp,add4H:np,add5H:ap,add5L:ip},Z=op;var[sp,fp]=(()=>Z.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(t=>BigInt(t))))(),ke=new Uint32Array(80),Pe=new Uint32Array(80),$i=class extends mr{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){let{Ah:e,Al:r,Bh:n,Bl:i,Ch:a,Cl:s,Dh:o,Dl:f,Eh:c,El:u,Fh:h,Fl:l,Gh:x,Gl:p,Hh:d,Hl:y}=this;return[e,r,n,i,a,s,o,f,c,u,h,l,x,p,d,y]}set(e,r,n,i,a,s,o,f,c,u,h,l,x,p,d,y){this.Ah=e|0,this.Al=r|0,this.Bh=n|0,this.Bl=i|0,this.Ch=a|0,this.Cl=s|0,this.Dh=o|0,this.Dl=f|0,this.Eh=c|0,this.El=u|0,this.Fh=h|0,this.Fl=l|0,this.Gh=x|0,this.Gl=p|0,this.Hh=d|0,this.Hl=y|0}process(e,r){for(let b=0;b<16;b++,r+=4)ke[b]=e.getUint32(r),Pe[b]=e.getUint32(r+=4);for(let b=16;b<80;b++){let R=ke[b-15]|0,w=Pe[b-15]|0,B=Z.rotrSH(R,w,1)^Z.rotrSH(R,w,8)^Z.shrSH(R,w,7),L=Z.rotrSL(R,w,1)^Z.rotrSL(R,w,8)^Z.shrSL(R,w,7),D=ke[b-2]|0,G=Pe[b-2]|0,z=Z.rotrSH(D,G,19)^Z.rotrBH(D,G,61)^Z.shrSH(D,G,6),V=Z.rotrSL(D,G,19)^Z.rotrBL(D,G,61)^Z.shrSL(D,G,6),J=Z.add4L(L,V,Pe[b-7],Pe[b-16]),ft=Z.add4H(J,B,z,ke[b-7],ke[b-16]);ke[b]=ft|0,Pe[b]=J|0}let{Ah:n,Al:i,Bh:a,Bl:s,Ch:o,Cl:f,Dh:c,Dl:u,Eh:h,El:l,Fh:x,Fl:p,Gh:d,Gl:y,Hh:m,Hl:E}=this;for(let b=0;b<80;b++){let R=Z.rotrSH(h,l,14)^Z.rotrSH(h,l,18)^Z.rotrBH(h,l,41),w=Z.rotrSL(h,l,14)^Z.rotrSL(h,l,18)^Z.rotrBL(h,l,41),B=h&x^~h&d,L=l&p^~l&y,D=Z.add5L(E,w,L,fp[b],Pe[b]),G=Z.add5H(D,m,R,B,sp[b],ke[b]),z=D|0,V=Z.rotrSH(n,i,28)^Z.rotrBH(n,i,34)^Z.rotrBH(n,i,39),J=Z.rotrSL(n,i,28)^Z.rotrBL(n,i,34)^Z.rotrBL(n,i,39),ft=n&a^n&o^a&o,kt=i&s^i&f^s&f;m=d|0,E=y|0,d=x|0,y=p|0,x=h|0,p=l|0,{h,l}=Z.add(c|0,u|0,G|0,z|0),c=o|0,u=f|0,o=a|0,f=s|0,a=n|0,s=i|0;let T=Z.add3L(z,J,kt);n=Z.add3H(T,G,V,ft),i=T|0}({h:n,l:i}=Z.add(this.Ah|0,this.Al|0,n|0,i|0)),{h:a,l:s}=Z.add(this.Bh|0,this.Bl|0,a|0,s|0),{h:o,l:f}=Z.add(this.Ch|0,this.Cl|0,o|0,f|0),{h:c,l:u}=Z.add(this.Dh|0,this.Dl|0,c|0,u|0),{h,l}=Z.add(this.Eh|0,this.El|0,h|0,l|0),{h:x,l:p}=Z.add(this.Fh|0,this.Fl|0,x|0,p|0),{h:d,l:y}=Z.add(this.Gh|0,this.Gl|0,d|0,y|0),{h:m,l:E}=Z.add(this.Hh|0,this.Hl|0,m|0,E|0),this.set(n,i,a,s,o,f,c,u,h,l,x,p,d,y,m,E)}roundClean(){ke.fill(0),Pe.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}};var Qi=In(()=>new $i);var Dn={};vt(Dn,{bitGet:()=>yp,bitLen:()=>dp,bitMask:()=>Fr,bitSet:()=>xp,bytesToHex:()=>Ee,bytesToNumberBE:()=>we,bytesToNumberLE:()=>Ue,concatBytes:()=>Be,createHmacDrbg:()=>ji,ensureBytes:()=>wt,equalBytes:()=>lp,hexToBytes:()=>$e,hexToNumber:()=>Ji,numberToBytesBE:()=>Ke,numberToBytesLE:()=>Qe,numberToHexUnpadded:()=>$s,numberToVarBytesBE:()=>hp,utf8ToBytes:()=>pp,validateObject:()=>le});var Zs=BigInt(0),Rn=BigInt(1),cp=BigInt(2),Ln=t=>t instanceof Uint8Array,up=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function Ee(t){if(!Ln(t))throw new Error("Uint8Array expected");let e="";for(let r=0;r<t.length;r++)e+=up[t[r]];return e}function $s(t){let e=t.toString(16);return e.length&1?`0${e}`:e}function Ji(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);return BigInt(t===""?"0":`0x${t}`)}function $e(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);let e=t.length;if(e%2)throw new Error("padded hex string expected, got unpadded hex of length "+e);let r=new Uint8Array(e/2);for(let n=0;n<r.length;n++){let i=n*2,a=t.slice(i,i+2),s=Number.parseInt(a,16);if(Number.isNaN(s)||s<0)throw new Error("Invalid byte sequence");r[n]=s}return r}function we(t){return Ji(Ee(t))}function Ue(t){if(!Ln(t))throw new Error("Uint8Array expected");return Ji(Ee(Uint8Array.from(t).reverse()))}function Ke(t,e){return $e(t.toString(16).padStart(e*2,"0"))}function Qe(t,e){return Ke(t,e).reverse()}function hp(t){return $e($s(t))}function wt(t,e,r){let n;if(typeof e=="string")try{n=$e(e)}catch(a){throw new Error(`${t} must be valid hex string, got "${e}". Cause: ${a}`)}else if(Ln(e))n=Uint8Array.from(e);else throw new Error(`${t} must be hex string or Uint8Array`);let i=n.length;if(typeof r=="number"&&i!==r)throw new Error(`${t} expected ${r} bytes, got ${i}`);return n}function Be(...t){let e=new Uint8Array(t.reduce((n,i)=>n+i.length,0)),r=0;return t.forEach(n=>{if(!Ln(n))throw new Error("Uint8Array expected");e.set(n,r),r+=n.length}),e}function lp(t,e){if(t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(t[r]!==e[r])return!1;return!0}function pp(t){if(typeof t!="string")throw new Error(`utf8ToBytes expected string, got ${typeof t}`);return new Uint8Array(new TextEncoder().encode(t))}function dp(t){let e;for(e=0;t>Zs;t>>=Rn,e+=1);return e}function yp(t,e){return t>>BigInt(e)&Rn}var xp=(t,e,r)=>t|(r?Rn:Zs)<<BigInt(e),Fr=t=>(cp<<BigInt(t-1))-Rn,Xi=t=>new Uint8Array(t),Ys=t=>Uint8Array.from(t);function ji(t,e,r){if(typeof t!="number"||t<2)throw new Error("hashLen must be a number");if(typeof e!="number"||e<2)throw new Error("qByteLen must be a number");if(typeof r!="function")throw new Error("hmacFn must be a function");let n=Xi(t),i=Xi(t),a=0,s=()=>{n.fill(1),i.fill(0),a=0},o=(...h)=>r(i,n,...h),f=(h=Xi())=>{i=o(Ys([0]),h),n=o(),h.length!==0&&(i=o(Ys([1]),h),n=o())},c=()=>{if(a++>=1e3)throw new Error("drbg: tried 1000 values");let h=0,l=[];for(;h<e;){n=o();let x=n.slice();l.push(x),h+=n.length}return Be(...l)};return(h,l)=>{s(),f(h);let x;for(;!(x=l(c()));)f();return s(),x}}var gp={bigint:t=>typeof t=="bigint",function:t=>typeof t=="function",boolean:t=>typeof t=="boolean",string:t=>typeof t=="string",stringOrUint8Array:t=>typeof t=="string"||t instanceof Uint8Array,isSafeInteger:t=>Number.isSafeInteger(t),array:t=>Array.isArray(t),field:(t,e)=>e.Fp.isValid(t),hash:t=>typeof t=="function"&&Number.isSafeInteger(t.outputLen)};function le(t,e,r={}){let n=(i,a,s)=>{let o=gp[a];if(typeof o!="function")throw new Error(`Invalid validator "${a}", expected function`);let f=t[i];if(!(s&&f===void 0)&&!o(f,t))throw new Error(`Invalid param ${String(i)}=${f} (${typeof f}), expected ${a}`)};for(let[i,a]of Object.entries(e))n(i,a,!1);for(let[i,a]of Object.entries(r))n(i,a,!0);return t}var It=BigInt(0),yt=BigInt(1),Xe=BigInt(2),mp=BigInt(3),ta=BigInt(4),Qs=BigInt(5),Xs=BigInt(8),vp=BigInt(9),bp=BigInt(16);function ct(t,e){let r=t%e;return r>=It?r:e+r}function Ep(t,e,r){if(r<=It||e<It)throw new Error("Expected power/modulo > 0");if(r===yt)return It;let n=yt;for(;e>It;)e&yt&&(n=n*t%r),t=t*t%r,e>>=yt;return n}function xt(t,e,r){let n=t;for(;e-- >It;)n*=n,n%=r;return n}function Nn(t,e){if(t===It||e<=It)throw new Error(`invert: expected positive integers, got n=${t} mod=${e}`);let r=ct(t,e),n=e,i=It,a=yt,s=yt,o=It;for(;r!==It;){let c=n/r,u=n%r,h=i-s*c,l=a-o*c;n=r,r=u,i=s,a=o,s=h,o=l}if(n!==yt)throw new Error("invert: does not exist");return ct(i,e)}function wp(t){let e=(t-yt)/Xe,r,n,i;for(r=t-yt,n=0;r%Xe===It;r/=Xe,n++);for(i=Xe;i<t&&Ep(i,e,t)!==t-yt;i++);if(n===1){let s=(t+yt)/ta;return function(f,c){let u=f.pow(c,s);if(!f.eql(f.sqr(u),c))throw new Error("Cannot find square root");return u}}let a=(r+yt)/Xe;return function(o,f){if(o.pow(f,e)===o.neg(o.ONE))throw new Error("Cannot find square root");let c=n,u=o.pow(o.mul(o.ONE,i),r),h=o.pow(f,a),l=o.pow(f,r);for(;!o.eql(l,o.ONE);){if(o.eql(l,o.ZERO))return o.ZERO;let x=1;for(let d=o.sqr(l);x<c&&!o.eql(d,o.ONE);x++)d=o.sqr(d);let p=o.pow(u,yt<<BigInt(c-x-1));u=o.sqr(p),h=o.mul(h,p),l=o.mul(l,u),c=x}return h}}function Bp(t){if(t%ta===mp){let e=(t+yt)/ta;return function(n,i){let a=n.pow(i,e);if(!n.eql(n.sqr(a),i))throw new Error("Cannot find square root");return a}}if(t%Xs===Qs){let e=(t-Qs)/Xs;return function(n,i){let a=n.mul(i,Xe),s=n.pow(a,e),o=n.mul(i,s),f=n.mul(n.mul(o,Xe),s),c=n.mul(o,n.sub(f,n.ONE));if(!n.eql(n.sqr(c),i))throw new Error("Cannot find square root");return c}}return t%bp,wp(t)}var Js=(t,e)=>(ct(t,e)&yt)===yt,Sp=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function ea(t){let e={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},r=Sp.reduce((n,i)=>(n[i]="function",n),e);return le(t,r)}function Ap(t,e,r){if(r<It)throw new Error("Expected power > 0");if(r===It)return t.ONE;if(r===yt)return e;let n=t.ONE,i=e;for(;r>It;)r&yt&&(n=t.mul(n,i)),i=t.sqr(i),r>>=yt;return n}function Cp(t,e){let r=new Array(e.length),n=e.reduce((a,s,o)=>t.is0(s)?a:(r[o]=a,t.mul(a,s)),t.ONE),i=t.inv(n);return e.reduceRight((a,s,o)=>t.is0(s)?a:(r[o]=t.mul(a,r[o]),t.mul(a,s)),i),r}function ra(t,e){let r=e!==void 0?e:t.toString(2).length,n=Math.ceil(r/8);return{nBitLength:r,nByteLength:n}}function kn(t,e,r=!1,n={}){if(t<=It)throw new Error(`Expected Field ORDER > 0, got ${t}`);let{nBitLength:i,nByteLength:a}=ra(t,e);if(a>2048)throw new Error("Field lengths over 2048 bytes are not supported");let s=Bp(t),o=Object.freeze({ORDER:t,BITS:i,BYTES:a,MASK:Fr(i),ZERO:It,ONE:yt,create:f=>ct(f,t),isValid:f=>{if(typeof f!="bigint")throw new Error(`Invalid field element: expected bigint, got ${typeof f}`);return It<=f&&f<t},is0:f=>f===It,isOdd:f=>(f&yt)===yt,neg:f=>ct(-f,t),eql:(f,c)=>f===c,sqr:f=>ct(f*f,t),add:(f,c)=>ct(f+c,t),sub:(f,c)=>ct(f-c,t),mul:(f,c)=>ct(f*c,t),pow:(f,c)=>Ap(o,f,c),div:(f,c)=>ct(f*Nn(c,t),t),sqrN:f=>f*f,addN:(f,c)=>f+c,subN:(f,c)=>f-c,mulN:(f,c)=>f*c,inv:f=>Nn(f,t),sqrt:n.sqrt||(f=>s(o,f)),invertBatch:f=>Cp(o,f),cmov:(f,c,u)=>u?c:f,toBytes:f=>r?Qe(f,a):Ke(f,a),fromBytes:f=>{if(f.length!==a)throw new Error(`Fp.fromBytes: expected ${a}, got ${f.length}`);return r?Ue(f):we(f)}});return Object.freeze(o)}function js(t,e){if(!t.isOdd)throw new Error("Field doesn't have isOdd");let r=t.sqrt(e);return t.isOdd(r)?t.neg(r):r}function t0(t){if(typeof t!="bigint")throw new Error("field order must be bigint");let e=t.toString(2).length;return Math.ceil(e/8)}function na(t){let e=t0(t);return e+Math.ceil(e/2)}function e0(t,e,r=!1){let n=t.length,i=t0(e),a=na(e);if(n<16||n<a||n>1024)throw new Error(`expected ${a}-1024 bytes of input, got ${n}`);let s=r?we(t):Ue(t),o=ct(s,e-yt)+yt;return r?Qe(o,i):Ke(o,i)}var Ip=BigInt(0),ia=BigInt(1);function Pn(t,e){let r=(i,a)=>{let s=a.negate();return i?s:a},n=i=>{let a=Math.ceil(e/i)+1,s=2**(i-1);return{windows:a,windowSize:s}};return{constTimeNegate:r,unsafeLadder(i,a){let s=t.ZERO,o=i;for(;a>Ip;)a&ia&&(s=s.add(o)),o=o.double(),a>>=ia;return s},precomputeWindow(i,a){let{windows:s,windowSize:o}=n(a),f=[],c=i,u=c;for(let h=0;h<s;h++){u=c,f.push(u);for(let l=1;l<o;l++)u=u.add(c),f.push(u);c=u.double()}return f},wNAF(i,a,s){let{windows:o,windowSize:f}=n(i),c=t.ZERO,u=t.BASE,h=BigInt(2**i-1),l=2**i,x=BigInt(i);for(let p=0;p<o;p++){let d=p*f,y=Number(s&h);s>>=x,y>f&&(y-=l,s+=ia);let m=d,E=d+Math.abs(y)-1,b=p%2!==0,R=y<0;y===0?u=u.add(r(b,a[m])):c=c.add(r(R,a[E]))}return{p:c,f:u}},wNAFCached(i,a,s,o){let f=i._WINDOW_SIZE||1,c=a.get(i);return c||(c=this.precomputeWindow(i,f),f!==1&&a.set(i,o(c))),this.wNAF(f,c,s)}}}function Hr(t){return ea(t.Fp),le(t,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...ra(t.n,t.nBitLength),...t,p:t.Fp.ORDER})}var jt=BigInt(0),Ft=BigInt(1),Un=BigInt(2),_p=BigInt(8),Rp={zip215:!0};function Lp(t){let e=Hr(t);return le(t,{hash:"function",a:"bigint",d:"bigint",randomBytes:"function"},{adjustScalarBytes:"function",domain:"function",uvRatio:"function",mapToCurve:"function"}),Object.freeze({...e})}function Kn(t){let e=Lp(t),{Fp:r,n,prehash:i,hash:a,randomBytes:s,nByteLength:o,h:f}=e,c=Un<<BigInt(o*8)-Ft,u=r.create,h=e.uvRatio||((N,A)=>{try{return{isValid:!0,value:r.sqrt(N*r.inv(A))}}catch{return{isValid:!1,value:jt}}}),l=e.adjustScalarBytes||(N=>N),x=e.domain||((N,A,K)=>{if(A.length||K)throw new Error("Contexts/pre-hash are not supported");return N}),p=N=>typeof N=="bigint"&&jt<N,d=(N,A)=>p(N)&&p(A)&&N<A,y=N=>N===jt||d(N,c);function m(N,A){if(d(N,A))return N;throw new Error(`Expected valid scalar < ${A}, got ${typeof N} ${N}`)}function E(N){return N===jt?N:m(N,n)}let b=new Map;function R(N){if(!(N instanceof w))throw new Error("ExtendedPoint expected")}class w{constructor(A,K,O,F){if(this.ex=A,this.ey=K,this.ez=O,this.et=F,!y(A))throw new Error("x required");if(!y(K))throw new Error("y required");if(!y(O))throw new Error("z required");if(!y(F))throw new Error("t required")}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine(A){if(A instanceof w)throw new Error("extended point not allowed");let{x:K,y:O}=A||{};if(!y(K)||!y(O))throw new Error("invalid affine point");return new w(K,O,Ft,u(K*O))}static normalizeZ(A){let K=r.invertBatch(A.map(O=>O.ez));return A.map((O,F)=>O.toAffine(K[F])).map(w.fromAffine)}_setWindowSize(A){this._WINDOW_SIZE=A,b.delete(this)}assertValidity(){let{a:A,d:K}=e;if(this.is0())throw new Error("bad point: ZERO");let{ex:O,ey:F,ez:$,et:j}=this,ot=u(O*O),tt=u(F*F),it=u($*$),Ct=u(it*it),mt=u(ot*A),Pt=u(it*u(mt+tt)),Ut=u(Ct+u(K*u(ot*tt)));if(Pt!==Ut)throw new Error("bad point: equation left != right (1)");let Tt=u(O*F),Kt=u($*j);if(Tt!==Kt)throw new Error("bad point: equation left != right (2)")}equals(A){R(A);let{ex:K,ey:O,ez:F}=this,{ex:$,ey:j,ez:ot}=A,tt=u(K*ot),it=u($*F),Ct=u(O*ot),mt=u(j*F);return tt===it&&Ct===mt}is0(){return this.equals(w.ZERO)}negate(){return new w(u(-this.ex),this.ey,this.ez,u(-this.et))}double(){let{a:A}=e,{ex:K,ey:O,ez:F}=this,$=u(K*K),j=u(O*O),ot=u(Un*u(F*F)),tt=u(A*$),it=K+O,Ct=u(u(it*it)-$-j),mt=tt+j,Pt=mt-ot,Ut=tt-j,Tt=u(Ct*Pt),Kt=u(mt*Ut),xe=u(Ct*Ut),Fe=u(Pt*mt);return new w(Tt,Kt,Fe,xe)}add(A){R(A);let{a:K,d:O}=e,{ex:F,ey:$,ez:j,et:ot}=this,{ex:tt,ey:it,ez:Ct,et:mt}=A;if(K===BigInt(-1)){let Wa=u(($-F)*(it+tt)),Ya=u(($+F)*(it-tt)),Jn=u(Ya-Wa);if(Jn===jt)return this.double();let Za=u(j*Un*mt),$a=u(ot*Un*Ct),Qa=$a+Za,Xa=Ya+Wa,Ja=$a-Za,Zf=u(Qa*Jn),$f=u(Xa*Ja),Qf=u(Qa*Ja),Xf=u(Jn*Xa);return new w(Zf,$f,Xf,Qf)}let Pt=u(F*tt),Ut=u($*it),Tt=u(ot*O*mt),Kt=u(j*Ct),xe=u((F+$)*(tt+it)-Pt-Ut),Fe=Kt-Tt,Ir=Kt+Tt,Ga=u(Ut-K*Pt),zf=u(xe*Fe),Gf=u(Ir*Ga),Wf=u(xe*Ga),Yf=u(Fe*Ir);return new w(zf,Gf,Yf,Wf)}subtract(A){return this.add(A.negate())}wNAF(A){return D.wNAFCached(this,b,A,w.normalizeZ)}multiply(A){let{p:K,f:O}=this.wNAF(m(A,n));return w.normalizeZ([K,O])[0]}multiplyUnsafe(A){let K=E(A);return K===jt?L:this.equals(L)||K===Ft?this:this.equals(B)?this.wNAF(K).p:D.unsafeLadder(this,K)}isSmallOrder(){return this.multiplyUnsafe(f).is0()}isTorsionFree(){return D.unsafeLadder(this,n).is0()}toAffine(A){let{ex:K,ey:O,ez:F}=this,$=this.is0();A==null&&(A=$?_p:r.inv(F));let j=u(K*A),ot=u(O*A),tt=u(F*A);if($)return{x:jt,y:Ft};if(tt!==Ft)throw new Error("invZ was invalid");return{x:j,y:ot}}clearCofactor(){let{h:A}=e;return A===Ft?this:this.multiplyUnsafe(A)}static fromHex(A,K=!1){let{d:O,a:F}=e,$=r.BYTES;A=wt("pointHex",A,$);let j=A.slice(),ot=A[$-1];j[$-1]=ot&-129;let tt=Ue(j);tt===jt||(K?m(tt,c):m(tt,r.ORDER));let it=u(tt*tt),Ct=u(it-Ft),mt=u(O*it-F),{isValid:Pt,value:Ut}=h(Ct,mt);if(!Pt)throw new Error("Point.fromHex: invalid y coordinate");let Tt=(Ut&Ft)===Ft,Kt=(ot&128)!==0;if(!K&&Ut===jt&&Kt)throw new Error("Point.fromHex: x=0 and x_0=1");return Kt!==Tt&&(Ut=u(-Ut)),w.fromAffine({x:Ut,y:tt})}static fromPrivateKey(A){return V(A).point}toRawBytes(){let{x:A,y:K}=this.toAffine(),O=Qe(K,r.BYTES);return O[O.length-1]|=A&Ft?128:0,O}toHex(){return Ee(this.toRawBytes())}}w.BASE=new w(e.Gx,e.Gy,Ft,u(e.Gx*e.Gy)),w.ZERO=new w(jt,Ft,Ft,jt);let{BASE:B,ZERO:L}=w,D=Pn(w,o*8);function G(N){return ct(N,n)}function z(N){return G(Ue(N))}function V(N){let A=o;N=wt("private key",N,A);let K=wt("hashed private key",a(N),2*A),O=l(K.slice(0,A)),F=K.slice(A,2*A),$=z(O),j=B.multiply($),ot=j.toRawBytes();return{head:O,prefix:F,scalar:$,point:j,pointBytes:ot}}function J(N){return V(N).pointBytes}function ft(N=new Uint8Array,...A){let K=Be(...A);return z(a(x(K,wt("context",N),!!i)))}function kt(N,A,K={}){N=wt("message",N),i&&(N=i(N));let{prefix:O,scalar:F,pointBytes:$}=V(A),j=ft(K.context,O,N),ot=B.multiply(j).toRawBytes(),tt=ft(K.context,ot,$,N),it=G(j+tt*F);E(it);let Ct=Be(ot,Qe(it,r.BYTES));return wt("result",Ct,o*2)}let T=Rp;function k(N,A,K,O=T){let{context:F,zip215:$}=O,j=r.BYTES;N=wt("signature",N,2*j),A=wt("message",A),i&&(A=i(A));let ot=Ue(N.slice(j,2*j)),tt,it,Ct;try{tt=w.fromHex(K,$),it=w.fromHex(N.slice(0,j),$),Ct=B.multiplyUnsafe(ot)}catch{return!1}if(!$&&tt.isSmallOrder())return!1;let mt=ft(F,it.toRawBytes(),tt.toRawBytes(),A);return it.add(tt.multiplyUnsafe(mt)).subtract(Ct).clearCofactor().equals(w.ZERO)}return B._setWindowSize(8),{CURVE:e,getPublicKey:J,sign:kt,verify:k,ExtendedPoint:w,utils:{getExtendedPublicKey:V,randomPrivateKey:()=>s(r.BYTES),precompute(N=8,A=w.BASE){return A._setWindowSize(N),A.multiply(BigInt(3)),A}}}}var oa=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),r0=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752"),Oy=BigInt(0),Dp=BigInt(1),aa=BigInt(2),Np=BigInt(5),n0=BigInt(10),kp=BigInt(20),Pp=BigInt(40),i0=BigInt(80);function Up(t){let e=oa,n=t*t%e*t%e,i=xt(n,aa,e)*n%e,a=xt(i,Dp,e)*t%e,s=xt(a,Np,e)*a%e,o=xt(s,n0,e)*s%e,f=xt(o,kp,e)*o%e,c=xt(f,Pp,e)*f%e,u=xt(c,i0,e)*c%e,h=xt(u,i0,e)*c%e,l=xt(h,n0,e)*s%e;return{pow_p_5_8:xt(l,aa,e)*t%e,b2:n}}function Kp(t){return t[0]&=248,t[31]&=127,t[31]|=64,t}function Op(t,e){let r=oa,n=ct(e*e*e,r),i=ct(n*n*e,r),a=Up(t*i).pow_p_5_8,s=ct(t*n*a,r),o=ct(e*s*s,r),f=s,c=ct(s*r0,r),u=o===t,h=o===ct(-t,r),l=o===ct(-t*r0,r);return u&&(s=f),(h||l)&&(s=c),Js(s,r)&&(s=ct(-s,r)),{isValid:u||h,value:s}}var Se=kn(oa,void 0,!0),sa={a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),Fp:Se,n:BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),h:BigInt(8),Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960"),hash:Qi,randomBytes:gr,adjustScalarBytes:Kp,uvRatio:Op},vr=Kn(sa);function a0(t,e,r){if(e.length>255)throw new Error("Context is too big");return Tn(Yi("SigEd25519 no Ed25519 collisions"),new Uint8Array([r?1:0,e.length]),e,t)}var My=Kn({...sa,domain:a0}),qy=Kn({...sa,domain:a0,prehash:Qi});var Mp=(Se.ORDER+BigInt(3))/BigInt(8),Vy=Se.pow(aa,Mp),Fy=Se.sqrt(Se.neg(Se.ONE)),Hy=(Se.ORDER-BigInt(5))/BigInt(8),zy=BigInt(486662);var Gy=js(Se,Se.neg(BigInt(486664)));var Wy=BigInt("25063068953384623474111414158702152701244531502492656460079210482610430750235"),Yy=BigInt("54469307008909316920995813868745141605393597292927456921205312896311721017578"),Zy=BigInt("1159843021668779879193775521855586647937357759715417654439879720876111806838"),$y=BigInt("40440834346308536858101042469323190826248399146238708352240133220865137265952");var Qy=BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");var br=32,Ae=64,On=32;async function o0(){let t=vr.utils.randomPrivateKey(),e=vr.getPublicKey(t);return{privateKey:u0(t,e),publicKey:e}}async function s0(t){if(t.length!==On)throw new TypeError('"seed" must be 32 bytes in length.');if(!(t instanceof Uint8Array))throw new TypeError('"seed" must be a node.js Buffer, or Uint8Array.');let e=t,r=vr.getPublicKey(e);return{privateKey:u0(e,r),publicKey:r}}async function f0(t,e){let r=t.subarray(0,On);return vr.sign(e,r)}async function c0(t,e,r){return vr.verify(e,r,t)}function u0(t,e){let r=new Uint8Array(Ae);for(let n=0;n<On;n++)r[n]=t[n],r[On+n]=e[n];return r}function pe(t,e){e==null&&(e=t.reduce((i,a)=>i+a.length,0));let r=fn(e),n=0;for(let i of t)r.set(i,n),n+=i.length;return sr(r)}var fa={alg:"A128GCM",ext:!0,k:"scm9jmO_4BJAgdwWGVulLg",key_ops:["encrypt","decrypt"],kty:"oct"};function Mn(t){let e=t?.algorithm??"AES-GCM",r=t?.keyLength??16,n=t?.nonceLength??12,i=t?.digest??"SHA-256",a=t?.saltLength??16,s=t?.iterations??32767,o=St.get();r*=8;async function f(h,l){let x=o.getRandomValues(new Uint8Array(a)),p=o.getRandomValues(new Uint8Array(n)),d={name:e,iv:p};typeof l=="string"&&(l=Lt(l));let y;if(l.length===0){y=await o.subtle.importKey("jwk",fa,{name:"AES-GCM"},!0,["encrypt"]);try{let E={name:"PBKDF2",salt:x,iterations:s,hash:{name:i}},b=await o.subtle.importKey("raw",l,{name:"PBKDF2"},!1,["deriveKey"]);y=await o.subtle.deriveKey(E,b,{name:e,length:r},!0,["encrypt"])}catch{y=await o.subtle.importKey("jwk",fa,{name:"AES-GCM"},!0,["encrypt"])}}else{let E={name:"PBKDF2",salt:x,iterations:s,hash:{name:i}},b=await o.subtle.importKey("raw",l,{name:"PBKDF2"},!1,["deriveKey"]);y=await o.subtle.deriveKey(E,b,{name:e,length:r},!0,["encrypt"])}let m=await o.subtle.encrypt(d,y,h);return pe([x,d.iv,new Uint8Array(m)])}async function c(h,l){let x=h.subarray(0,a),p=h.subarray(a,a+n),d=h.subarray(a+n),y={name:e,iv:p};typeof l=="string"&&(l=Lt(l));let m;if(l.length===0)try{let b={name:"PBKDF2",salt:x,iterations:s,hash:{name:i}},R=await o.subtle.importKey("raw",l,{name:"PBKDF2"},!1,["deriveKey"]);m=await o.subtle.deriveKey(b,R,{name:e,length:r},!0,["decrypt"])}catch{m=await o.subtle.importKey("jwk",fa,{name:"AES-GCM"},!0,["decrypt"])}else{let b={name:"PBKDF2",salt:x,iterations:s,hash:{name:i}},R=await o.subtle.importKey("raw",l,{name:"PBKDF2"},!1,["deriveKey"]);m=await o.subtle.deriveKey(b,R,{name:e,length:r},!0,["decrypt"])}let E=await o.subtle.decrypt(y,m,d);return new Uint8Array(E)}return{encrypt:f,decrypt:c}}async function Er(t,e){let n=await Mn().encrypt(t,e);return Rr.encode(n)}var Sr={};vt(Sr,{KeyType:()=>lt,PrivateKey:()=>ie,PublicKey:()=>ne});var Ea=bt(pa(),1),J0=bt(z0(),1),j0=bt(je(),1),wa=bt(ba(),1),tf=bt(X0(),1);function $p(){j0.default._configure(),Ea.default._configure(J0.default),wa.default._configure(tf.default)}$p();var ef=["uint64","int64","sint64","fixed64","sfixed64"];function Qp(t){for(let e of ef){if(t[e]==null)continue;let r=t[e];t[e]=function(){return BigInt(r.call(this).toString())}}return t}function Ba(t){return Qp(new Ea.default(t))}function Xp(t){for(let e of ef){if(t[e]==null)continue;let r=t[e];t[e]=function(n){return r.call(this,n.toString())}}return t}function Sa(){return Xp(wa.default.create())}function zn(t,e){let r=Ba(t instanceof Uint8Array?t:t.subarray());return e.decode(r)}function Gn(t,e){let r=Sa();return e.encode(t,r,{lengthDelimited:!1}),r.finish()}var Br;(function(t){t[t.VARINT=0]="VARINT",t[t.BIT64=1]="BIT64",t[t.LENGTH_DELIMITED=2]="LENGTH_DELIMITED",t[t.START_GROUP=3]="START_GROUP",t[t.END_GROUP=4]="END_GROUP",t[t.BIT32=5]="BIT32"})(Br||(Br={}));function Wn(t,e,r,n){return{name:t,type:e,encode:r,decode:n}}function Aa(t){function e(i){if(t[i.toString()]==null)throw new Error("Invalid enum value");return t[i]}let r=function(a,s){let o=e(a);s.int32(o)},n=function(a){let s=a.int32();return e(s)};return Wn("enum",Br.VARINT,r,n)}function Yn(t,e){return Wn("message",Br.LENGTH_DELIMITED,t,e)}var lt;(function(t){t.RSA="RSA",t.Ed25519="Ed25519",t.Secp256k1="Secp256k1"})(lt||(lt={}));var Ca;(function(t){t[t.RSA=0]="RSA",t[t.Ed25519=1]="Ed25519",t[t.Secp256k1=2]="Secp256k1"})(Ca||(Ca={}));(function(t){t.codec=()=>Aa(Ca)})(lt||(lt={}));var ne;(function(t){let e;t.codec=()=>(e==null&&(e=Yn((r,n,i={})=>{i.lengthDelimited!==!1&&n.fork(),r.Type!=null&&(n.uint32(8),lt.codec().encode(r.Type,n)),r.Data!=null&&(n.uint32(18),n.bytes(r.Data)),i.lengthDelimited!==!1&&n.ldelim()},(r,n)=>{let i={},a=n==null?r.len:r.pos+n;for(;r.pos<a;){let s=r.uint32();switch(s>>>3){case 1:i.Type=lt.codec().decode(r);break;case 2:i.Data=r.bytes();break;default:r.skipType(s&7);break}}return i})),e),t.encode=r=>Gn(r,t.codec()),t.decode=r=>zn(r,t.codec())})(ne||(ne={}));var ie;(function(t){let e;t.codec=()=>(e==null&&(e=Yn((r,n,i={})=>{i.lengthDelimited!==!1&&n.fork(),r.Type!=null&&(n.uint32(8),lt.codec().encode(r.Type,n)),r.Data!=null&&(n.uint32(18),n.bytes(r.Data)),i.lengthDelimited!==!1&&n.ldelim()},(r,n)=>{let i={},a=n==null?r.len:r.pos+n;for(;r.pos<a;){let s=r.uint32();switch(s>>>3){case 1:i.Type=lt.codec().decode(r);break;case 2:i.Data=r.bytes();break;default:r.skipType(s&7);break}}return i})),e),t.encode=r=>Gn(r,t.codec()),t.decode=r=>zn(r,t.codec())})(ie||(ie={}));var Wr=class{_key;constructor(e){this._key=Ar(e,br)}async verify(e,r){return c0(this._key,r,e)}marshal(){return this._key}get bytes(){return ne.encode({Type:lt.Ed25519,Data:this.marshal()}).subarray()}equals(e){return Xt(this.bytes,e.bytes)}async hash(){let{bytes:e}=await Vt.digest(this.bytes);return e}},er=class{_key;_publicKey;constructor(e,r){this._key=Ar(e,Ae),this._publicKey=Ar(r,br)}async sign(e){return f0(this._key,e)}get public(){return new Wr(this._publicKey)}marshal(){return this._key}get bytes(){return ie.encode({Type:lt.Ed25519,Data:this.marshal()}).subarray()}equals(e){return Xt(this.bytes,e.bytes)}async hash(){let{bytes:e}=await Vt.digest(this.bytes);return e}async id(){let e=Ai.digest(this.public.bytes);return zt.encode(e.bytes).substring(1)}async export(e,r="libp2p-key"){if(r==="libp2p-key")return Er(this.bytes,e);throw new H(`export format '${r}' is not supported`,"ERR_INVALID_EXPORT_FORMAT")}};function Jp(t){if(t.length>Ae){t=Ar(t,Ae+br);let n=t.subarray(0,Ae),i=t.subarray(Ae,t.length);return new er(n,i)}t=Ar(t,Ae);let e=t.subarray(0,Ae),r=t.subarray(br);return new er(e,r)}function jp(t){return t=Ar(t,br),new Wr(t)}async function td(){let{privateKey:t,publicKey:e}=await o0();return new er(t,e)}async function Ta(t){let{privateKey:e,publicKey:r}=await s0(t);return new er(e,r)}function Ar(t,e){if(t=Uint8Array.from(t??[]),t.length!==e)throw new H(`Key must be a Uint8Array of length ${e}, got ${t.length}`,"ERR_INVALID_KEY_TYPE");return t}var F2=bt(Bt(),1),H2=bt(En(),1),rf=bt(st(),1);function ae(t,e){let r=Uint8Array.from(t.abs().toByteArray());if(r=r[0]===0?r.subarray(1):r,e!=null){if(r.length>e)throw new Error("byte array longer than desired length");r=pe([new Uint8Array(e-r.length),r])}return gt(r,"base64url")}function Ht(t){let e=Zn(t);return new rf.default.jsbn.BigInteger(gt(e,"base16"),16)}function Zn(t,e){let r=Lt(t,"base64urlpad");if(e!=null){if(r.length>e)throw new Error("byte array longer than desired length");r=pe([new Uint8Array(e-r.length),r])}return r}var nf={"P-256":256,"P-384":384,"P-521":521},ed=Object.keys(nf),_a=ed.join(" / ");async function af(t){if(t!=="P-256"&&t!=="P-384"&&t!=="P-521")throw new H(`Unknown curve: ${t}. Must be ${_a}`,"ERR_INVALID_CURVE");let e=await St.get().subtle.generateKey({name:"ECDH",namedCurve:t},!0,["deriveBits"]),r=async(a,s)=>{let o;s!=null?o=await St.get().subtle.importKey("jwk",nd(t,s),{name:"ECDH",namedCurve:t},!1,["deriveBits"]):o=e.privateKey;let f=await St.get().subtle.importKey("jwk",sf(t,a),{name:"ECDH",namedCurve:t},!1,[]),c=await St.get().subtle.deriveBits({name:"ECDH",namedCurve:t,public:f},o,nf[t]);return new Uint8Array(c,0,c.byteLength)},n=await St.get().subtle.exportKey("jwk",e.publicKey);return{key:rd(n),genSharedKey:r}}var of={"P-256":32,"P-384":48,"P-521":66};function rd(t){if(t.crv==null||t.x==null||t.y==null)throw new H("JWK was missing components","ERR_INVALID_PARAMETERS");if(t.crv!=="P-256"&&t.crv!=="P-384"&&t.crv!=="P-521")throw new H(`Unknown curve: ${t.crv}. Must be ${_a}`,"ERR_INVALID_CURVE");let e=of[t.crv];return pe([Uint8Array.from([4]),Zn(t.x,e),Zn(t.y,e)],1+e*2)}function sf(t,e){if(t!=="P-256"&&t!=="P-384"&&t!=="P-521")throw new H(`Unknown curve: ${t}. Must be ${_a}`,"ERR_INVALID_CURVE");let r=of[t];if(!Xt(e.subarray(0,1),Uint8Array.from([4])))throw new H("Cannot unmarshal public key - invalid key format","ERR_INVALID_KEY_FORMAT");return{kty:"EC",crv:t,x:gt(e.subarray(1,r+1),"base64url"),y:gt(e.subarray(1+r),"base64url"),ext:!0}}var nd=(t,e)=>({...sf(t,e.public),d:gt(e.private,"base64url")});var ff=af;async function cf(t,e){let r=Rr.decode(t);return Mn().decrypt(r,e)}var uf={"AES-128":{ivSize:16,keySize:16},"AES-256":{ivSize:16,keySize:32},Blowfish:{ivSize:8,keySize:32}};async function hf(t,e,r){let n=uf[t];if(n==null){let E=Object.keys(uf).join(" / ");throw new H(`unknown cipher type '${t}'. Must be ${E}`,"ERR_INVALID_CIPHER_TYPE")}if(e==null)throw new H("missing hash type","ERR_MISSING_HASH_TYPE");let i=n.keySize,a=n.ivSize,s=20,o=Lt("key expansion"),f=2*(a+i+s),c=await ki(e,r),u=await c.digest(o),h=[],l=0;for(;l<f;){let E=await c.digest(pe([u,o])),b=E.length;l+b>f&&(b=f-l),h.push(E),l+=b,u=await c.digest(u)}let x=f/2,p=pe(h),d=p.subarray(0,x),y=p.subarray(x,f),m=E=>({iv:E.subarray(0,a),cipherKey:E.subarray(a,a+i),macKey:E.subarray(a+i)});return{k1:m(d),k2:m(y)}}var ka={};vt(ka,{MAX_KEY_SIZE:()=>Qr,RsaPrivateKey:()=>Tr,RsaPublicKey:()=>$r,fromJwk:()=>pd,generateKeyPair:()=>dd,unmarshalRsaPrivateKey:()=>hd,unmarshalRsaPublicKey:()=>ld});var Zr=bt(st(),1);var Lx=bt(xf(),1);function Cr(t){if(isNaN(t)||t<=0)throw new H("random bytes length must be a Number bigger than 0","ERR_INVALID_LENGTH");return gr(t)}var px=bt(Sn(),1),Da=bt(st(),1);function gf(t,e){return e.map(r=>Ht(t[r]))}function mf(t){return Da.default.pki.setRsaPrivateKey(...gf(t,["n","e","d","p","q","dp","dq","qi"]))}function vf(t){return Da.default.pki.setRsaPublicKey(...gf(t,["n","e"]))}var nr={};vt(nr,{jwkToPkcs1:()=>od,jwkToPkix:()=>fd,pkcs1ToJwk:()=>ad,pkixToJwk:()=>sd});var xx=bt(Or(),1),gx=bt(Sn(),1);var Ce=bt(st(),1);function ad(t){let e=Ce.default.asn1.fromDer(gt(t,"ascii")),r=Ce.default.pki.privateKeyFromAsn1(e);return{kty:"RSA",n:ae(r.n),e:ae(r.e),d:ae(r.d),p:ae(r.p),q:ae(r.q),dp:ae(r.dP),dq:ae(r.dQ),qi:ae(r.qInv),alg:"RS256"}}function od(t){if(t.n==null||t.e==null||t.d==null||t.p==null||t.q==null||t.dp==null||t.dq==null||t.qi==null)throw new H("JWK was missing components","ERR_INVALID_PARAMETERS");let e=Ce.default.pki.privateKeyToAsn1({n:Ht(t.n),e:Ht(t.e),d:Ht(t.d),p:Ht(t.p),q:Ht(t.q),dP:Ht(t.dp),dQ:Ht(t.dq),qInv:Ht(t.qi)});return Lt(Ce.default.asn1.toDer(e).getBytes(),"ascii")}function sd(t){let e=Ce.default.asn1.fromDer(gt(t,"ascii")),r=Ce.default.pki.publicKeyFromAsn1(e);return{kty:"RSA",n:ae(r.n),e:ae(r.e)}}function fd(t){if(t.n==null||t.e==null)throw new H("JWK was missing components","ERR_INVALID_PARAMETERS");let e=Ce.default.pki.publicKeyToAsn1({n:Ht(t.n),e:Ht(t.e)});return Lt(Ce.default.asn1.toDer(e).getBytes(),"ascii")}async function bf(t){let e=await St.get().subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:t,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},!0,["sign","verify"]),r=await Bf(e);return{privateKey:r[0],publicKey:r[1]}}async function Na(t){let r=[await St.get().subtle.importKey("jwk",t,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["sign"]),await cd(t)],n=await Bf({privateKey:r[0],publicKey:r[1]});return{privateKey:n[0],publicKey:n[1]}}async function Ef(t,e){let r=await St.get().subtle.importKey("jwk",t,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["sign"]),n=await St.get().subtle.sign({name:"RSASSA-PKCS1-v1_5"},r,Uint8Array.from(e));return new Uint8Array(n,0,n.byteLength)}async function wf(t,e,r){let n=await St.get().subtle.importKey("jwk",t,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["verify"]);return St.get().subtle.verify({name:"RSASSA-PKCS1-v1_5"},n,e,r)}async function Bf(t){if(t.privateKey==null||t.publicKey==null)throw new H("Private and public key are required","ERR_INVALID_PARAMETERS");return Promise.all([St.get().subtle.exportKey("jwk",t.privateKey),St.get().subtle.exportKey("jwk",t.publicKey)])}async function cd(t){return St.get().subtle.importKey("jwk",{kty:t.kty,n:t.n,e:t.e},{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["verify"])}function Sf(t,e,r,n){let i=e?vf(t):mf(t),a=gt(Uint8Array.from(r),"ascii"),s=n(a,i);return Lt(s,"ascii")}function Af(t,e){return Sf(t,!0,e,(r,n)=>n.encrypt(r))}function Cf(t,e){return Sf(t,!1,e,(r,n)=>n.decrypt(r))}function $n(t){if(t.kty!=="RSA")throw new H("invalid key type","ERR_INVALID_KEY_TYPE");if(t.n==null)throw new H("invalid key modulus","ERR_INVALID_KEY_MODULUS");return Lt(t.n,"base64url").length*8}var Qr=8192,$r=class{_key;constructor(e){this._key=e}async verify(e,r){return wf(this._key,r,e)}marshal(){return nr.jwkToPkix(this._key)}get bytes(){return ne.encode({Type:lt.RSA,Data:this.marshal()}).subarray()}encrypt(e){return Af(this._key,e)}equals(e){return Xt(this.bytes,e.bytes)}async hash(){let{bytes:e}=await Vt.digest(this.bytes);return e}},Tr=class{_key;_publicKey;constructor(e,r){this._key=e,this._publicKey=r}genSecret(){return Cr(16)}async sign(e){return Ef(this._key,e)}get public(){if(this._publicKey==null)throw new H("public key not provided","ERR_PUBKEY_NOT_PROVIDED");return new $r(this._publicKey)}decrypt(e){return Cf(this._key,e)}marshal(){return nr.jwkToPkcs1(this._key)}get bytes(){return ie.encode({Type:lt.RSA,Data:this.marshal()}).subarray()}equals(e){return Xt(this.bytes,e.bytes)}async hash(){let{bytes:e}=await Vt.digest(this.bytes);return e}async id(){let e=await this.public.hash();return gt(e,"base58btc")}async export(e,r="pkcs-8"){if(r==="pkcs-8"){let n=new Zr.default.util.ByteBuffer(this.marshal()),i=Zr.default.asn1.fromDer(n),a=Zr.default.pki.privateKeyFromAsn1(i),s={algorithm:"aes256",count:1e4,saltSize:128/8,prfAlgorithm:"sha512"};return Zr.default.pki.encryptRsaPrivateKey(a,e,s)}else{if(r==="libp2p-key")return Er(this.bytes,e);throw new H(`export format '${r}' is not supported`,"ERR_INVALID_EXPORT_FORMAT")}}};async function hd(t){let e=nr.pkcs1ToJwk(t);if($n(e)>Qr)throw new H("key size is too large","ERR_KEY_SIZE_TOO_LARGE");let r=await Na(e);return new Tr(r.privateKey,r.publicKey)}function ld(t){let e=nr.pkixToJwk(t);if($n(e)>Qr)throw new H("key size is too large","ERR_KEY_SIZE_TOO_LARGE");return new $r(e)}async function pd(t){if($n(t)>Qr)throw new H("key size is too large","ERR_KEY_SIZE_TOO_LARGE");let e=await Na(t);return new Tr(e.privateKey,e.publicKey)}async function dd(t){if(t>Qr)throw new H("key size is too large","ERR_KEY_SIZE_TOO_LARGE");let e=await bf(t);return new Tr(e.privateKey,e.publicKey)}var qa={};vt(qa,{Secp256k1PrivateKey:()=>Jr,Secp256k1PublicKey:()=>Xr,generateKeyPair:()=>_d,unmarshalSecp256k1PrivateKey:()=>Td,unmarshalSecp256k1PublicKey:()=>Id});var yd=(t,e,r)=>t&e^~t&r,xd=(t,e,r)=>t&e^t&r^e&r,gd=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),qe=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),Ve=new Uint32Array(64),Pa=class extends mr{constructor(){super(64,32,8,!1),this.A=qe[0]|0,this.B=qe[1]|0,this.C=qe[2]|0,this.D=qe[3]|0,this.E=qe[4]|0,this.F=qe[5]|0,this.G=qe[6]|0,this.H=qe[7]|0}get(){let{A:e,B:r,C:n,D:i,E:a,F:s,G:o,H:f}=this;return[e,r,n,i,a,s,o,f]}set(e,r,n,i,a,s,o,f){this.A=e|0,this.B=r|0,this.C=n|0,this.D=i|0,this.E=a|0,this.F=s|0,this.G=o|0,this.H=f|0}process(e,r){for(let h=0;h<16;h++,r+=4)Ve[h]=e.getUint32(r,!1);for(let h=16;h<64;h++){let l=Ve[h-15],x=Ve[h-2],p=Jt(l,7)^Jt(l,18)^l>>>3,d=Jt(x,17)^Jt(x,19)^x>>>10;Ve[h]=d+Ve[h-7]+p+Ve[h-16]|0}let{A:n,B:i,C:a,D:s,E:o,F:f,G:c,H:u}=this;for(let h=0;h<64;h++){let l=Jt(o,6)^Jt(o,11)^Jt(o,25),x=u+l+yd(o,f,c)+gd[h]+Ve[h]|0,d=(Jt(n,2)^Jt(n,13)^Jt(n,22))+xd(n,i,a)|0;u=c,c=f,f=o,o=s+x|0,s=a,a=i,i=n,n=x+d|0}n=n+this.A|0,i=i+this.B|0,a=a+this.C|0,s=s+this.D|0,o=o+this.E|0,f=f+this.F|0,c=c+this.G|0,u=u+this.H|0,this.set(n,i,a,s,o,f,c,u)}roundClean(){Ve.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}};var Tf=In(()=>new Pa);function md(t){let e=Hr(t);le(e,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});let{endo:r,Fp:n,a:i}=e;if(r){if(!n.eql(i,n.ZERO))throw new Error("Endomorphism can only be defined for Koblitz curves that have a=0");if(typeof r!="object"||typeof r.beta!="bigint"||typeof r.splitScalar!="function")throw new Error("Expected endomorphism with beta: bigint and splitScalar: function")}return Object.freeze({...e})}var{bytesToNumberBE:vd,hexToBytes:bd}=Dn,ir={Err:class extends Error{constructor(e=""){super(e)}},_parseInt(t){let{Err:e}=ir;if(t.length<2||t[0]!==2)throw new e("Invalid signature integer tag");let r=t[1],n=t.subarray(2,r+2);if(!r||n.length!==r)throw new e("Invalid signature integer: wrong length");if(n[0]&128)throw new e("Invalid signature integer: negative");if(n[0]===0&&!(n[1]&128))throw new e("Invalid signature integer: unnecessary leading zero");return{d:vd(n),l:t.subarray(r+2)}},toSig(t){let{Err:e}=ir,r=typeof t=="string"?bd(t):t;if(!(r instanceof Uint8Array))throw new Error("ui8a expected");let n=r.length;if(n<2||r[0]!=48)throw new e("Invalid signature tag");if(r[1]!==n-2)throw new e("Invalid signature: incorrect length");let{d:i,l:a}=ir._parseInt(r.subarray(2)),{d:s,l:o}=ir._parseInt(a);if(o.length)throw new e("Invalid signature: left bytes after parsing");return{r:i,s}},hexFromSig(t){let e=c=>Number.parseInt(c[0],16)&8?"00"+c:c,r=c=>{let u=c.toString(16);return u.length&1?`0${u}`:u},n=e(r(t.s)),i=e(r(t.r)),a=n.length/2,s=i.length/2,o=r(a),f=r(s);return`30${r(s+a+4)}02${f}${i}02${o}${n}`}},Te=BigInt(0),Zt=BigInt(1),qx=BigInt(2),If=BigInt(3),Vx=BigInt(4);function Ed(t){let e=md(t),{Fp:r}=e,n=e.toBytes||((p,d,y)=>{let m=d.toAffine();return Be(Uint8Array.from([4]),r.toBytes(m.x),r.toBytes(m.y))}),i=e.fromBytes||(p=>{let d=p.subarray(1),y=r.fromBytes(d.subarray(0,r.BYTES)),m=r.fromBytes(d.subarray(r.BYTES,2*r.BYTES));return{x:y,y:m}});function a(p){let{a:d,b:y}=e,m=r.sqr(p),E=r.mul(m,p);return r.add(r.add(E,r.mul(p,d)),y)}if(!r.eql(r.sqr(e.Gy),a(e.Gx)))throw new Error("bad generator point: equation left != right");function s(p){return typeof p=="bigint"&&Te<p&&p<e.n}function o(p){if(!s(p))throw new Error("Expected valid bigint: 0 < bigint < curve.n")}function f(p){let{allowedPrivateKeyLengths:d,nByteLength:y,wrapPrivateKey:m,n:E}=e;if(d&&typeof p!="bigint"){if(p instanceof Uint8Array&&(p=Ee(p)),typeof p!="string"||!d.includes(p.length))throw new Error("Invalid key");p=p.padStart(y*2,"0")}let b;try{b=typeof p=="bigint"?p:we(wt("private key",p,y))}catch{throw new Error(`private key must be ${y} bytes, hex or bigint, not ${typeof p}`)}return m&&(b=ct(b,E)),o(b),b}let c=new Map;function u(p){if(!(p instanceof h))throw new Error("ProjectivePoint expected")}class h{constructor(d,y,m){if(this.px=d,this.py=y,this.pz=m,d==null||!r.isValid(d))throw new Error("x required");if(y==null||!r.isValid(y))throw new Error("y required");if(m==null||!r.isValid(m))throw new Error("z required")}static fromAffine(d){let{x:y,y:m}=d||{};if(!d||!r.isValid(y)||!r.isValid(m))throw new Error("invalid affine point");if(d instanceof h)throw new Error("projective point not allowed");let E=b=>r.eql(b,r.ZERO);return E(y)&&E(m)?h.ZERO:new h(y,m,r.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(d){let y=r.invertBatch(d.map(m=>m.pz));return d.map((m,E)=>m.toAffine(y[E])).map(h.fromAffine)}static fromHex(d){let y=h.fromAffine(i(wt("pointHex",d)));return y.assertValidity(),y}static fromPrivateKey(d){return h.BASE.multiply(f(d))}_setWindowSize(d){this._WINDOW_SIZE=d,c.delete(this)}assertValidity(){if(this.is0()){if(e.allowInfinityPoint&&!r.is0(this.py))return;throw new Error("bad point: ZERO")}let{x:d,y}=this.toAffine();if(!r.isValid(d)||!r.isValid(y))throw new Error("bad point: x or y not FE");let m=r.sqr(y),E=a(d);if(!r.eql(m,E))throw new Error("bad point: equation left != right");if(!this.isTorsionFree())throw new Error("bad point: not in prime-order subgroup")}hasEvenY(){let{y:d}=this.toAffine();if(r.isOdd)return!r.isOdd(d);throw new Error("Field doesn't support isOdd")}equals(d){u(d);let{px:y,py:m,pz:E}=this,{px:b,py:R,pz:w}=d,B=r.eql(r.mul(y,w),r.mul(b,E)),L=r.eql(r.mul(m,w),r.mul(R,E));return B&&L}negate(){return new h(this.px,r.neg(this.py),this.pz)}double(){let{a:d,b:y}=e,m=r.mul(y,If),{px:E,py:b,pz:R}=this,w=r.ZERO,B=r.ZERO,L=r.ZERO,D=r.mul(E,E),G=r.mul(b,b),z=r.mul(R,R),V=r.mul(E,b);return V=r.add(V,V),L=r.mul(E,R),L=r.add(L,L),w=r.mul(d,L),B=r.mul(m,z),B=r.add(w,B),w=r.sub(G,B),B=r.add(G,B),B=r.mul(w,B),w=r.mul(V,w),L=r.mul(m,L),z=r.mul(d,z),V=r.sub(D,z),V=r.mul(d,V),V=r.add(V,L),L=r.add(D,D),D=r.add(L,D),D=r.add(D,z),D=r.mul(D,V),B=r.add(B,D),z=r.mul(b,R),z=r.add(z,z),D=r.mul(z,V),w=r.sub(w,D),L=r.mul(z,G),L=r.add(L,L),L=r.add(L,L),new h(w,B,L)}add(d){u(d);let{px:y,py:m,pz:E}=this,{px:b,py:R,pz:w}=d,B=r.ZERO,L=r.ZERO,D=r.ZERO,G=e.a,z=r.mul(e.b,If),V=r.mul(y,b),J=r.mul(m,R),ft=r.mul(E,w),kt=r.add(y,m),T=r.add(b,R);kt=r.mul(kt,T),T=r.add(V,J),kt=r.sub(kt,T),T=r.add(y,E);let k=r.add(b,w);return T=r.mul(T,k),k=r.add(V,ft),T=r.sub(T,k),k=r.add(m,E),B=r.add(R,w),k=r.mul(k,B),B=r.add(J,ft),k=r.sub(k,B),D=r.mul(G,T),B=r.mul(z,ft),D=r.add(B,D),B=r.sub(J,D),D=r.add(J,D),L=r.mul(B,D),J=r.add(V,V),J=r.add(J,V),ft=r.mul(G,ft),T=r.mul(z,T),J=r.add(J,ft),ft=r.sub(V,ft),ft=r.mul(G,ft),T=r.add(T,ft),V=r.mul(J,T),L=r.add(L,V),V=r.mul(k,T),B=r.mul(kt,B),B=r.sub(B,V),V=r.mul(kt,J),D=r.mul(k,D),D=r.add(D,V),new h(B,L,D)}subtract(d){return this.add(d.negate())}is0(){return this.equals(h.ZERO)}wNAF(d){return x.wNAFCached(this,c,d,y=>{let m=r.invertBatch(y.map(E=>E.pz));return y.map((E,b)=>E.toAffine(m[b])).map(h.fromAffine)})}multiplyUnsafe(d){let y=h.ZERO;if(d===Te)return y;if(o(d),d===Zt)return this;let{endo:m}=e;if(!m)return x.unsafeLadder(this,d);let{k1neg:E,k1:b,k2neg:R,k2:w}=m.splitScalar(d),B=y,L=y,D=this;for(;b>Te||w>Te;)b&Zt&&(B=B.add(D)),w&Zt&&(L=L.add(D)),D=D.double(),b>>=Zt,w>>=Zt;return E&&(B=B.negate()),R&&(L=L.negate()),L=new h(r.mul(L.px,m.beta),L.py,L.pz),B.add(L)}multiply(d){o(d);let y=d,m,E,{endo:b}=e;if(b){let{k1neg:R,k1:w,k2neg:B,k2:L}=b.splitScalar(y),{p:D,f:G}=this.wNAF(w),{p:z,f:V}=this.wNAF(L);D=x.constTimeNegate(R,D),z=x.constTimeNegate(B,z),z=new h(r.mul(z.px,b.beta),z.py,z.pz),m=D.add(z),E=G.add(V)}else{let{p:R,f:w}=this.wNAF(y);m=R,E=w}return h.normalizeZ([m,E])[0]}multiplyAndAddUnsafe(d,y,m){let E=h.BASE,b=(w,B)=>B===Te||B===Zt||!w.equals(E)?w.multiplyUnsafe(B):w.multiply(B),R=b(this,y).add(b(d,m));return R.is0()?void 0:R}toAffine(d){let{px:y,py:m,pz:E}=this,b=this.is0();d==null&&(d=b?r.ONE:r.inv(E));let R=r.mul(y,d),w=r.mul(m,d),B=r.mul(E,d);if(b)return{x:r.ZERO,y:r.ZERO};if(!r.eql(B,r.ONE))throw new Error("invZ was invalid");return{x:R,y:w}}isTorsionFree(){let{h:d,isTorsionFree:y}=e;if(d===Zt)return!0;if(y)return y(h,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){let{h:d,clearCofactor:y}=e;return d===Zt?this:y?y(h,this):this.multiplyUnsafe(e.h)}toRawBytes(d=!0){return this.assertValidity(),n(h,this,d)}toHex(d=!0){return Ee(this.toRawBytes(d))}}h.BASE=new h(e.Gx,e.Gy,r.ONE),h.ZERO=new h(r.ZERO,r.ONE,r.ZERO);let l=e.nBitLength,x=Pn(h,e.endo?Math.ceil(l/2):l);return{CURVE:e,ProjectivePoint:h,normPrivateKeyToScalar:f,weierstrassEquation:a,isWithinCurveOrder:s}}function wd(t){let e=Hr(t);return le(e,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...e})}function _f(t){let e=wd(t),{Fp:r,n}=e,i=r.BYTES+1,a=2*r.BYTES+1;function s(T){return Te<T&&T<r.ORDER}function o(T){return ct(T,n)}function f(T){return Nn(T,n)}let{ProjectivePoint:c,normPrivateKeyToScalar:u,weierstrassEquation:h,isWithinCurveOrder:l}=Ed({...e,toBytes(T,k,_){let N=k.toAffine(),A=r.toBytes(N.x),K=Be;return _?K(Uint8Array.from([k.hasEvenY()?2:3]),A):K(Uint8Array.from([4]),A,r.toBytes(N.y))},fromBytes(T){let k=T.length,_=T[0],N=T.subarray(1);if(k===i&&(_===2||_===3)){let A=we(N);if(!s(A))throw new Error("Point is not on curve");let K=h(A),O=r.sqrt(K),F=(O&Zt)===Zt;return(_&1)===1!==F&&(O=r.neg(O)),{x:A,y:O}}else if(k===a&&_===4){let A=r.fromBytes(N.subarray(0,r.BYTES)),K=r.fromBytes(N.subarray(r.BYTES,2*r.BYTES));return{x:A,y:K}}else throw new Error(`Point of length ${k} was invalid. Expected ${i} compressed bytes or ${a} uncompressed bytes`)}}),x=T=>Ee(Ke(T,e.nByteLength));function p(T){let k=n>>Zt;return T>k}function d(T){return p(T)?o(-T):T}let y=(T,k,_)=>we(T.slice(k,_));class m{constructor(k,_,N){this.r=k,this.s=_,this.recovery=N,this.assertValidity()}static fromCompact(k){let _=e.nByteLength;return k=wt("compactSignature",k,_*2),new m(y(k,0,_),y(k,_,2*_))}static fromDER(k){let{r:_,s:N}=ir.toSig(wt("DER",k));return new m(_,N)}assertValidity(){if(!l(this.r))throw new Error("r must be 0 < r < CURVE.n");if(!l(this.s))throw new Error("s must be 0 < s < CURVE.n")}addRecoveryBit(k){return new m(this.r,this.s,k)}recoverPublicKey(k){let{r:_,s:N,recovery:A}=this,K=L(wt("msgHash",k));if(A==null||![0,1,2,3].includes(A))throw new Error("recovery id invalid");let O=A===2||A===3?_+e.n:_;if(O>=r.ORDER)throw new Error("recovery id 2 or 3 invalid");let F=A&1?"03":"02",$=c.fromHex(F+x(O)),j=f(O),ot=o(-K*j),tt=o(N*j),it=c.BASE.multiplyAndAddUnsafe($,ot,tt);if(!it)throw new Error("point at infinify");return it.assertValidity(),it}hasHighS(){return p(this.s)}normalizeS(){return this.hasHighS()?new m(this.r,o(-this.s),this.recovery):this}toDERRawBytes(){return $e(this.toDERHex())}toDERHex(){return ir.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return $e(this.toCompactHex())}toCompactHex(){return x(this.r)+x(this.s)}}let E={isValidPrivateKey(T){try{return u(T),!0}catch{return!1}},normPrivateKeyToScalar:u,randomPrivateKey:()=>{let T=na(e.n);return e0(e.randomBytes(T),e.n)},precompute(T=8,k=c.BASE){return k._setWindowSize(T),k.multiply(BigInt(3)),k}};function b(T,k=!0){return c.fromPrivateKey(T).toRawBytes(k)}function R(T){let k=T instanceof Uint8Array,_=typeof T=="string",N=(k||_)&&T.length;return k?N===i||N===a:_?N===2*i||N===2*a:T instanceof c}function w(T,k,_=!0){if(R(T))throw new Error("first arg must be private key");if(!R(k))throw new Error("second arg must be public key");return c.fromHex(k).multiply(u(T)).toRawBytes(_)}let B=e.bits2int||function(T){let k=we(T),_=T.length*8-e.nBitLength;return _>0?k>>BigInt(_):k},L=e.bits2int_modN||function(T){return o(B(T))},D=Fr(e.nBitLength);function G(T){if(typeof T!="bigint")throw new Error("bigint expected");if(!(Te<=T&&T<D))throw new Error(`bigint expected < 2^${e.nBitLength}`);return Ke(T,e.nByteLength)}function z(T,k,_=V){if(["recovered","canonical"].some(mt=>mt in _))throw new Error("sign() legacy options not supported");let{hash:N,randomBytes:A}=e,{lowS:K,prehash:O,extraEntropy:F}=_;K==null&&(K=!0),T=wt("msgHash",T),O&&(T=wt("prehashed msgHash",N(T)));let $=L(T),j=u(k),ot=[G(j),G($)];if(F!=null){let mt=F===!0?A(r.BYTES):F;ot.push(wt("extraEntropy",mt))}let tt=Be(...ot),it=$;function Ct(mt){let Pt=B(mt);if(!l(Pt))return;let Ut=f(Pt),Tt=c.BASE.multiply(Pt).toAffine(),Kt=o(Tt.x);if(Kt===Te)return;let xe=o(Ut*o(it+Kt*j));if(xe===Te)return;let Fe=(Tt.x===Kt?0:2)|Number(Tt.y&Zt),Ir=xe;return K&&p(xe)&&(Ir=d(xe),Fe^=1),new m(Kt,Ir,Fe)}return{seed:tt,k2sig:Ct}}let V={lowS:e.lowS,prehash:!1},J={lowS:e.lowS,prehash:!1};function ft(T,k,_=V){let{seed:N,k2sig:A}=z(T,k,_),K=e;return ji(K.hash.outputLen,K.nByteLength,K.hmac)(N,A)}c.BASE._setWindowSize(8);function kt(T,k,_,N=J){let A=T;if(k=wt("msgHash",k),_=wt("publicKey",_),"strict"in N)throw new Error("options.strict was renamed to lowS");let{lowS:K,prehash:O}=N,F,$;try{if(typeof A=="string"||A instanceof Uint8Array)try{F=m.fromDER(A)}catch(Tt){if(!(Tt instanceof ir.Err))throw Tt;F=m.fromCompact(A)}else if(typeof A=="object"&&typeof A.r=="bigint"&&typeof A.s=="bigint"){let{r:Tt,s:Kt}=A;F=new m(Tt,Kt)}else throw new Error("PARSE");$=c.fromHex(_)}catch(Tt){if(Tt.message==="PARSE")throw new Error("signature must be Signature instance, Uint8Array or hex string");return!1}if(K&&F.hasHighS())return!1;O&&(k=e.hash(k));let{r:j,s:ot}=F,tt=L(k),it=f(ot),Ct=o(tt*it),mt=o(j*it),Pt=c.BASE.multiplyAndAddUnsafe($,Ct,mt)?.toAffine();return Pt?o(Pt.x)===j:!1}return{CURVE:e,getPublicKey:b,getSharedSecret:w,sign:ft,verify:kt,ProjectivePoint:c,Signature:m,utils:E}}var Qn=class extends xr{constructor(e,r){super(),this.finished=!1,this.destroyed=!1,Hs(e);let n=Vr(r);if(this.iHash=e.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;let i=this.blockLen,a=new Uint8Array(i);a.set(n.length>i?e.create().update(n).digest():n);for(let s=0;s<a.length;s++)a[s]^=54;this.iHash.update(a),this.oHash=e.create();for(let s=0;s<a.length;s++)a[s]^=106;this.oHash.update(a),a.fill(0)}update(e){return yr(this),this.iHash.update(e),this}digestInto(e){yr(this),Wi(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){let e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));let{oHash:r,iHash:n,finished:i,destroyed:a,blockLen:s,outputLen:o}=this;return e=e,e.finished=i,e.destroyed=a,e.blockLen=s,e.outputLen=o,e.oHash=r._cloneInto(e.oHash),e.iHash=n._cloneInto(e.iHash),e}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}},Ua=(t,e,r)=>new Qn(t,e).update(r).digest();Ua.create=(t,e)=>new Qn(t,e);function Bd(t){return{hash:t,hmac:(e,...r)=>Ua(t,e,Tn(...r)),randomBytes:gr}}function Rf(t,e){let r=n=>_f({...t,...Bd(n)});return Object.freeze({...r(e),create:r})}var Nf=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),Lf=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),Sd=BigInt(1),Ka=BigInt(2),Df=(t,e)=>(t+e/Ka)/e;function Ad(t){let e=Nf,r=BigInt(3),n=BigInt(6),i=BigInt(11),a=BigInt(22),s=BigInt(23),o=BigInt(44),f=BigInt(88),c=t*t*t%e,u=c*c*t%e,h=xt(u,r,e)*u%e,l=xt(h,r,e)*u%e,x=xt(l,Ka,e)*c%e,p=xt(x,i,e)*x%e,d=xt(p,a,e)*p%e,y=xt(d,o,e)*d%e,m=xt(y,f,e)*y%e,E=xt(m,o,e)*d%e,b=xt(E,r,e)*u%e,R=xt(b,s,e)*p%e,w=xt(R,n,e)*c%e,B=xt(w,Ka,e);if(!Oa.eql(Oa.sqr(B),t))throw new Error("Cannot find square root");return B}var Oa=kn(Nf,void 0,void 0,{sqrt:Ad}),Ie=Rf({a:BigInt(0),b:BigInt(7),Fp:Oa,n:Lf,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:t=>{let e=Lf,r=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),n=-Sd*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),i=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),a=r,s=BigInt("0x100000000000000000000000000000000"),o=Df(a*t,e),f=Df(-n*t,e),c=ct(t-o*r-f*i,e),u=ct(-o*n-f*a,e),h=c>s,l=u>s;if(h&&(c=e-c),l&&(u=e-u),c>s||u>s)throw new Error("splitScalar: Endomorphism failed, k="+t);return{k1neg:h,k1:c,k2neg:l,k2:u}}}},Tf),jx=BigInt(0);var tg=Ie.ProjectivePoint;function kf(){return Ie.utils.randomPrivateKey()}async function Pf(t,e){let{digest:r}=await Vt.digest(e);try{return Ie.sign(r,t).toDERRawBytes()}catch(n){throw new H(String(n),"ERR_INVALID_INPUT")}}async function Uf(t,e,r){try{let{digest:n}=await Vt.digest(r);return Ie.verify(e,n,t)}catch(n){throw new H(String(n),"ERR_INVALID_INPUT")}}function Kf(t){return Ie.ProjectivePoint.fromHex(t).toRawBytes(!0)}function Of(t){try{Ie.getPublicKey(t,!0)}catch(e){throw new H(String(e),"ERR_INVALID_PRIVATE_KEY")}}function Ma(t){try{Ie.ProjectivePoint.fromHex(t)}catch(e){throw new H(String(e),"ERR_INVALID_PUBLIC_KEY")}}function Mf(t){try{return Ie.getPublicKey(t,!0)}catch(e){throw new H(String(e),"ERR_INVALID_PRIVATE_KEY")}}var Xr=class{_key;constructor(e){Ma(e),this._key=e}async verify(e,r){return Uf(this._key,r,e)}marshal(){return Kf(this._key)}get bytes(){return ne.encode({Type:lt.Secp256k1,Data:this.marshal()}).subarray()}equals(e){return Xt(this.bytes,e.bytes)}async hash(){let{bytes:e}=await Vt.digest(this.bytes);return e}},Jr=class{_key;_publicKey;constructor(e,r){this._key=e,this._publicKey=r??Mf(e),Of(this._key),Ma(this._publicKey)}async sign(e){return Pf(this._key,e)}get public(){return new Xr(this._publicKey)}marshal(){return this._key}get bytes(){return ie.encode({Type:lt.Secp256k1,Data:this.marshal()}).subarray()}equals(e){return Xt(this.bytes,e.bytes)}async hash(){let{bytes:e}=await Vt.digest(this.bytes);return e}async id(){let e=await this.public.hash();return gt(e,"base58btc")}async export(e,r="libp2p-key"){if(r==="libp2p-key")return Er(this.bytes,e);throw new H(`export format '${r}' is not supported`,"ERR_INVALID_EXPORT_FORMAT")}};function Td(t){return new Jr(t)}function Id(t){return new Xr(t)}async function _d(){let t=kf();return new Jr(t)}var ye={rsa:ka,ed25519:Ia,secp256k1:qa};function Va(t){let e=Object.keys(ye).join(" / ");return new H(`invalid or unsupported key type ${t}. Must be ${e}`,"ERR_UNSUPPORTED_KEY_TYPE")}function Fa(t){if(t=t.toLowerCase(),t==="rsa"||t==="ed25519"||t==="secp256k1")return ye[t];throw Va(t)}async function Rd(t,e){return Fa(t).generateKeyPair(e??2048)}async function Ld(t,e,r){if(t.toLowerCase()!=="ed25519")throw new H("Seed key derivation is unimplemented for RSA or secp256k1","ERR_UNSUPPORTED_KEY_DERIVATION_TYPE");return Ta(e)}function Dd(t){let e=ne.decode(t),r=e.Data??new Uint8Array;switch(e.Type){case lt.RSA:return ye.rsa.unmarshalRsaPublicKey(r);case lt.Ed25519:return ye.ed25519.unmarshalEd25519PublicKey(r);case lt.Secp256k1:return ye.secp256k1.unmarshalSecp256k1PublicKey(r);default:throw Va(e.Type??"unknown")}}function Nd(t,e){return e=(e??"rsa").toLowerCase(),Fa(e),t.bytes}async function qf(t){let e=ie.decode(t),r=e.Data??new Uint8Array;switch(e.Type){case lt.RSA:return ye.rsa.unmarshalRsaPrivateKey(r);case lt.Ed25519:return ye.ed25519.unmarshalEd25519PrivateKey(r);case lt.Secp256k1:return ye.secp256k1.unmarshalSecp256k1PrivateKey(r);default:throw Va(e.Type??"RSA")}}function kd(t,e){return e=(e??"rsa").toLowerCase(),Fa(e),t.bytes}async function Pd(t,e){try{let i=await cf(t,e);return await qf(i)}catch{}let r=Xn.default.pki.decryptRsaPrivateKey(t,e);if(r===null)throw new H("Cannot read the key, most likely the password is wrong or not a RSA key","ERR_CANNOT_DECRYPT_PEM");let n=Xn.default.asn1.toDer(Xn.default.pki.privateKeyToAsn1(r));return n=Lt(n.getBytes(),"ascii"),ye.rsa.unmarshalRsaPrivateKey(n)}var Ff=bt(Ui(),1),Hf=bt(Bt(),1),Vf={sha1:"sha1","sha2-256":"sha256","sha2-512":"sha512"};function za(t,e,r,n,i){if(i!=="sha1"&&i!=="sha2-256"&&i!=="sha2-512"){let o=Object.keys(Vf).join(" / ");throw new H(`Hash '${i}' is unknown or not supported. Must be ${o}`,"ERR_UNSUPPORTED_HASH_TYPE")}let a=Vf[i],s=(0,Ff.default)(t,e,r,n,a);return Hf.default.encode64(s,null)}return nc(Ud);})();
/*! Bundled license information:

@noble/hashes/esm/utils.js:
  (*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/utils.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/modular.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/curve.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/edwards.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/ed25519.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/weierstrass.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/_shortw_utils.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/secp256k1.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)
*/
return Libp2PCrypto}));
